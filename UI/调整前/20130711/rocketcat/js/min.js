var viewporter;(function(){viewporter={forceDetection:!1,ACTIVE:"ontouchstart"in window||/webos/i.test(navigator.userAgent),READY:!1,isLandscape:function(){return window.orientation===90||window.orientation===-90},ready:function(e){window.addEventListener("viewportready",e,!1)},change:function(e){window.addEventListener("viewportchange",e,!1)}};if(!viewporter.ACTIVE)return;var e=function(){var e=this;this.IS_ANDROID=/Android/.test(navigator.userAgent)&&!/CrMo/.test(navigator.userAgent);var t=function(){e.prepareVisualViewport();var t=window.orientation;window.addEventListener("orientationchange",function(){window.orientation!=t&&(e.prepareVisualViewport(),t=window.orientation)},!1)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){t()},!1):t()};e.prototype={getProfile:function(){if(viewporter.forceDetection)return null;for(var e in viewporter.profiles)if((new RegExp(e)).test(navigator.userAgent))return viewporter.profiles[e];return null},postProcess:function(){viewporter.READY=!0,this.triggerWindowEvent(this._firstUpdateExecuted?"viewportchange":"viewportready"),this._firstUpdateExecuted=!0},prepareVisualViewport:function(){var e=this;if(navigator.standalone)return this.postProcess();document.documentElement.style.minHeight="5000px";var t=window.innerHeight,n=this.getProfile(),r=viewporter.isLandscape()?"landscape":"portrait";window.scrollTo(0,e.IS_ANDROID?1:0);var i=this.IS_ANDROID&&!n?20:5,s=window.setInterval(function(){window.scrollTo(0,e.IS_ANDROID?1:0);if(e.IS_ANDROID?n?window.innerHeight===n[r]:--i<0:window.innerHeight>t||--i<0)document.documentElement.style.minHeight=window.innerHeight+"px",document.getElementById("viewporter").style.position="relative",document.getElementById("viewporter").style.height=window.innerHeight+"px",clearInterval(s),e.postProcess()},10)},triggerWindowEvent:function(e){var t=document.createEvent("Event");t.initEvent(e,!1,!1),window.dispatchEvent(t)}},new e})(),viewporter.profiles={MZ601:{portrait:696,landscape:1176},"GT-I9000|GT-I9100|Nexus S":{portrait:508,landscape:295},"GT-P1000":{portrait:657,landscape:400},"Desire_A8181|DesireHD_A9191":{portrait:533,landscape:320}};function PxLoader(e){e=e||{},e.statusInterval==null&&(e.statusInterval=5e3),e.loggingDelay==null&&(e.loggingDelay=2e4),e.noProgressTimeout==null&&(e.noProgressTimeout=Infinity);var t=[],n=[],r,i=+(new Date),s={QUEUED:0,WAITING:1,LOADED:2,ERROR:3,TIMEOUT:4},o=function(e){return e==null?[]:Array.isArray(e)?e:[e]};this.add=function(e){e.tags=new PxLoaderTags(e.tags),e.priority==null&&(e.priority=Infinity),t.push({resource:e,state:s.QUEUED})},this.addProgressListener=function(e,t){n.push({callback:e,tags:new PxLoaderTags(t)})},this.addCompletionListener=function(e,t){n.push({tags:new PxLoaderTags(t),callback:function(t){t.completedCount===t.totalCount&&e()}})};var u=function(e){e=o(e);var t=function(t){var n=t.resource,r=Infinity;for(var i=0;i<n.tags.length;i++)for(var s=0;s<Math.min(e.length,r);s++){if(n.tags[i]==e[s]&&s<r){r=s;if(r===0)break}if(r===0)break}return r};return function(e,n){var r=t(e),i=t(n);return r<i?-1:r>i?1:e.priority<n.priority?-1:e.priority>n.priority?1:0}};this.start=function(e){r=+(new Date);var n=u(e);t.sort(n);for(var i=0,o=t.length;i<o;i++){var f=t[i];f.status=s.WAITING,f.resource.start(this)}setTimeout(a,100)};var a=function(){var n=!1,r=+(new Date)-i,o=r>=e.noProgressTimeout,u=r>=e.loggingDelay;for(var f=0,l=t.length;f<l;f++){var h=t[f];if(h.status!==s.WAITING)continue;h.resource.checkStatus(),h.status===s.WAITING&&(o?h.resource.onTimeout():n=!0)}u&&n&&c(),n&&setTimeout(a,e.statusInterval)};this.isBusy=function(){for(var e=0,n=t.length;e<n;e++)if(t[e].status===s.QUEUED||t[e].status===s.WAITING)return!0;return!1};var f=function(e,r){var o=null;for(var u=0,a=t.length;u<a;u++)if(t[u].resource===e){o=t[u];break}if(o==null||o.status!==s.WAITING)return;o.status=r,i=+(new Date);var f=e.tags.length;for(var u=0,c=n.length;u<c;u++){var h=n[u],p;h.tags.length===0?p=!0:p=e.tags.contains(h.tags),p&&l(o,h)}};this.onLoad=function(e){f(e,s.LOADED)},this.onError=function(e){f(e,s.ERROR)},this.onTimeout=function(e){f(e,s.TIMEOUT)};var l=function(e,n){var r=0,i=0;for(var o=0,u=t.length;o<u;o++){var a=t[o],f=!1;n.tags.length===0?f=!0:f=a.resource.tags.contains(n.tags),f&&(i++,(a.status===s.LOADED||a.status===s.ERROR||a.status===s.TIMEOUT)&&r++)}n.callback({resource:e.resource,loaded:e.status===s.LOADED,error:e.status===s.ERROR,timeout:e.status===s.TIMEOUT,completedCount:r,totalCount:i})},c=this.log=function(e){if(!window.console)return;var n=Math.round((+(new Date)-r)/1e3);window.console.log("PxLoader elapsed: "+n+" sec");for(var i=0,o=t.length;i<o;i++){var u=t[i];if(!e&&u.status!==s.WAITING)continue;var a="PxLoader: #"+i+" "+u.resource.getName();switch(u.status){case s.QUEUED:a+=" (Not Started)";break;case s.WAITING:a+=" (Waiting)";break;case s.LOADED:a+=" (Loaded)";break;case s.ERROR:a+=" (Error)";break;case s.TIMEOUT:a+=" (Timeout)"}u.resource.tags.length>0&&(a+=" Tags: ["+u.resource.tags.join(",")+"]"),window.console.log(a)}}}function PxLoaderTags(e){this.array=[],this.object={},this.value=null,this.length=0;if(e!==null&&e!==undefined){if(Array.isArray(e))this.array=e;else if(typeof e=="object")for(var t in e)this.array.push(t);else this.array.push(e),this.value=e;this.length=this.array.length;for(var n=0;n<this.length;n++)this.object[this.array[n]]=!0}this.contains=function(e){if(this.length===0||e.length===0)return!1;if(this.length===1)return e.length===1?this.value===e.value:e.object.hasOwnProperty(this.value);if(e.length<this.length)return e.contains(this);for(var t in this.object)if(e.object[t])return!0;return!1}}Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)=="[object Array]"});function PxLoaderImage(e,t,n){var r=this,i=null;this.img=new Image,this.tags=t,this.priority=n;var s=function(){r.img.readyState=="complete"&&(a(),i.onLoad(r))},o=function(){a(),i.onLoad(r)},u=function(){a(),i.onError(r)},a=function(){r.unbind("load",o),r.unbind("readystatechange",s),r.unbind("error",u)};this.start=function(t){i=t,r.bind("load",o),r.bind("readystatechange",s),r.bind("error",u),r.img.src=e},this.checkStatus=function(){r.img.complete&&(a(),i.onLoad(r))},this.onTimeout=function(){a(),r.img.complete?i.onLoad(r):i.onTimeout(r)},this.getName=function(){return e},this.bind=function(e,t){r.img.addEventListener?r.img.addEventListener(e,t,!1):r.img.attachEvent&&r.img.attachEvent("on"+e,t)},this.unbind=function(e,t){r.img.removeEventListener?r.img.removeEventListener(e,t,!1):r.img.detachEvent&&r.img.detachEvent("on"+e,t)}}PxLoader.prototype.addImage=function(e,t,n){var r=new PxLoaderImage(e,t,n);return this.add(r),r.img};eval(function(e,t,n,r,i,s){i=function(e){return(e<t?"":i(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))};if(!"".replace(/^/,String)){while(n--)s[i(n)]=r[n]||i(n);r=[function(e){return s[e]}],i=function(){return"\\w+"},n=1}while(n--)r[n]&&(e=e.replace(new RegExp("\\b"+i(n)+"\\b","g"),r[n]));return e}("9 17={3i:'0.1.3',16:1e-6};l v(){}v.23={e:l(i){8(i<1||i>7.4.q)?w:7.4[i-1]},2R:l(){8 7.4.q},1u:l(){8 F.1x(7.2u(7))},24:l(a){9 n=7.4.q;9 V=a.4||a;o(n!=V.q){8 1L}J{o(F.13(7.4[n-1]-V[n-1])>17.16){8 1L}}H(--n);8 2x},1q:l(){8 v.u(7.4)},1b:l(a){9 b=[];7.28(l(x,i){b.19(a(x,i))});8 v.u(b)},28:l(a){9 n=7.4.q,k=n,i;J{i=k-n;a(7.4[i],i+1)}H(--n)},2q:l(){9 r=7.1u();o(r===0){8 7.1q()}8 7.1b(l(x){8 x/r})},1C:l(a){9 V=a.4||a;9 n=7.4.q,k=n,i;o(n!=V.q){8 w}9 b=0,1D=0,1F=0;7.28(l(x,i){b+=x*V[i-1];1D+=x*x;1F+=V[i-1]*V[i-1]});1D=F.1x(1D);1F=F.1x(1F);o(1D*1F===0){8 w}9 c=b/(1D*1F);o(c<-1){c=-1}o(c>1){c=1}8 F.37(c)},1m:l(a){9 b=7.1C(a);8(b===w)?w:(b<=17.16)},34:l(a){9 b=7.1C(a);8(b===w)?w:(F.13(b-F.1A)<=17.16)},2k:l(a){9 b=7.2u(a);8(b===w)?w:(F.13(b)<=17.16)},2j:l(a){9 V=a.4||a;o(7.4.q!=V.q){8 w}8 7.1b(l(x,i){8 x+V[i-1]})},2C:l(a){9 V=a.4||a;o(7.4.q!=V.q){8 w}8 7.1b(l(x,i){8 x-V[i-1]})},22:l(k){8 7.1b(l(x){8 x*k})},x:l(k){8 7.22(k)},2u:l(a){9 V=a.4||a;9 i,2g=0,n=7.4.q;o(n!=V.q){8 w}J{2g+=7.4[n-1]*V[n-1]}H(--n);8 2g},2f:l(a){9 B=a.4||a;o(7.4.q!=3||B.q!=3){8 w}9 A=7.4;8 v.u([(A[1]*B[2])-(A[2]*B[1]),(A[2]*B[0])-(A[0]*B[2]),(A[0]*B[1])-(A[1]*B[0])])},2A:l(){9 m=0,n=7.4.q,k=n,i;J{i=k-n;o(F.13(7.4[i])>F.13(m)){m=7.4[i]}}H(--n);8 m},2Z:l(x){9 a=w,n=7.4.q,k=n,i;J{i=k-n;o(a===w&&7.4[i]==x){a=i+1}}H(--n);8 a},3g:l(){8 S.2X(7.4)},2d:l(){8 7.1b(l(x){8 F.2d(x)})},2V:l(x){8 7.1b(l(y){8(F.13(y-x)<=17.16)?x:y})},1o:l(a){o(a.K){8 a.1o(7)}9 V=a.4||a;o(V.q!=7.4.q){8 w}9 b=0,2b;7.28(l(x,i){2b=x-V[i-1];b+=2b*2b});8 F.1x(b)},3a:l(a){8 a.1h(7)},2T:l(a){8 a.1h(7)},1V:l(t,a){9 V,R,x,y,z;2S(7.4.q){27 2:V=a.4||a;o(V.q!=2){8 w}R=S.1R(t).4;x=7.4[0]-V[0];y=7.4[1]-V[1];8 v.u([V[0]+R[0][0]*x+R[0][1]*y,V[1]+R[1][0]*x+R[1][1]*y]);1I;27 3:o(!a.U){8 w}9 C=a.1r(7).4;R=S.1R(t,a.U).4;x=7.4[0]-C[0];y=7.4[1]-C[1];z=7.4[2]-C[2];8 v.u([C[0]+R[0][0]*x+R[0][1]*y+R[0][2]*z,C[1]+R[1][0]*x+R[1][1]*y+R[1][2]*z,C[2]+R[2][0]*x+R[2][1]*y+R[2][2]*z]);1I;2P:8 w}},1t:l(a){o(a.K){9 P=7.4.2O();9 C=a.1r(P).4;8 v.u([C[0]+(C[0]-P[0]),C[1]+(C[1]-P[1]),C[2]+(C[2]-(P[2]||0))])}1d{9 Q=a.4||a;o(7.4.q!=Q.q){8 w}8 7.1b(l(x,i){8 Q[i-1]+(Q[i-1]-x)})}},1N:l(){9 V=7.1q();2S(V.4.q){27 3:1I;27 2:V.4.19(0);1I;2P:8 w}8 V},2n:l(){8'['+7.4.2K(', ')+']'},26:l(a){7.4=(a.4||a).2O();8 7}};v.u=l(a){9 V=25 v();8 V.26(a)};v.i=v.u([1,0,0]);v.j=v.u([0,1,0]);v.k=v.u([0,0,1]);v.2J=l(n){9 a=[];J{a.19(F.2F())}H(--n);8 v.u(a)};v.1j=l(n){9 a=[];J{a.19(0)}H(--n);8 v.u(a)};l S(){}S.23={e:l(i,j){o(i<1||i>7.4.q||j<1||j>7.4[0].q){8 w}8 7.4[i-1][j-1]},33:l(i){o(i>7.4.q){8 w}8 v.u(7.4[i-1])},2E:l(j){o(j>7.4[0].q){8 w}9 a=[],n=7.4.q,k=n,i;J{i=k-n;a.19(7.4[i][j-1])}H(--n);8 v.u(a)},2R:l(){8{2D:7.4.q,1p:7.4[0].q}},2D:l(){8 7.4.q},1p:l(){8 7.4[0].q},24:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}o(7.4.q!=M.q||7.4[0].q!=M[0].q){8 1L}9 b=7.4.q,15=b,i,G,10=7.4[0].q,j;J{i=15-b;G=10;J{j=10-G;o(F.13(7.4[i][j]-M[i][j])>17.16){8 1L}}H(--G)}H(--b);8 2x},1q:l(){8 S.u(7.4)},1b:l(a){9 b=[],12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;b[i]=[];J{j=10-G;b[i][j]=a(7.4[i][j],i+1,j+1)}H(--G)}H(--12);8 S.u(b)},2i:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}8(7.4.q==M.q&&7.4[0].q==M[0].q)},2j:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}o(!7.2i(M)){8 w}8 7.1b(l(x,i,j){8 x+M[i-1][j-1]})},2C:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}o(!7.2i(M)){8 w}8 7.1b(l(x,i,j){8 x-M[i-1][j-1]})},2B:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}8(7.4[0].q==M.q)},22:l(a){o(!a.4){8 7.1b(l(x){8 x*a})}9 b=a.1u?2x:1L;9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}o(!7.2B(M)){8 w}9 d=7.4.q,15=d,i,G,10=M[0].q,j;9 e=7.4[0].q,4=[],21,20,c;J{i=15-d;4[i]=[];G=10;J{j=10-G;21=0;20=e;J{c=e-20;21+=7.4[i][c]*M[c][j]}H(--20);4[i][j]=21}H(--G)}H(--d);9 M=S.u(4);8 b?M.2E(1):M},x:l(a){8 7.22(a)},32:l(a,b,c,d){9 e=[],12=c,i,G,j;9 f=7.4.q,1p=7.4[0].q;J{i=c-12;e[i]=[];G=d;J{j=d-G;e[i][j]=7.4[(a+i-1)%f][(b+j-1)%1p]}H(--G)}H(--12);8 S.u(e)},31:l(){9 a=7.4.q,1p=7.4[0].q;9 b=[],12=1p,i,G,j;J{i=1p-12;b[i]=[];G=a;J{j=a-G;b[i][j]=7.4[j][i]}H(--G)}H(--12);8 S.u(b)},1y:l(){8(7.4.q==7.4[0].q)},2A:l(){9 m=0,12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;J{j=10-G;o(F.13(7.4[i][j])>F.13(m)){m=7.4[i][j]}}H(--G)}H(--12);8 m},2Z:l(x){9 a=w,12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;J{j=10-G;o(7.4[i][j]==x){8{i:i+1,j:j+1}}}H(--G)}H(--12);8 w},30:l(){o(!7.1y){8 w}9 a=[],n=7.4.q,k=n,i;J{i=k-n;a.19(7.4[i][i])}H(--n);8 v.u(a)},1K:l(){9 M=7.1q(),1c;9 n=7.4.q,k=n,i,1s,1n=7.4[0].q,p;J{i=k-n;o(M.4[i][i]==0){2e(j=i+1;j<k;j++){o(M.4[j][i]!=0){1c=[];1s=1n;J{p=1n-1s;1c.19(M.4[i][p]+M.4[j][p])}H(--1s);M.4[i]=1c;1I}}}o(M.4[i][i]!=0){2e(j=i+1;j<k;j++){9 a=M.4[j][i]/M.4[i][i];1c=[];1s=1n;J{p=1n-1s;1c.19(p<=i?0:M.4[j][p]-M.4[i][p]*a)}H(--1s);M.4[j]=1c}}}H(--n);8 M},3h:l(){8 7.1K()},2z:l(){o(!7.1y()){8 w}9 M=7.1K();9 a=M.4[0][0],n=M.4.q-1,k=n,i;J{i=k-n+1;a=a*M.4[i][i]}H(--n);8 a},3f:l(){8 7.2z()},2y:l(){8(7.1y()&&7.2z()===0)},2Y:l(){o(!7.1y()){8 w}9 a=7.4[0][0],n=7.4.q-1,k=n,i;J{i=k-n+1;a+=7.4[i][i]}H(--n);8 a},3e:l(){8 7.2Y()},1Y:l(){9 M=7.1K(),1Y=0;9 a=7.4.q,15=a,i,G,10=7.4[0].q,j;J{i=15-a;G=10;J{j=10-G;o(F.13(M.4[i][j])>17.16){1Y++;1I}}H(--G)}H(--a);8 1Y},3d:l(){8 7.1Y()},2W:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}9 T=7.1q(),1p=T.4[0].q;9 b=T.4.q,15=b,i,G,10=M[0].q,j;o(b!=M.q){8 w}J{i=15-b;G=10;J{j=10-G;T.4[i][1p+j]=M[i][j]}H(--G)}H(--b);8 T},2w:l(){o(!7.1y()||7.2y()){8 w}9 a=7.4.q,15=a,i,j;9 M=7.2W(S.I(a)).1K();9 b,1n=M.4[0].q,p,1c,2v;9 c=[],2c;J{i=a-1;1c=[];b=1n;c[i]=[];2v=M.4[i][i];J{p=1n-b;2c=M.4[i][p]/2v;1c.19(2c);o(p>=15){c[i].19(2c)}}H(--b);M.4[i]=1c;2e(j=0;j<i;j++){1c=[];b=1n;J{p=1n-b;1c.19(M.4[j][p]-M.4[i][p]*M.4[j][i])}H(--b);M.4[j]=1c}}H(--a);8 S.u(c)},3c:l(){8 7.2w()},2d:l(){8 7.1b(l(x){8 F.2d(x)})},2V:l(x){8 7.1b(l(p){8(F.13(p-x)<=17.16)?x:p})},2n:l(){9 a=[];9 n=7.4.q,k=n,i;J{i=k-n;a.19(v.u(7.4[i]).2n())}H(--n);8 a.2K('\\n')},26:l(a){9 i,4=a.4||a;o(1g(4[0][0])!='1f'){9 b=4.q,15=b,G,10,j;7.4=[];J{i=15-b;G=4[i].q;10=G;7.4[i]=[];J{j=10-G;7.4[i][j]=4[i][j]}H(--G)}H(--b);8 7}9 n=4.q,k=n;7.4=[];J{i=k-n;7.4.19([4[i]])}H(--n);8 7}};S.u=l(a){9 M=25 S();8 M.26(a)};S.I=l(n){9 a=[],k=n,i,G,j;J{i=k-n;a[i]=[];G=k;J{j=k-G;a[i][j]=(i==j)?1:0}H(--G)}H(--n);8 S.u(a)};S.2X=l(a){9 n=a.q,k=n,i;9 M=S.I(n);J{i=k-n;M.4[i][i]=a[i]}H(--n);8 M};S.1R=l(b,a){o(!a){8 S.u([[F.1H(b),-F.1G(b)],[F.1G(b),F.1H(b)]])}9 d=a.1q();o(d.4.q!=3){8 w}9 e=d.1u();9 x=d.4[0]/e,y=d.4[1]/e,z=d.4[2]/e;9 s=F.1G(b),c=F.1H(b),t=1-c;8 S.u([[t*x*x+c,t*x*y-s*z,t*x*z+s*y],[t*x*y+s*z,t*y*y+c,t*y*z-s*x],[t*x*z-s*y,t*y*z+s*x,t*z*z+c]])};S.3b=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[1,0,0],[0,c,-s],[0,s,c]])};S.39=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[c,0,s],[0,1,0],[-s,0,c]])};S.38=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[c,-s,0],[s,c,0],[0,0,1]])};S.2J=l(n,m){8 S.1j(n,m).1b(l(){8 F.2F()})};S.1j=l(n,m){9 a=[],12=n,i,G,j;J{i=n-12;a[i]=[];G=m;J{j=m-G;a[i][j]=0}H(--G)}H(--12);8 S.u(a)};l 14(){}14.23={24:l(a){8(7.1m(a)&&7.1h(a.K))},1q:l(){8 14.u(7.K,7.U)},2U:l(a){9 V=a.4||a;8 14.u([7.K.4[0]+V[0],7.K.4[1]+V[1],7.K.4[2]+(V[2]||0)],7.U)},1m:l(a){o(a.W){8 a.1m(7)}9 b=7.U.1C(a.U);8(F.13(b)<=17.16||F.13(b-F.1A)<=17.16)},1o:l(a){o(a.W){8 a.1o(7)}o(a.U){o(7.1m(a)){8 7.1o(a.K)}9 N=7.U.2f(a.U).2q().4;9 A=7.K.4,B=a.K.4;8 F.13((A[0]-B[0])*N[0]+(A[1]-B[1])*N[1]+(A[2]-B[2])*N[2])}1d{9 P=a.4||a;9 A=7.K.4,D=7.U.4;9 b=P[0]-A[0],2a=P[1]-A[1],29=(P[2]||0)-A[2];9 c=F.1x(b*b+2a*2a+29*29);o(c===0)8 0;9 d=(b*D[0]+2a*D[1]+29*D[2])/c;9 e=1-d*d;8 F.13(c*F.1x(e<0?0:e))}},1h:l(a){9 b=7.1o(a);8(b!==w&&b<=17.16)},2T:l(a){8 a.1h(7)},1v:l(a){o(a.W){8 a.1v(7)}8(!7.1m(a)&&7.1o(a)<=17.16)},1U:l(a){o(a.W){8 a.1U(7)}o(!7.1v(a)){8 w}9 P=7.K.4,X=7.U.4,Q=a.K.4,Y=a.U.4;9 b=X[0],1z=X[1],1B=X[2],1T=Y[0],1S=Y[1],1M=Y[2];9 c=P[0]-Q[0],2s=P[1]-Q[1],2r=P[2]-Q[2];9 d=-b*c-1z*2s-1B*2r;9 e=1T*c+1S*2s+1M*2r;9 f=b*b+1z*1z+1B*1B;9 g=1T*1T+1S*1S+1M*1M;9 h=b*1T+1z*1S+1B*1M;9 k=(d*g/f+h*e)/(g-h*h);8 v.u([P[0]+k*b,P[1]+k*1z,P[2]+k*1B])},1r:l(a){o(a.U){o(7.1v(a)){8 7.1U(a)}o(7.1m(a)){8 w}9 D=7.U.4,E=a.U.4;9 b=D[0],1l=D[1],1k=D[2],1P=E[0],1O=E[1],1Q=E[2];9 x=(1k*1P-b*1Q),y=(b*1O-1l*1P),z=(1l*1Q-1k*1O);9 N=v.u([x*1Q-y*1O,y*1P-z*1Q,z*1O-x*1P]);9 P=11.u(a.K,N);8 P.1U(7)}1d{9 P=a.4||a;o(7.1h(P)){8 v.u(P)}9 A=7.K.4,D=7.U.4;9 b=D[0],1l=D[1],1k=D[2],1w=A[0],18=A[1],1a=A[2];9 x=b*(P[1]-18)-1l*(P[0]-1w),y=1l*((P[2]||0)-1a)-1k*(P[1]-18),z=1k*(P[0]-1w)-b*((P[2]||0)-1a);9 V=v.u([1l*x-1k*z,1k*y-b*x,b*z-1l*y]);9 k=7.1o(P)/V.1u();8 v.u([P[0]+V.4[0]*k,P[1]+V.4[1]*k,(P[2]||0)+V.4[2]*k])}},1V:l(t,a){o(1g(a.U)=='1f'){a=14.u(a.1N(),v.k)}9 R=S.1R(t,a.U).4;9 C=a.1r(7.K).4;9 A=7.K.4,D=7.U.4;9 b=C[0],1E=C[1],1J=C[2],1w=A[0],18=A[1],1a=A[2];9 x=1w-b,y=18-1E,z=1a-1J;8 14.u([b+R[0][0]*x+R[0][1]*y+R[0][2]*z,1E+R[1][0]*x+R[1][1]*y+R[1][2]*z,1J+R[2][0]*x+R[2][1]*y+R[2][2]*z],[R[0][0]*D[0]+R[0][1]*D[1]+R[0][2]*D[2],R[1][0]*D[0]+R[1][1]*D[1]+R[1][2]*D[2],R[2][0]*D[0]+R[2][1]*D[1]+R[2][2]*D[2]])},1t:l(a){o(a.W){9 A=7.K.4,D=7.U.4;9 b=A[0],18=A[1],1a=A[2],2N=D[0],1l=D[1],1k=D[2];9 c=7.K.1t(a).4;9 d=b+2N,2h=18+1l,2o=1a+1k;9 Q=a.1r([d,2h,2o]).4;9 e=[Q[0]+(Q[0]-d)-c[0],Q[1]+(Q[1]-2h)-c[1],Q[2]+(Q[2]-2o)-c[2]];8 14.u(c,e)}1d o(a.U){8 7.1V(F.1A,a)}1d{9 P=a.4||a;8 14.u(7.K.1t([P[0],P[1],(P[2]||0)]),7.U)}},1Z:l(a,b){a=v.u(a);b=v.u(b);o(a.4.q==2){a.4.19(0)}o(b.4.q==2){b.4.19(0)}o(a.4.q>3||b.4.q>3){8 w}9 c=b.1u();o(c===0){8 w}7.K=a;7.U=v.u([b.4[0]/c,b.4[1]/c,b.4[2]/c]);8 7}};14.u=l(a,b){9 L=25 14();8 L.1Z(a,b)};14.X=14.u(v.1j(3),v.i);14.Y=14.u(v.1j(3),v.j);14.Z=14.u(v.1j(3),v.k);l 11(){}11.23={24:l(a){8(7.1h(a.K)&&7.1m(a))},1q:l(){8 11.u(7.K,7.W)},2U:l(a){9 V=a.4||a;8 11.u([7.K.4[0]+V[0],7.K.4[1]+V[1],7.K.4[2]+(V[2]||0)],7.W)},1m:l(a){9 b;o(a.W){b=7.W.1C(a.W);8(F.13(b)<=17.16||F.13(F.1A-b)<=17.16)}1d o(a.U){8 7.W.2k(a.U)}8 w},2k:l(a){9 b=7.W.1C(a.W);8(F.13(F.1A/2-b)<=17.16)},1o:l(a){o(7.1v(a)||7.1h(a)){8 0}o(a.K){9 A=7.K.4,B=a.K.4,N=7.W.4;8 F.13((A[0]-B[0])*N[0]+(A[1]-B[1])*N[1]+(A[2]-B[2])*N[2])}1d{9 P=a.4||a;9 A=7.K.4,N=7.W.4;8 F.13((A[0]-P[0])*N[0]+(A[1]-P[1])*N[1]+(A[2]-(P[2]||0))*N[2])}},1h:l(a){o(a.W){8 w}o(a.U){8(7.1h(a.K)&&7.1h(a.K.2j(a.U)))}1d{9 P=a.4||a;9 A=7.K.4,N=7.W.4;9 b=F.13(N[0]*(A[0]-P[0])+N[1]*(A[1]-P[1])+N[2]*(A[2]-(P[2]||0)));8(b<=17.16)}},1v:l(a){o(1g(a.U)=='1f'&&1g(a.W)=='1f'){8 w}8!7.1m(a)},1U:l(a){o(!7.1v(a)){8 w}o(a.U){9 A=a.K.4,D=a.U.4,P=7.K.4,N=7.W.4;9 b=(N[0]*(P[0]-A[0])+N[1]*(P[1]-A[1])+N[2]*(P[2]-A[2]))/(N[0]*D[0]+N[1]*D[1]+N[2]*D[2]);8 v.u([A[0]+D[0]*b,A[1]+D[1]*b,A[2]+D[2]*b])}1d o(a.W){9 c=7.W.2f(a.W).2q();9 N=7.W.4,A=7.K.4,O=a.W.4,B=a.K.4;9 d=S.1j(2,2),i=0;H(d.2y()){i++;d=S.u([[N[i%3],N[(i+1)%3]],[O[i%3],O[(i+1)%3]]])}9 e=d.2w().4;9 x=N[0]*A[0]+N[1]*A[1]+N[2]*A[2];9 y=O[0]*B[0]+O[1]*B[1]+O[2]*B[2];9 f=[e[0][0]*x+e[0][1]*y,e[1][0]*x+e[1][1]*y];9 g=[];2e(9 j=1;j<=3;j++){g.19((i==j)?0:f[(j+(5-i)%3)%3])}8 14.u(g,c)}},1r:l(a){9 P=a.4||a;9 A=7.K.4,N=7.W.4;9 b=(A[0]-P[0])*N[0]+(A[1]-P[1])*N[1]+(A[2]-(P[2]||0))*N[2];8 v.u([P[0]+N[0]*b,P[1]+N[1]*b,(P[2]||0)+N[2]*b])},1V:l(t,a){9 R=S.1R(t,a.U).4;9 C=a.1r(7.K).4;9 A=7.K.4,N=7.W.4;9 b=C[0],1E=C[1],1J=C[2],1w=A[0],18=A[1],1a=A[2];9 x=1w-b,y=18-1E,z=1a-1J;8 11.u([b+R[0][0]*x+R[0][1]*y+R[0][2]*z,1E+R[1][0]*x+R[1][1]*y+R[1][2]*z,1J+R[2][0]*x+R[2][1]*y+R[2][2]*z],[R[0][0]*N[0]+R[0][1]*N[1]+R[0][2]*N[2],R[1][0]*N[0]+R[1][1]*N[1]+R[1][2]*N[2],R[2][0]*N[0]+R[2][1]*N[1]+R[2][2]*N[2]])},1t:l(a){o(a.W){9 A=7.K.4,N=7.W.4;9 b=A[0],18=A[1],1a=A[2],2M=N[0],2L=N[1],2Q=N[2];9 c=7.K.1t(a).4;9 d=b+2M,2p=18+2L,2m=1a+2Q;9 Q=a.1r([d,2p,2m]).4;9 e=[Q[0]+(Q[0]-d)-c[0],Q[1]+(Q[1]-2p)-c[1],Q[2]+(Q[2]-2m)-c[2]];8 11.u(c,e)}1d o(a.U){8 7.1V(F.1A,a)}1d{9 P=a.4||a;8 11.u(7.K.1t([P[0],P[1],(P[2]||0)]),7.W)}},1Z:l(a,b,c){a=v.u(a);a=a.1N();o(a===w){8 w}b=v.u(b);b=b.1N();o(b===w){8 w}o(1g(c)=='1f'){c=w}1d{c=v.u(c);c=c.1N();o(c===w){8 w}}9 d=a.4[0],18=a.4[1],1a=a.4[2];9 e=b.4[0],1W=b.4[1],1X=b.4[2];9 f,1i;o(c!==w){9 g=c.4[0],2l=c.4[1],2t=c.4[2];f=v.u([(1W-18)*(2t-1a)-(1X-1a)*(2l-18),(1X-1a)*(g-d)-(e-d)*(2t-1a),(e-d)*(2l-18)-(1W-18)*(g-d)]);1i=f.1u();o(1i===0){8 w}f=v.u([f.4[0]/1i,f.4[1]/1i,f.4[2]/1i])}1d{1i=F.1x(e*e+1W*1W+1X*1X);o(1i===0){8 w}f=v.u([b.4[0]/1i,b.4[1]/1i,b.4[2]/1i])}7.K=a;7.W=f;8 7}};11.u=l(a,b,c){9 P=25 11();8 P.1Z(a,b,c)};11.2I=11.u(v.1j(3),v.k);11.2H=11.u(v.1j(3),v.i);11.2G=11.u(v.1j(3),v.j);11.36=11.2I;11.35=11.2H;11.3j=11.2G;9 $V=v.u;9 $M=S.u;9 $L=14.u;9 $P=11.u;",62,206,"||||elements|||this|return|var||||||||||||function|||if||length||||create|Vector|null|||||||||Math|nj|while||do|anchor||||||||Matrix||direction||normal||||kj|Plane|ni|abs|Line|ki|precision|Sylvester|A2|push|A3|map|els|else||undefined|typeof|contains|mod|Zero|D3|D2|isParallelTo|kp|distanceFrom|cols|dup|pointClosestTo|np|reflectionIn|modulus|intersects|A1|sqrt|isSquare|X2|PI|X3|angleFrom|mod1|C2|mod2|sin|cos|break|C3|toRightTriangular|false|Y3|to3D|E2|E1|E3|Rotation|Y2|Y1|intersectionWith|rotate|v12|v13|rank|setVectors|nc|sum|multiply|prototype|eql|new|setElements|case|each|PA3|PA2|part|new_element|round|for|cross|product|AD2|isSameSizeAs|add|isPerpendicularTo|v22|AN3|inspect|AD3|AN2|toUnitVector|PsubQ3|PsubQ2|v23|dot|divisor|inverse|true|isSingular|determinant|max|canMultiplyFromLeft|subtract|rows|col|random|ZX|YZ|XY|Random|join|N2|N1|D1|slice|default|N3|dimensions|switch|liesIn|translate|snapTo|augment|Diagonal|trace|indexOf|diagonal|transpose|minor|row|isAntiparallelTo|ZY|YX|acos|RotationZ|RotationY|liesOn|RotationX|inv|rk|tr|det|toDiagonalMatrix|toUpperTriangular|version|XZ".split("|"),0,{}));function extend(e,t){var n=e.prototype,r=function(){};r.prototype=t.prototype,e.prototype=new r,e.superclass=t.prototype,e.prototype.constructor=e,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t);for(var i in n)n.hasOwnProperty(i)&&(e.prototype[i]=n[i])}function proxy(e,t,n,r){if(typeof e=="function")return e.__isProxy?e:function(e){var i=function(){t&&t({fn:e,arguments:Array.prototype.slice.call(arguments)});var i=null;try{i=e.apply(e,Array.prototype.slice.call(arguments)),n&&n({fn:e,arguments:Array.prototype.slice.call(arguments)})}catch(s){if(!r)throw s;i=r({fn:e,arguments:Array.prototype.slice.call(arguments),exception:s})}return i};return i.__isProxy=!0,i}(e);if(!typeof e==="object"||e.constructor===Array||e.constructor===String||e.__isProxy)return e;var i=function(){},s=new i;s.__object=e,s.__isProxy=!0;for(var o in e)typeof e[o]=="function"&&(s[o]=function(e,i,s){return function(){t&&t({object:e.__object,method:s,arguments:Array.prototype.slice.call(arguments)});var o=null;try{o=i.apply(e.__object,arguments),n&&n({object:e.__object,method:s,arguments:Array.prototype.slice.call(arguments)})}catch(u){if(!r)throw u;o=r({object:e.__object,method:s,arguments:Array.prototype.slice.call(arguments),exception:u})}return o}}(s,e[o],o));return s}function makePerspective(e,t,n,r,i){var s=n*Math.tan(e*Math.PI/360),o=-s,u=o*t,a=s*t;return makeFrustum(u,a,o,s,n,r,i)}function makeFrustum(e,t,n,r,i,s,o){var u=2*i/(t-e),a=2*i/(r-n),f=(t+e)/(t-e),l=(r+n)/(r-n),c=-(s+i)/(s-i),h=-2*s*i/(s-i);return(new CAAT.Matrix3).initWithMatrix([[u,0,f,-o/2],[0,-a,l,o/2],[0,0,c,h],[0,0,-1,0]])}function makeOrtho(e,t,n,r,i,s){var o=-(t+e)/(t-e),u=-(r+n)/(r-n),a=-(s+i)/(s-i);return(new CAAT.Matrix3).initWithMatrix([[2/(t-e),0,0,o],[0,2/(r-n),0,u],[0,0,-2/(s-i),a],[0,0,0,1]])}var CAAT=CAAT||{};Function.prototype.bind=function(){var e=this,t=Array.prototype.slice.call(arguments),n=t.shift();return function(){return e.apply(n,t.concat(Array.prototype.slice.call(arguments)))}},function(){CAAT.Behavior=function(){return this.lifecycleListenerList=[],this.setDefaultInterpolator(),this},CAAT.Behavior.prototype={lifecycleListenerList:null,behaviorStartTime:-1,behaviorDuration:-1,cycleBehavior:!1,expired:!0,interpolator:null,actor:null,id:0,setId:function(e){return this.id=e,this},setDefaultInterpolator:function(){return this.interpolator=(new CAAT.Interpolator).createLinearInterpolator(!1),this},setPingPong:function(){return this.interpolator=(new CAAT.Interpolator).createLinearInterpolator(!0),this},setFrameTime:function(e,t){return this.behaviorStartTime=e,this.behaviorDuration=t,this.expired=!1,this},setOutOfFrameTime:function(){return this.expired=!0,this.behaviorStartTime=Number.MAX_VALUE,this.behaviorDuration=0,this},setInterpolator:function(e){return this.interpolator=e,this},apply:function(e,t){var n=e;this.isBehaviorInTime(e,t)&&(e=this.normalizeTime(e),this.fireBehaviorAppliedEvent(t,n,e,this.setForTime(e,t)))},setCycle:function(e){return this.cycleBehavior=e,this},addListener:function(e){return this.lifecycleListenerList.push(e),this},emptyListenerList:function(){return this.lifecycleListenerList=[],this},getStartTime:function(){return this.behaviorStartTime},getDuration:function(){return this.behaviorDuration},isBehaviorInTime:function(e,t){return this.expired||this.behaviorStartTime<0?!1:(this.cycleBehavior&&e>=this.behaviorStartTime&&(e=(e-this.behaviorStartTime)%this.behaviorDuration+this.behaviorStartTime),e>this.behaviorStartTime+this.behaviorDuration?(this.expired||this.setExpired(t,e),!1):this.behaviorStartTime<=e&&e<this.behaviorStartTime+this.behaviorDuration)},fireBehaviorExpiredEvent:function(e,t){for(var n=0;n<this.lifecycleListenerList.length;n++)this.lifecycleListenerList[n].behaviorExpired(this,t,e)},fireBehaviorAppliedEvent:function(e,t,n,r){for(var i=0;i<this.lifecycleListenerList.length;i++)this.lifecycleListenerList[i].behaviorApplied&&this.lifecycleListenerList[i].behaviorApplied(this,t,n,e,r)},normalizeTime:function(e){return e-=this.behaviorStartTime,this.cycleBehavior&&(e%=this.behaviorDuration),this.interpolator.getPosition(e/this.behaviorDuration).y},setExpired:function(e,t){this.expired=!0,this.setForTime(this.interpolator.getPosition(1).y,e),this.fireBehaviorExpiredEvent(e,t)},setForTime:function(e,t){},initialize:function(e){if(e)for(var t in e)this[t]=e[t];return this}}}(),function(){CAAT.ContainerBehavior=function(){return CAAT.ContainerBehavior.superclass.constructor.call(this),this.behaviors=[],this},CAAT.ContainerBehavior.prototype={behaviors:null,addBehavior:function(e){return this.behaviors.push(e),e.addListener(this),this},apply:function(e,t){if(this.isBehaviorInTime(e,t)){e-=this.getStartTime(),this.cycleBehavior&&(e%=this.getDuration());for(var n=0;n<this.behaviors.length;n++)this.behaviors[n].apply(e,t)}},setInterpolator:function(e){return this},behaviorExpired:function(e,t,n){this.cycleBehavior&&(e.expired=!1)},setForTime:function(e,t){for(var n=0;n<this.behaviors.length;n++)this.behaviors[n].setForTime(e,t);return null}},extend(CAAT.ContainerBehavior,CAAT.Behavior,null)}(),function(){CAAT.RotateBehavior=function(){return CAAT.RotateBehavior.superclass.constructor.call(this),this.anchor=CAAT.Actor.prototype.ANCHOR_CENTER,this},CAAT.RotateBehavior.prototype={startAngle:0,endAngle:0,anchorX:.5,anchorY:.5,setForTime:function(e,t){var n=this.startAngle+e*(this.endAngle-this.startAngle);return t.setRotationAnchored(n,this.anchorX*t.width,this.anchorY*t.height),n},setValues:function(e,t,n,r){return this.startAngle=e,this.endAngle=t,n!==undefined&&r!==undefined&&(this.anchorX=n/100,this.anchorY=r/100),this},setAngles:function(e,t){return this.setValues(e,t)},setAnchor:function(e,t,n){return this.anchorX=t/e.width,this.anchorY=n/e.height,this}},extend(CAAT.RotateBehavior,CAAT.Behavior,null)}(),function(){CAAT.GenericBehavior=function(){return CAAT.GenericBehavior.superclass.constructor.call(this),this},CAAT.GenericBehavior.prototype={start:0,end:0,target:null,property:null,callback:null,setForTime:function(e,t){var n=this.start+e*(this.end-this.start);this.callback&&this.callback(n,this.target,t),this.property&&(this.target[this.property]=n)},setValues:function(e,t,n,r,i){return this.start=e,this.end=t,this.target=n,this.property=r,this.callback=i,this}},extend(CAAT.GenericBehavior,CAAT.Behavior,null)}(),function(){CAAT.ScaleBehavior=function(){return CAAT.ScaleBehavior.superclass.constructor.call(this),this.anchor=CAAT.Actor.prototype.ANCHOR_CENTER,this},CAAT.ScaleBehavior.prototype={startScaleX:0,endScaleX:0,startScaleY:0,endScaleY:0,anchorX:.5,anchorY:.5,setForTime:function(e,t){var n=this.startScaleX+e*(this.endScaleX-this.startScaleX),r=this.startScaleY+e*(this.endScaleY-this.startScaleY);return 0===n&&(n=.01),0===r&&(r=.01),t.setScaleAnchored(n,r,this.anchorX*t.width,this.anchorY*t.height),{scaleX:n,scaleY:r}},setValues:function(e,t,n,r,i,s){return this.startScaleX=e,this.endScaleX=t,this.startScaleY=n,this.endScaleY=r,i!==undefined&&s!==undefined&&i!==null&&s!==null&&(this.anchorX=i/100,this.anchorY=s/100),this},setAnchor:function(e,t,n){return this.anchorX=t/e.width,this.anchorY=n/e.height,this}},extend(CAAT.ScaleBehavior,CAAT.Behavior,null)}(),function(){CAAT.AlphaBehavior=function(){return CAAT.AlphaBehavior.superclass.constructor.call(this),this},CAAT.AlphaBehavior.prototype={startAlpha:0,endAlpha:0,setForTime:function(e,t){var n=this.startAlpha+e*(this.endAlpha-this.startAlpha);return t.setAlpha(n),n},setValues:function(e,t){return this.startAlpha=e,this.endAlpha=t,this}},extend(CAAT.AlphaBehavior,CAAT.Behavior,null)}(),function(){CAAT.PathBehavior=function(){return CAAT.PathBehavior.superclass.constructor.call(this),this},CAAT.PathBehavior.autorotate={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1,FREE:2},CAAT.PathBehavior.prototype={path:null,autoRotate:!1,prevX:-1,prevY:-1,autoRotateOp:CAAT.PathBehavior.autorotate.FREE,translateX:0,translateY:0,setAutoRotate:function(e,t){return this.autoRotate=e,t!==undefined&&(this.autoRotateOp=t),this},setPath:function(e){return this.path=e,this},setValues:function(e){return this.setPath(e)},setFrameTime:function(e,t){return CAAT.PathBehavior.superclass.setFrameTime.call(this,e,t),this.prevX=-1,this.prevY=-1,this},setTranslation:function(e,t){return this.translateX=e,this.translateY=t,this},setForTime:function(e,t){if(!this.path)return{x:t.x,y:t.y};var n=this.path.getPosition(e);if(this.autoRotate){-1===this.prevX&&-1===this.prevY&&(this.prevX=n.x,this.prevY=n.y);var r=n.x-this.prevX,i=n.y-this.prevY;if(r===0&&i===0)return t.setLocation(n.x-this.translateX,n.y-this.translateY),{x:t.x,y:t.y};var s=Math.atan2(i,r);this.autoRotateOp===CAAT.PathBehavior.autorotate.LEFT_TO_RIGHT?this.prevX<=n.x?t.setImageTransformation(CAAT.SpriteImage.prototype.TR_NONE):(t.setImageTransformation(CAAT.SpriteImage.prototype.TR_FLIP_HORIZONTAL),s+=Math.PI):this.autoRotateOp===CAAT.PathBehavior.autorotate.RIGHT_TO_LEFT&&(this.prevX<=n.x?t.setImageTransformation(CAAT.SpriteImage.prototype.TR_FLIP_HORIZONTAL):(t.setImageTransformation(CAAT.SpriteImage.prototype.TR_NONE),s-=Math.PI)),t.setRotation(s),this.prevX=n.x,this.prevY=n.y;var o=Math.sqrt(r*r+i*i);r/=o,i/=o}return t.setLocation(n.x-this.translateX,n.y-this.translateY),{x:t.x,y:t.y}},positionOnTime:function(e){return this.isBehaviorInTime(e,null)?(e=this.normalizeTime(e),this.path.getPosition(e)):{x:-1,y:-1}}},extend(CAAT.PathBehavior,CAAT.Behavior,null)}(),function(){CAAT.BrowserDetect=function(){return this.init(),this},CAAT.BrowserDetect.prototype={browser:"",version:0,OS:"",init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string,r=e[t].prop;this.versionSearchString=e[t].versionSearch||e[t].identity;if(n){if(n.indexOf(e[t].subString)!==-1)return e[t].identity}else if(r)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(t===-1)return;return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Explorer",identity:"Explorer",versionSearch:"Explorer"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]}}(),function(){CAAT.Matrix3=function(){return this.matrix=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],this.fmatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this},CAAT.Matrix3.prototype={matrix:null,fmatrix:null,transformCoord:function(e){var t=e.x,n=e.y,r=e.z;return e.x=t*this.matrix[0][0]+n*this.matrix[0][1]+r*this.matrix[0][2]+this.matrix[0][3],e.y=t*this.matrix[1][0]+n*this.matrix[1][1]+r*this.matrix[1][2]+this.matrix[1][3],e.z=t*this.matrix[2][0]+n*this.matrix[2][1]+r*this.matrix[2][2]+this.matrix[2][3],e},initialize:function(e,t,n,r,i,s,o,u,a){return this.identity(),this.matrix[0][0]=e,this.matrix[0][1]=t,this.matrix[0][2]=n,this.matrix[1][0]=r,this.matrix[1][1]=i,this.matrix[1][2]=s,this.matrix[2][0]=o,this.matrix[2][1]=u,this.matrix[2][2]=a,this},initWithMatrix:function(e){return this.matrix=e,this},flatten:function(){var e=this.fmatrix,t=this.matrix;return e[0]=t[0][0],e[1]=t[1][0],e[2]=t[2][0],e[3]=t[3][0],e[4]=t[0][1],e[5]=t[1][1],e[6]=t[2][1],e[7]=t[2][1],e[8]=t[0][2],e[9]=t[1][2],e[10]=t[2][2],e[11]=t[3][2],e[12]=t[0][3],e[13]=t[1][3],e[14]=t[2][3],e[15]=t[3][3],this.fmatrix},identity:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)this.matrix[e][t]=e===t?1:0;return this},getMatrix:function(){return this.matrix},rotateXY:function(e){return this.rotate(e,0,0)},rotateXZ:function(e){return this.rotate(0,e,0)},rotateYZ:function(e){return this.rotate(0,0,e)},setRotate:function(e,t,n){var r=this.rotate(e,t,n);return this.copy(r),this},rotate:function(e,t,n){var r=new CAAT.Matrix3,i,s,o;return e!==0&&(o=new CAAT.Matrix3,i=Math.sin(e),s=Math.cos(e),o.matrix[1][1]=s,o.matrix[1][2]=-i,o.matrix[2][1]=i,o.matrix[2][2]=s,r.multiply(o)),t!==0&&(o=new CAAT.Matrix3,i=Math.sin(t),s=Math.cos(t),o.matrix[0][0]=s,o.matrix[0][2]=-i,o.matrix[2][0]=i,o.matrix[2][2]=s,r.multiply(o)),n!==0&&(o=new CAAT.Matrix3,i=Math.sin(n),s=Math.cos(n),o.matrix[0][0]=s,o.matrix[0][1]=-i,o.matrix[1][0]=i,o.matrix[1][1]=s,r.multiply(o)),r},getClone:function(){var e=new CAAT.Matrix3;return e.copy(this),e},multiply:function(e){var t=this.getClone(),n=t.matrix,r=n[0][0],i=n[0][1],s=n[0][2],o=n[0][3],u=n[1][0],a=n[1][1],f=n[1][2],l=n[1][3],c=n[2][0],h=n[2][1],p=n[2][2],d=n[2][3],v=n[3][0],m=n[3][1],g=n[3][2],y=n[3][3],b=e.matrix,w=b[0][0],E=b[0][1],S=b[0][2],x=b[0][3],T=b[1][0],N=b[1][1],C=b[1][2],k=b[1][3],L=b[2][0],A=b[2][1],O=b[2][2],M=b[2][3],_=b[3][0],D=b[3][1],P=b[3][2],H=b[3][3];return this.matrix[0][0]=r*w+i*T+s*L+o*_,this.matrix[0][1]=r*E+i*N+s*A+o*D,this.matrix[0][2]=r*S+i*C+s*O+o*P,this.matrix[0][3]=r*x+i*k+s*M+o*H,this.matrix[1][0]=u*w+a*T+f*L+l*_,this.matrix[1][1]=u*E+a*N+f*A+l*D,this.matrix[1][2]=u*S+a*C+f*O+l*P,this.matrix[1][3]=u*x+a*k+f*M+l*H,this.matrix[2][0]=c*w+h*T+p*L+d*_,this.matrix[2][1]=c*E+h*N+p*A+d*D,this.matrix[2][2]=c*S+h*C+p*O+d*P,this.matrix[2][3]=c*x+h*k+p*M+d*H,this},premultiply:function(e){var t=this.getClone(),n=t.matrix,r=n[0][0],i=n[0][1],s=n[0][2],o=n[0][3],u=n[1][0],a=n[1][1],f=n[1][2],l=n[1][3],c=n[2][0],h=n[2][1],p=n[2][2],d=n[2][3],v=n[3][0],m=n[3][1],g=n[3][2],y=n[3][3],b=e.matrix,w=b[0][0],E=b[0][1],S=b[0][2],x=b[0][3],T=b[1][0],N=b[1][1],C=b[1][2],k=b[1][3],L=b[2][0],A=b[2][1],O=b[2][2],M=b[2][3],_=b[3][0],D=b[3][1],P=b[3][2],H=b[3][3];return this.matrix[0][0]=r*w+i*T+s*L,this.matrix[0][1]=r*E+i*N+s*A,this.matrix[0][2]=r*S+i*C+s*O,this.matrix[0][3]=r*x+i*k+s*M+o,this.matrix[1][0]=u*w+a*T+f*L,this.matrix[1][1]=u*E+a*N+f*A,this.matrix[1][2]=u*S+a*C+f*O,this.matrix[1][3]=u*x+a*k+f*M+l,this.matrix[2][0]=c*w+h*T+p*L,this.matrix[2][1]=c*E+h*N+p*A,this.matrix[2][2]=c*S+h*C+p*O,this.matrix[2][3]=c*x+h*k+p*M+d,this},setTranslate:function(e,t,n){return this.identity(),this.matrix[0][3]=e,this.matrix[1][3]=t,this.matrix[2][3]=n,this},translate:function(e,t,n){var r=new CAAT.Matrix3;return r.setTranslate(e,t,n),r},setScale:function(e,t,n){return this.identity(),this.matrix[0][0]=e,this.matrix[1][1]=t,this.matrix[2][2]=n,this},scale:function(e,t,n){var r=new CAAT.Matrix3;return r.setScale(e,t,n),r},rotateModelView:function(e,t,n){var r=Math.sin(e),i=Math.sin(t),s=Math.sin(n),o=Math.cos(e),u=Math.cos(t),a=Math.cos(n);return this.matrix[0][0]=u*o,this.matrix[0][1]=-u*r,this.matrix[0][2]=i,this.matrix[0][3]=0,this.matrix[1][0]=s*i*o+r*a,this.matrix[1][1]=a*o-s*i*r,this.matrix[1][2]=-s*u,this.matrix[1][3]=0,this.matrix[2][0]=s*r-a*i*o,this.matrix[2][1]=a*i*r+s*o,this.matrix[2][2]=a*u,this.matrix[2][3]=0,this.matrix[3][0]=0,this.matrix[3][1]=0,this.matrix[3][2]=0,this.matrix[3][3]=1,this},copy:function(e){for(var t=0;t<4;t++)for(var n=0;n<4;n++)this.matrix[t][n]=e.matrix[t][n];return this},calculateDeterminant:function(){var e=this.matrix,t=e[0][0],n=e[0][1],r=e[0][2],i=e[0][3],s=e[1][0],o=e[1][1],u=e[1][2],a=e[1][3],f=e[2][0],l=e[2][1],c=e[2][2],h=e[2][3],p=e[3][0],d=e[3][1],v=e[3][2],m=e[3][3];return i*o*c*p+n*a*c*p+i*u*f*d+r*a*f*d+r*s*h*d+t*u*h*d+i*s*l*v+t*a*l*v+r*o*f*m+n*u*f*m+n*s*c*m+t*o*c*m+i*u*l*p-r*a*l*p-r*o*h*p-n*u*h*p-i*s*c*d-t*a*c*d-i*o*f*v-n*a*f*v-n*s*h*v-t*o*h*v-r*s*l*m-t*u*l*m},getInverse:function(){var e=this.matrix,t=e[0][0],n=e[0][1],r=e[0][2],i=e[0][3],s=e[1][0],o=e[1][1],u=e[1][2],a=e[1][3],f=e[2][0],l=e[2][1],c=e[2][2],h=e[2][3],p=e[3][0],d=e[3][1],v=e[3][2],m=e[3][3],g=new CAAT.Matrix3;return g.matrix[0][0]=u*h*d+a*l*v+o*c*m-a*c*d-o*h*v-u*l*m,g.matrix[0][1]=i*c*d+n*h*v+r*l*m-n*c*m-r*h*d-i*l*v,g.matrix[0][2]=r*a*d+n*u*m+i*o*v-n*a*v-r*o*m-i*u*d,g.matrix[0][3]=i*u*l+n*a*c+r*o*h-r*a*l-i*o*c-n*u*h,g.matrix[1][0]=a*c*p+s*h*v+u*f*m-u*h*p-a*f*v-s*c*m,g.matrix[1][1]=r*h*p+i*f*v+t*c*m-i*c*p-t*h*v-r*f*m,g.matrix[1][2]=i*u*p+t*a*v+r*s*m-r*a*p-i*s*v-t*u*m,g.matrix[1][3]=r*a*f+i*s*c+t*u*h-i*u*f-t*a*c-r*s*h,g.matrix[2][0]=o*h*p+a*f*d+s*l*m-a*l*p-s*h*d-o*f*m,g.matrix[2][1]=i*l*p+t*h*d+n*f*m-t*l*m-n*h*p-i*f*d,g.matrix[2][2]=r*a*p+i*s*d+t*o*m-i*o*p-t*a*d-n*s*m,g.matrix[2][3]=i*o*f+t*a*l+n*s*h-t*o*h-n*a*f-i*s*l,g.matrix[3][0]=u*l*p+s*c*d+o*f*v-o*c*p-u*f*d-s*l*v,g.matrix[3][1]=n*c*p+r*f*d+t*l*v-r*l*p-t*c*d-n*f*v,g.matrix[3][2]=r*o*p+t*u*d+n*s*v-t*o*v-n*u*p-r*s*d,g.matrix[3][3]=n*u*f+r*s*l+t*o*c-r*o*f-t*u*l-n*s*c,g.multiplyScalar(1/this.calculateDeterminant())},multiplyScalar:function(e){var t,n;for(t=0;t<4;t++)for(n=0;n<4;n++)this.matrix[t][n]*=e;return this}}}(),function(){CAAT.Matrix=function(){return this.matrix=[1,0,0,0,1,0,0,0,1],this},CAAT.Matrix.prototype={matrix:null,transformCoord:function(e){var t=e.x,n=e.y;return e.x=t*this.matrix[0]+n*this.matrix[1]+this.matrix[2],e.y=t*this.matrix[3]+n*this.matrix[4]+this.matrix[5],e},rotate:function(e){var t=new CAAT.Matrix;return t.setRotation(e),t},setRotation:function(e){return this.identity(),this.matrix[0]=Math.cos(e),this.matrix[1]=-Math.sin(e),this.matrix[3]=Math.sin(e),this.matrix[4]=Math.cos(e),this},scale:function(e,t){var n=new CAAT.Matrix;return n.matrix[0]=e,n.matrix[4]=t,n},setScale:function(e,t){return this.identity(),this.matrix[0]=e,this.matrix[4]=t,this},translate:function(e,t){var n=new CAAT.Matrix;return n.matrix[2]=e,n.matrix[5]=t,n},setTranslate:function(e,t){return this.identity(),this.matrix[2]=e,this.matrix[5]=t,this},copy:function(e){e=e.matrix;var t=this.matrix;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this},identity:function(){var e=this.matrix;return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,this},multiply:function(e){var t=this.matrix[0]*e.matrix[0]+this.matrix[1]*e.matrix[3]+this.matrix[2]*e.matrix[6],n=this.matrix[0]*e.matrix[1]+this.matrix[1]*e.matrix[4]+this.matrix[2]*e.matrix[7],r=this.matrix[0]*e.matrix[2]+this.matrix[1]*e.matrix[5]+this.matrix[2]*e.matrix[8],i=this.matrix[3]*e.matrix[0]+this.matrix[4]*e.matrix[3]+this.matrix[5]*e.matrix[6],s=this.matrix[3]*e.matrix[1]+this.matrix[4]*e.matrix[4]+this.matrix[5]*e.matrix[7],o=this.matrix[3]*e.matrix[2]+this.matrix[4]*e.matrix[5]+this.matrix[5]*e.matrix[8],u=this.matrix[6]*e.matrix[0]+this.matrix[7]*e.matrix[3]+this.matrix[8]*e.matrix[6],a=this.matrix[6]*e.matrix[1]+this.matrix[7]*e.matrix[4]+this.matrix[8]*e.matrix[7],f=this.matrix[6]*e.matrix[2]+this.matrix[7]*e.matrix[5]+this.matrix[8]*e.matrix[8];return this.matrix[0]=t,this.matrix[1]=n,this.matrix[2]=r,this.matrix[3]=i,this.matrix[4]=s,this.matrix[5]=o,this.matrix[6]=u,this.matrix[7]=a,this.matrix[8]=f,this},premultiply:function(e){var t=e.matrix[0]*this.matrix[0]+e.matrix[1]*this.matrix[3]+e.matrix[2]*this.matrix[6],n=e.matrix[0]*this.matrix[1]+e.matrix[1]*this.matrix[4]+e.matrix[2]*this.matrix[7],r=e.matrix[0]*this.matrix[2]+e.matrix[1]*this.matrix[5]+e.matrix[2]*this.matrix[8],i=e.matrix[3]*this.matrix[0]+e.matrix[4]*this.matrix[3]+e.matrix[5]*this.matrix[6],s=e.matrix[3]*this.matrix[1]+e.matrix[4]*this.matrix[4]+e.matrix[5]*this.matrix[7],o=e.matrix[3]*this.matrix[2]+e.matrix[4]*this.matrix[5]+e.matrix[5]*this.matrix[8],u=e.matrix[6]*this.matrix[0]+e.matrix[7]*this.matrix[3]+e.matrix[8]*this.matrix[6],a=e.matrix[6]*this.matrix[1]+e.matrix[7]*this.matrix[4]+e.matrix[8]*this.matrix[7],f=e.matrix[6]*this.matrix[2]+e.matrix[7]*this.matrix[5]+e.matrix[8]*this.matrix[8];return this.matrix[0]=t,this.matrix[1]=n,this.matrix[2]=r,this.matrix[3]=i,this.matrix[4]=s,this.matrix[5]=o,this.matrix[6]=u,this.matrix[7]=a,this.matrix[8]=f,this},getInverse:function(){var e=this.matrix[0],t=this.matrix[1],n=this.matrix[2],r=this.matrix[3],i=this.matrix[4],s=this.matrix[5],o=this.matrix[6],u=this.matrix[7],a=this.matrix[8],f=new CAAT.Matrix,l=e*(i*a-u*s)-r*(t*a-u*n)+o*(t*s-i*n);if(l===0)return null;var c=f.matrix;return c[0]=i*a-s*u,c[1]=n*u-t*a,c[2]=t*s-n*i,c[3]=s*o-r*a,c[4]=e*a-n*o,c[5]=n*r-e*s,c[6]=r*u-i*o,c[7]=t*o-e*u,c[8]=e*i-t*r,f.multiplyScalar(1/l),f},multiplyScalar:function(e){var t,n;for(n=0;n<9;n++)this.matrix[n]*=e;return this},transformRenderingContext:function(e){var t=this.matrix;return e.setTransform(t[0],t[3],t[1],t[4],t[2],t[5]),this}}}(),function(){CAAT.MatrixStack=function(){return this.stack=[],this.saved=[],this},CAAT.MatrixStack.prototype={stack:null,saved:null,pushMatrix:function(e){return this.stack.push(e),this},popMatrix:function(){return this.stack.pop()},save:function(){return this.saved.push(this.stack.length),this},restore:function(){var e=this.saved.pop();while(this.stack.length!==e)this.popMatrix();return this},getMatrix:function(){var e=new CAAT.Matrix;for(var t=0;t<this.stack.length;t++){var n=this.stack[t];e.multiply(n)}return e}}}(),function(){CAAT.Color=function(){return this},CAAT.Color.prototype={hsvToRgb:function(e,t,n){var r,i,s,o,u,a,f,l;e=Math.max(0,Math.min(360,e)),t=Math.max(0,Math.min(100,t)),n=Math.max(0,Math.min(100,n)),t/=100,n/=100;if(t===0)return r=i=s=n,[Math.round(r*255),Math.round(i*255),Math.round(s*255)];e/=60,o=Math.floor(e),u=e-o,a=n*(1-t),f=n*(1-t*u),l=n*(1-t*(1-u));switch(o){case 0:r=n,i=l,s=a;break;case 1:r=f,i=n,s=a;break;case 2:r=a,i=n,s=l;break;case 3:r=a,i=f,s=n;break;case 4:r=l,i=a,s=n;break;default:r=n,i=a,s=f}return new CAAT.Color.RGB(Math.round(r*255),Math.round(i*255),Math.round(s*255))},RampEnumeration:{RAMP_RGBA:0,RAMP_RGB:1,RAMP_CHANNEL_RGB:2,RAMP_CHANNEL_RGBA:3,RAMP_CHANNEL_RGB_ARRAY:4,RAMP_CHANNEL_RGBA_ARRAY:5},interpolate:function(e,t,n,r,i,s,o,u){if(u<=0)return{r:e,g:t,b:n};if(u>=o)return{r:r,g:i,b:s};var a=e+(r-e)/o*u>>0,f=t+(i-t)/o*u>>0,l=n+(s-n)/o*u>>0;return a>255?a=255:a<0&&(a=0),f>255?f=255:f<0&&(f=0),l>255?l=255:l<0&&(l=0),{r:a,g:f,b:l}},makeRGBColorRamp:function(e,t,n){var r=[],i=e.length-1,s=t/i;for(var o=0;o<i;o++){var u=e[o],a=u>>24&255,f=(u&16711680)>>16,l=(u&65280)>>8,c=u&255,h=e[o+1],p=h>>24&255,d=(h&16711680)>>16,v=(h&65280)>>8,m=h&255,g=(p-a)/s,y=(d-f)/s,b=(v-l)/s,w=(m-c)/s;for(var E=0;E<s;E++){var S=a+g*E>>0,x=f+y*E>>0,T=l+b*E>>0,N=c+w*E>>0;switch(n){case this.RampEnumeration.RAMP_RGBA:r.push("argb("+S+","+x+","+T+","+N+")");break;case this.RampEnumeration.RAMP_RGB:r.push("rgb("+x+","+T+","+N+")");break;case this.RampEnumeration.RAMP_CHANNEL_RGB:r.push(4278190080|x<<16|T<<8|N);break;case this.RampEnumeration.RAMP_CHANNEL_RGBA:r.push(S<<24|x<<16|T<<8|N);break;case this.RampEnumeration.RAMP_CHANNEL_RGBA_ARRAY:r.push([x,T,N,S]);break;case this.RampEnumeration.RAMP_CHANNEL_RGB_ARRAY:r.push([x,T,N])}}}return r}}}(),function(){CAAT.Color.RGB=function(e,t,n){return this.r=e||255,this.g=t||255,this.b=n||255,this},CAAT.Color.RGB.prototype={r:255,g:255,b:255,toHex:function(){return("000000"+((this.r<<16)+(this.g<<8)+this.b).toString(16)).slice(-6)}}}(),function(){CAAT.Rectangle=function(){return this},CAAT.Rectangle.prototype={x:0,y:0,x1:0,y1:0,width:-1,height:-1,setEmpty:function(){return this.width=-1,this.height=-1,this},setLocation:function(e,t){return this.x=e,this.y=t,this.x1=this.x+this.width,this.y1=this.y+this.height,this},setDimension:function(e,t){return this.width=e,this.height=t,this.x1=this.x+this.width,this.y1=this.y+this.height,this},contains:function(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height},isEmpty:function(){return this.width===-1&&this.height===-1},union:function(e,t){if(this.isEmpty()){this.x=e,this.x1=e,this.y=t,this.y1=t,this.width=0,this.height=0;return}this.x1=this.x+this.width,this.y1=this.y+this.height,t<this.y&&(this.y=t),e<this.x&&(this.x=e),t>this.y1&&(this.y1=t),e>this.x1&&(this.x1=e),this.width=this.x1-this.x,this.height=this.y1-this.y},unionRectangle:function(e){return this.union(e.x,e.y),this.union(e.x1,e.y),this.union(e.x,e.y1),this.union(e.x1,e.y1),this}}}(),function(){CAAT.Curve=function(){return this},CAAT.Curve.prototype={coordlist:null,k:.05,length:-1,interpolator:!1,HANDLE_SIZE:20,drawHandles:!0,paint:function(e){if(!1===this.drawHandles)return;var t=e.crc;t.save(),t.beginPath(),t.strokeStyle="#a0a0a0",t.moveTo(this.coordlist[0].x,this.coordlist[0].y),t.lineTo(this.coordlist[1].x,this.coordlist[1].y),t.stroke(),this.cubic&&(t.moveTo(this.coordlist[2].x,this.coordlist[2].y),t.lineTo(this.coordlist[3].x,this.coordlist[3].y),t.stroke()),t.globalAlpha=.5;for(var n=0;n<this.coordlist.length;n++)t.fillStyle="#7f7f00",t.beginPath(),t.arc(this.coordlist[n].x,this.coordlist[n].y,this.HANDLE_SIZE/2,0,2*Math.PI,!1),t.fill();t.restore()},update:function(){this.calcLength()},solve:function(e,t){},getContour:function(e){var t=[],n;for(n=0;n<=e;n++){var r=new CAAT.Point;this.solve(r,n/e),t.push(r)}return t},getBoundingBox:function(e){e||(e=new CAAT.Rectangle);var t=new CAAT.Point;for(var n=this.k;n<=1+this.k;n+=this.k)this.solve(t,n),e.union(t.x,t.y);return e},calcLength:function(){var e,t,n,r;e=this.coordlist[0].x,n=this.coordlist[0].y;var i=0,s=new CAAT.Point;for(var o=this.k;o<=1+this.k;o+=this.k)this.solve(s,o),i+=Math.sqrt((s.x-e)*(s.x-e)+(s.y-n)*(s.y-n)),e=s.x,n=s.y;return this.length=i,i},getLength:function(){return this.length},endCurvePosition:function(e){return this.coordlist[this.coordlist.length-1]},startCurvePosition:function(e){return this.coordlist[0]},setPoints:function(e){},setPoint:function(e,t){t>=0&&t<this.coordlist.length&&(this.coordlist[t]=e)},applyAsPath:function(e){}}}(),function(){CAAT.Bezier=function(){return CAAT.Bezier.superclass.constructor.call(this),this},CAAT.Bezier.prototype={cubic:!1,applyAsPath:function(e){return this.cubic?e.bezierCurveTo(this.coordlist[1].x,this.coordlist[1].y,this.coordlist[2].x,this.coordlist[2].y,this.coordlist[3].x,this.coordlist[3].y):e.quadraticCurveTo(this.coordlist[1].x,this.coordlist[1].y,this.coordlist[2].x,this.coordlist[2].y),this},isQuadric:function(){return!this.cubic},isCubic:function(){return this.cubic},setCubic:function(e,t,n,r,i,s,o,u){return this.coordlist=[],this.coordlist.push((new CAAT.Point).set(e,t)),this.coordlist.push((new CAAT.Point).set(n,r)),this.coordlist.push((new CAAT.Point).set(i,s)),this.coordlist.push((new CAAT.Point).set(o,u)),this.cubic=!0,this.update(),this},setQuadric:function(e,t,n,r,i,s){return this.coordlist=[],this.coordlist.push((new CAAT.Point).set(e,t)),this.coordlist.push((new CAAT.Point).set(n,r)),this.coordlist.push((new CAAT.Point).set(i,s)),this.cubic=!1,this.update(),this},setPoints:function(e){if(e.length===3)this.coordlist=e,this.cubic=!1,this.update();else{if(e.length!==4)throw"points must be an array of 3 or 4 CAAT.Point instances.";this.coordlist=e,this.cubic=!0,this.update()}return this},paint:function(e){this.cubic?this.paintCubic(e):this.paintCuadric(e),CAAT.Bezier.superclass.paint.call(this,e)},paintCuadric:function(e){var t,n;t=this.coordlist[0].x,n=this.coordlist[0].y;var r=e.crc;r.save(),r.beginPath(),r.moveTo(t,n);var i=new CAAT.Point;for(var s=this.k;s<=1+this.k;s+=this.k)this.solve(i,s),r.lineTo(i.x,i.y);r.stroke(),r.restore()},paintCubic:function(e){var t,n;t=this.coordlist[0].x,n=this.coordlist[0].y;var r=e.crc;r.save(),r.beginPath(),r.moveTo(t,n);var i=new CAAT.Point;for(var s=this.k;s<=1+this.k;s+=this.k)this.solve(i,s),r.lineTo(i.x,i.y);r.stroke(),r.restore()},solve:function(e,t){return this.cubic?this.solveCubic(e,t):this.solveQuadric(e,t)},solveCubic:function(e,t){var n=t*t,r=t*n;return e.x=this.coordlist[0].x+t*(-this.coordlist[0].x*3+t*(3*this.coordlist[0].x-this.coordlist[0].x*t))+t*(3*this.coordlist[1].x+t*(-6*this.coordlist[1].x+this.coordlist[1].x*3*t))+n*(this.coordlist[2].x*3-this.coordlist[2].x*3*t)+this.coordlist[3].x*r,e.y=this.coordlist[0].y+t*(-this.coordlist[0].y*3+t*(3*this.coordlist[0].y-this.coordlist[0].y*t))+t*(3*this.coordlist[1].y+t*(-6*this.coordlist[1].y+this.coordlist[1].y*3*t))+n*(this.coordlist[2].y*3-this.coordlist[2].y*3*t)+this.coordlist[3].y*r,e},solveQuadric:function(e,t){return e.x=(1-t)*(1-t)*this.coordlist[0].x+2*(1-t)*t*this.coordlist[1].x+t*t*this.coordlist[2].x,e.y=(1-t)*(1-t)*this.coordlist[0].y+2*(1-t)*t*this.coordlist[1].y+t*t*this.coordlist[2].y,e}},extend(CAAT.Bezier,CAAT.Curve,null)}(),function(){CAAT.CatmullRom=function(){return CAAT.CatmullRom.superclass.constructor.call(this),this},CAAT.CatmullRom.prototype={setCurve:function(e,t,n,r,i,s,o,u){this.coordlist=[],this.coordlist.push((new CAAT.Point).set(e,t)),this.coordlist.push((new CAAT.Point).set(n,r)),this.coordlist.push((new CAAT.Point).set(i,s)),this.coordlist.push((new CAAT.Point).set(o,u)),this.cubic=!0,this.update()},paint:function(e){var t,n,r,i;t=this.coordlist[0].x,r=this.coordlist[0].y;var s=e.crc;s.save(),s.beginPath(),s.moveTo(t,r);var o=new CAAT.Point;for(var u=this.k;u<=1+this.k;u+=this.k)this.solve(o,u),s.lineTo(o.x,o.y);s.stroke(),s.restore(),CAAT.CatmullRom.superclass.paint.call(this,e)},solve:function(e,t){var n=t*t,r=t*n,i=this.coordlist;return e.x=.5*(2*i[1].x+(-i[0].x+i[2].x)*t+(2*i[0].x-5*i[1].x+4*i[2].x-i[3].x)*n+(-i[0].x+3*i[1].x-3*i[2].x+i[3].x)*r),e.y=.5*(2*i[1].y+(-i[0].y+i[2].y)*t+(2*i[0].y-5*i[1].y+4*i[2].y-i[3].y)*n+(-i[0].y+3*i[1].y-3*i[2].y+i[3].y)*r),e}},extend(CAAT.CatmullRom,CAAT.Curve,null)}(),function(){CAAT.Point=function(e,t,n){return this.x=e||0,this.y=t||0,this.z=n||0,this},CAAT.Point.prototype={x:0,y:0,z:0,set:function(e,t,n){return this.x=e||0,this.y=t||0,this.z=n||0,this},clone:function(){var e=new CAAT.Point(this.x,this.y,this.z);return e},translate:function(e,t,n){return this.x+=e,this.y+=t,this.z+=n||0,this},translatePoint:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this},rotate:function(e){var t=this.x,n=this.y;return this.x=t*Math.cos(e)-Math.sin(e)*n,this.y=t*Math.sin(e)+Math.cos(e)*n,this},setAngle:function(e){var t=this.getLength();return this.x=Math.cos(e)*t,this.y=Math.sin(e)*t,this},setLength:function(e){var t=this.getLength();return t?this.multiply(e/t):this.x=this.y=e,this},normalize:function(){var e=this.getLength();return this.x/=e,this.y/=e,this.z/=e,this},getAngle:function(){return Math.atan2(this.y,this.x)},limit:function(e){var t=this.getLengthSquared();if(t+.01>e*e){var n=Math.sqrt(t);this.x=this.x/n*e,this.y=this.y/n*e,this.z=this.z/n*e}return this},getLength:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return e<.005&&e>-0.005?1e-6:e},getLengthSquared:function(){var e=this.x*this.x+this.y*this.y+this.z*this.z;return e<.005&&e>-0.005?0:e},getDistance:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return Math.sqrt(t*t+n*n+r*r)},getDistanceSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},toString:function(){return"(CAAT.Point) x:"+String(Math.round(Math.floor(this.x*10))/10)+" y:"+String(Math.round(Math.floor(this.y*10))/10)+" z:"+String(Math.round(Math.floor(this.z*10))/10)}}}(),function(){CAAT.Actor=function(){return this.behaviorList=[],this.lifecycleListenerList=[],this.AABB=new CAAT.Rectangle,this.viewVertices=[new CAAT.Point(0,0,0),new CAAT.Point(0,0,0),new CAAT.Point(0,0,0),new CAAT.Point(0,0,0)],this.scaleAnchor=this.ANCHOR_CENTER,this.rotateAnchor=this.ANCHOR_CENTER,this.modelViewMatrix=new CAAT.Matrix,this.worldModelViewMatrix=new CAAT.Matrix,this.modelViewMatrixI=new CAAT.Matrix,this.worldModelViewMatrixI=new CAAT.Matrix,this.tmpMatrix=new CAAT.Matrix,this.resetTransform(),this.setScale(1,1),this.setRotation(0),this},CAAT.Actor.prototype={tmpMatrix:null,lifecycleListenerList:null,behaviorList:null,parent:null,x:0,y:0,width:0,height:0,start_time:0,duration:Number.MAX_VALUE,clip:!1,clipPath:null,scaleX:0,scaleY:0,scaleTX:0,scaleTY:0,scaleAnchor:0,rotationAngle:0,rotationY:0,alpha:1,rotationX:0,isGlobalAlpha:!1,frameAlpha:1,expired:!1,discardable:!1,pointed:!1,mouseEnabled:!0,visible:!0,ANCHOR_CENTER:0,ANCHOR_TOP:1,ANCHOR_BOTTOM:2,ANCHOR_LEFT:3,ANCHOR_RIGHT:4,ANCHOR_TOP_LEFT:5,ANCHOR_TOP_RIGHT:6,ANCHOR_BOTTOM_LEFT:7,ANCHOR_BOTTOM_RIGHT:8,ANCHOR_CUSTOM:9,fillStyle:null,strokeStyle:null,time:0,AABB:null,viewVertices:null,inFrame:!1,dirty:!0,wdirty:!0,oldX:-1,oldY:-1,modelViewMatrix:null,worldModelViewMatrix:null,modelViewMatrixI:null,worldModelViewMatrixI:null,glEnabled:!1,backgroundImage:null,id:null,getId:function(){return this.id},setId:function(e){return this.id=e,this},setParent:function(e){this.parent=e},setBackgroundImage:function(e,t){return e&&(e instanceof CAAT.SpriteImage||(e=(new CAAT.SpriteImage).initialize(e,1,1)),e.setOwner(this),this.backgroundImage=e,t&&(this.width=e.singleWidth,this.height=e.singleHeight),this.glEnabled=!0),this},setSpriteIndex:function(e){return this.backgroundImage&&this.backgroundImage.setSpriteIndex(e),this},setBackgroundImageOffset:function(e,t){return this.backgroundImage&&this.backgroundImage.setOffset(e,t),this},setAnimationImageIndex:function(e){return this.backgroundImage&&this.backgroundImage.setAnimationImageIndex(e),this},setChangeFPS:function(e){return this.backgroundImage&&this.backgroundImage.setChangeFPS(e),this},setImageTransformation:function(e){return this.backgroundImage&&this.backgroundImage.setSpriteTransformation(e),this},centerOn:function(e,t){return this.setLocation(e-this.width/2,t-this.height/2),this},centerAt:function(e,t){return this.centerOn(e,t)},getTextureGLPage:function(){return this.backgroundImage.image.__texturePage},setVisible:function(e){return this.visible=e,this},setOutOfFrameTime:function(){return this.setFrameTime(-1,0),this},addListener:function(e){return this.lifecycleListenerList.push(e),this},removeListener:function(e){var t=this.lifecycleListenerList.length;while(t--)if(this.lifecycleListenerList[t]===e){this.lifecycleListenerList.splice(t,1);return}},setGlobalAlpha:function(e){return this.isGlobalAlpha=e,this},fireEvent:function(e,t){for(var n=0;n<this.lifecycleListenerList.length;n++)this.lifecycleListenerList[n].actorLifeCycleEvent(this,e,t)},setScreenBounds:function(){this.viewVertices[0].set(0,0),this.viewVertices[1].set(this.width,0),this.viewVertices[2].set(this.width,this.height),this.viewVertices[3].set(0,this.height),this.modelToView(this.viewVertices);var e=Number.MAX_VALUE,t=Number.MIN_VALUE,n=Number.MAX_VALUE,r=Number.MIN_VALUE;for(var i=0;i<4;i++)this.viewVertices[i].x<e&&(e=this.viewVertices[i].x),this.viewVertices[i].x>t&&(t=this.viewVertices[i].x),this.viewVertices[i].y<n&&(n=this.viewVertices[i].y),this.viewVertices[i].y>r&&(r=this.viewVertices[i].y);return this.AABB.x=e,this.AABB.y=n,this.AABB.width=t-e,this.AABB.height=r-n,this},setExpired:function(e){return this.expired=!0,this.fireEvent("expired",e),this},enableEvents:function(e){return this.mouseEnabled=e,this},emptyBehaviorList:function(){return this.behaviorList=[],this},setFillStyle:function(e){return this.fillStyle=e,this},setStrokeStyle:function(e){return this.strokeStyle=e,this},setPaint:function(e){return this.setFillStyle(e)},setAlpha:function(e){return this.alpha=e,this},resetTransform:function(){return this.rotationAngle=0,this.rotateAnchor=0,this.rotationX=0,this.rotationY=0,this.scaleX=1,this.scaleY=1,this.scaleTX=0,this.scaleTY=0,this.scaleAnchor=0,this.oldX=-1,this.oldY=-1,this.dirty=!0,this},setFrameTime:function(e,t){return this.start_time=e,this.duration=t,this.expired=!1,this.dirty=!0,this},paint:function(e,t){if(this.backgroundImage)this.backgroundImage.paint(e,t,0,0);else if(this.fillStyle){var n=e.crc;n.fillStyle=this.fillStyle,n.fillRect(0,0,this.width,this.height)}},setScale:function(e,t){return this.setScaleAnchored(e,t,this.width/2,this.height/2),this.dirty=!0,this},getAnchorPercent:function(e){var t=[50,50,50,0,50,100,0,50,100,50,0,0,100,0,0,100,100,100];return{x:t[e*2],y:t[e*2+1]}},getAnchor:function(e){var t=0,n=0;switch(e){case this.ANCHOR_CENTER:t=this.width/2,n=this.height/2;break;case this.ANCHOR_TOP:t=this.width/2,n=0;break;case this.ANCHOR_BOTTOM:t=this.width/2,n=this.height;break;case this.ANCHOR_LEFT:t=0,n=this.height/2;break;case this.ANCHOR_RIGHT:t=this.width,n=this.height/2;break;case this.ANCHOR_TOP_RIGHT:t=this.width,n=0;break;case this.ANCHOR_BOTTOM_LEFT:t=0,n=this.height;break;case this.ANCHOR_BOTTOM_RIGHT:t=this.width,n=this.height;break;case this.ANCHOR_TOP_LEFT:t=0,n=0}return{x:t,y:n}},setScaleAnchored:function(e,t,n,r){return this.scaleTX=n,this.scaleTY=r,this.scaleX=e,this.scaleY=t,this.dirty=!0,this},setRotation:function(e){return this.setRotationAnchored(e,this.width/2,this.height/2),this},setRotationAnchored:function(e,t,n){return this.rotationAngle=e,this.rotationX=t?t:0,this.rotationY=n?n:0,this.dirty=!0,this},setSize:function(e,t){return this.width=e>>0,this.height=t>>0,this.dirty=!0,this},setBounds:function(e,t,n,r){return this.x=e|0,this.y=t|0,this.width=n|0,this.height=r|0,this.dirty=!0,this},setLocation:function(e,t){return e|=0,t|=0,this.x=e,this.y=t,this.oldX=e,this.oldY=t,this.dirty=!0,this},isInAnimationFrame:function(e){return this.expired?!1:this.duration===Number.MAX_VALUE?this.start_time<=e:e>=this.start_time+this.duration?(this.expired||this.setExpired(e),!1):this.start_time<=e&&e<this.start_time+this.duration},contains:function(e,t){return e>=0&&t>=0&&e<this.width&&t<this.height},create:function(){return this},addBehavior:function(e){return this.behaviorList.push(e),this},removeBehaviour:function(e){var t=this.behaviorList.length-1;while(t)if(this.behaviorList[t]===e)return this.behaviorList.splice(t,1),this;return this},removeBehaviorById:function(e){for(var t=0;t<this.behaviorList.length;t++)this.behaviorList[t].id===e&&this.behaviorList.splice(t,1);return this},setDiscardable:function(e){return this.discardable=e,this},destroy:function(e){this.parent&&this.parent.removeChild(this),this.fireEvent("destroyed",e)},modelToView:function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.worldModelViewMatrix.transformCoord(e[t]);else this.worldModelViewMatrix.transformCoord(e);return e},viewToModel:function(e){return this.worldModelViewMatrixI=this.worldModelViewMatrix.getInverse(),this.worldModelViewMatrixI.transformCoord(e),e},findActorAtPosition:function(e,t){return!this.mouseEnabled||!this.isInAnimationFrame(this.time)?null:(this.modelViewMatrixI=this.modelViewMatrix.getInverse(),this.modelViewMatrixI.transformCoord(e),this.contains(e.x,e.y)?this:null)},enableDrag:function(){return this.ax=0,this.ay=0,this.mx=0,this.my=0,this.asx=1,this.asy=1,this.ara=0,this.screenx=0,this.screeny=0,this.mouseEnter=function(e){this.ax=-1,this.ay=-1,this.pointed=!0,CAAT.setCursor("move")},this.mouseExit=function(e){this.ax=-1,this.ay=-1,this.pointed=!1,CAAT.setCursor("default")},this.mouseMove=function(e){this.mx=e.point.x,this.my=e.point.y},this.mouseUp=function(e){this.ax=-1,this.ay=-1},this.mouseDrag=function(e){if(this.ax===-1||this.ay===-1)this.ax=e.point.x,this.ay=e.point.y,this.asx=this.scaleX,this.asy=this.scaleY,this.ara=this.rotationAngle,this.screenx=e.screenPoint.x,this.screeny=e.screenPoint.y;if(e.isShiftDown()){var t=(e.screenPoint.x-this.screenx)/100,n=(e.screenPoint.y-this.screeny)/100;if(!e.isAltDown()){var r=Math.max(t,n);t=r,n=r}this.setScale(t+this.asx,n+this.asy)}else if(e.isControlDown()){var i=e.screenPoint.x-this.screenx,s=e.screenPoint.y-this.screeny;this.setRotation(-Math.atan2(i,s)+this.ara)}else this.x+=e.point.x-this.ax,this.y+=e.point.y-this.ay,this.ax=e.point.x,this.ay=e.point.y},this},mouseClick:function(e){},mouseDblClick:function(e){},mouseEnter:function(e){this.pointed=!0},mouseExit:function(e){this.pointed=!1},mouseMove:function(e){},mouseDown:function(e){},mouseUp:function(e){},mouseDrag:function(e){},drawScreenBoundingBox:function(e,t){if(null!==this.AABB&&this.inFrame){var n=this.AABB;e.ctx.strokeRect(n.x,n.y,n.width,n.height)}},animate:function(e,t){if(!this.isInAnimationFrame(t))return this.inFrame=!1,this.dirty=!0,!1;if(this.x!==this.oldX||this.y!==this.oldY)this.dirty=!0,this.oldX=this.x,this.oldY=this.y;for(var n=0;n<this.behaviorList.length;n++)this.behaviorList[n].apply(t,this);return this.clipPath&&this.clipPath.applyBehaviors&&this.clipPath.applyBehaviors(t),this.setModelViewMatrix(e),this.inFrame=!0,!0},setModelViewMatrix:function(e){this.wdirty=!1;if(this.dirty){this.modelViewMatrix.identity();var t=this.tmpMatrix.identity(),n=this.modelViewMatrix.matrix;n[2]+=this.x,n[5]+=this.y,this.rotationAngle&&(n[2]+=n[0]*this.rotationX+n[1]*this.rotationY,n[5]+=n[3]*this.rotationX+n[4]*this.rotationY,this.modelViewMatrix.multiply(t.setRotation(this.rotationAngle)),n[2]+=-n[0]*this.rotationX-n[1]*this.rotationY,n[5]+=-n[3]*this.rotationX-n[4]*this.rotationY);if(this.scaleX!=1||this.scaleY!=1&&(this.scaleTX||this.scaleTY))n[2]+=n[0]*this.scaleTX+n[1]*this.scaleTY,n[5]+=n[3]*this.scaleTX+n[4]*this.scaleTY,n[0]=n[0]*this.scaleX,n[1]=n[1]*this.scaleY,n[3]=n[3]*this.scaleX,n[4]=n[4]*this.scaleY,n[2]+=-n[0]*this.scaleTX-n[1]*this.scaleTY,n[5]+=-n[3]*this.scaleTX-n[4]*this.scaleTY}if(this.parent){if(this.dirty||this.parent.wdirty)this.worldModelViewMatrix.copy(this.parent.worldModelViewMatrix),this.worldModelViewMatrix.multiply(this.modelViewMatrix),this.wdirty=!0}else this.dirty&&(this.wdirty=!0),this.worldModelViewMatrix.copy(this.modelViewMatrix);return e.glEnabled&&(this.dirty||this.wdirty)&&this.setScreenBounds(),this.dirty=!1,this},paintActor:function(e,t){if(!this.visible)return!0;var n=e.ctx;return this.frameAlpha=this.parent?this.parent.frameAlpha*this.alpha:1,n.globalAlpha=this.frameAlpha,this.worldModelViewMatrix.transformRenderingContext(n),this.clip&&(n.beginPath(),this.clipPath?this.clipPath.applyAsPath(n):n.rect(0,0,this.width,this.height),n.clip()),this.paint(e,t),!0},__paintActor:function(e,t){if(!this.visible)return!0;var n=e.ctx;this.frameAlpha=this.alpha;var r=this.worldModelViewMatrix.matrix;return n.setTransform(r[0],r[3],r[1],r[4],r[2],r[5],this.frameAlpha),this.paint(e,t),!0},paintActorGL:function(e,t){this.frameAlpha=this.parent.frameAlpha*this.alpha;if(!this.glEnabled||!this.visible)return;if(this.glNeedsFlush(e)){e.glFlush(),this.glSetShader(e),this.__uv||(this.__uv=new Float32Array(8)),this.__vv||(this.__vv=new Float32Array(12)),this.setGLCoords(this.__vv,0),this.setUV(this.__uv,0),e.glRender(this.__vv,12,this.__uv);return}var n=e.coords,r=e.coordsIndex;this.setGLCoords(n,r),e.coordsIndex=r+12,this.setUV(e.uv,e.uvIndex),e.uvIndex+=8},setGLCoords:function(e,t){var n=this.viewVertices;e[t++]=n[0].x,e[t++]=n[0].y,e[t++]=0,e[t++]=n[1].x,e[t++]=n[1].y,e[t++]=0,e[t++]=n[2].x,e[t++]=n[2].y,e[t++]=0,e[t++]=n[3].x,e[t++]=n[3].y,e[t++]=0},setUV:function(e,t){this.backgroundImage.setUV(e,t)},glNeedsFlush:function(e){return this.getTextureGLPage()!==e.currentTexturePage?!0:this.frameAlpha!==e.currentOpacity?!0:!1},glSetShader:function(e){this.frameAlpha!==e.currentOpacity&&e.setGLCurrentOpacity(this.frameAlpha)},endAnimate:function(e,t){return this},initialize:function(e){if(e)for(var t in e)this[t]=e[t];return this},setClip:function(e,t){return this.clip=e,this.clipPath=t,this},cacheAsBitmap:function(e){e=e||0;var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var n=t.getContext("2d"),r={ctx:n,crc:n};return this.paintActor(r,e),this.setBackgroundImage(t),this},setAsButton:function(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){var u=0,a=0,f=0,l=0,c=0,h=null,p=!0,d=this;e.enabled=!0,e.setEnabled=function(e){this.enabled=e},e.setBackgroundImage(t,!0),u=n||0,a=r||u,f=i||u,l=s||u,c=u,h=o,e.setSpriteIndex(u),e.mouseEnter=function(e){this.setSpriteIndex(a),CAAT.setCursor("pointer")},e.mouseExit=function(e){this.setSpriteIndex(u),CAAT.setCursor("default")},e.mouseDown=function(e){this.setSpriteIndex(f)},e.mouseUp=function(e){this.setSpriteIndex(u)},e.mouseClick=function(e){this.enabled&&null!==h&&h(this)},e.setButtonImageIndex=function(e,t,n,r){return u=e,a=t,f=n,l=r,this}}(this,e,t,n,r,i,s),this}},CAAT.NO_PERF&&(CAAT.Actor.prototype.paintActor=CAAT.Actor.prototype.__paintActor)}(),function(){CAAT.ActorContainer=function(){return CAAT.ActorContainer.superclass.constructor.call(this),this.childrenList=[],this.pendingChildrenList=[],this},CAAT.ActorContainer.prototype={childrenList:null,activeChildren:null,pendingChildrenList:null,drawScreenBoundingBox:function(e,t){if(!this.inFrame)return;for(var n=0;n<this.childrenList.length;n++)this.childrenList[n].drawScreenBoundingBox(e,t);CAAT.ActorContainer.superclass.drawScreenBoundingBox.call(this,e,t)},emptyChildren:function(){return this.childrenList=[],this},paintActor:function(e,t){if(!this.visible)return!0;var n=e.ctx;n.save(),CAAT.ActorContainer.superclass.paintActor.call(this,e,t),this.isGlobalAlpha||(this.frameAlpha=this.parent?this.parent.frameAlpha:1);for(var r=this.activeChildren;r;r=r.__next)r.visible&&(n.save(),r.paintActor(e,t),n.restore());return n.restore(),!0},__paintActor:function(e,t){var n=e.ctx;this.frameAlpha=this.parent?this.parent.frameAlpha*this.alpha:1;var r=this.worldModelViewMatrix.matrix;n.setTransform(r[0],r[3],r[1],r[4],r[2],r[5],this.frameAlpha),this.paint(e,t),this.isGlobalAlpha||(this.frameAlpha=this.parent?this.parent.frameAlpha:1);for(var i=this.activeChildren;i;i=i.__next)i.paintActor(e,t);return!0},paintActorGL:function(e,t){var n,r;if(!this.visible)return!0;CAAT.ActorContainer.superclass.paintActorGL.call(this,e,t),this.isGlobalAlpha||(this.frameAlpha=this.parent.frameAlpha);for(r=this.activeChildren;r;r=r.__next)r.paintActorGL(e,t)},animate:function(e,t){this.activeChildren=null;var n=null;if(!1===CAAT.ActorContainer.superclass.animate.call(this,e,t))return!1;var r,i,s=[];for(r=0;r<this.pendingChildrenList.length;r++){var o=this.pendingChildrenList[r];this.addChild(o)}this.pendingChildrenList=[];var u=this.childrenList;this.activeChildren=null;for(r=0;r<u.length;r++){var a=u[r];a.time=t,a.animate(e,t)?this.activeChildren?(a.__next=null,n.__next=a,n=a):(this.activeChildren=a,a.__next=null,n=a):a.expired&&a.discardable&&a.destroy(t)}return!0},endAnimate:function(e,t){},addChildImmediately:function(e){return this.addChild(e)},addChild:function(e){if(e.parent!=null)throw"adding to a container an element with parent.";return e.parent=this,this.childrenList.push(e),this},addChildDelayed:function(e){return this.pendingChildrenList.push(e),this},addChildAt:function(e,t){return t<=0?(this.childrenList.unshift(e),this):(t>=this.childrenList.length&&(t=this.childrenList.length),e.parent=this,this.childrenList.splice(t,0,e),this)},findChild:function(e){var t=0,n=this.childrenList.length;for(t=0;t<n;t++)if(this.childrenList[t]===e)return t;return-1},removeChild:function(e){var t=this.findChild(e);return-1!==t&&(this.childrenList[t].setParent(null),this.childrenList.splice(t,1)),this},findActorAtPosition:function(e,t){if(null===CAAT.ActorContainer.superclass.findActorAtPosition.call(this,e,t))return null;for(var n=this.childrenList.length-1;n>=0;n--){var r=this.childrenList[n],i=new CAAT.Point(e.x,e.y,0),s=r.AABB,o=r.findActorAtPosition(i,t);if(null!==o)return o}return this},destroy:function(){for(var e=this.childrenList.length-1;e>=0;e--)this.childrenList[e].destroy();return CAAT.ActorContainer.superclass.destroy.call(this),this},getNumChildren:function(){return this.childrenList.length},getNumActiveChildren:function(){return this.activeChildren.length},getChildAt:function(e){return this.childrenList[e]},setZOrder:function(e,t){var n=this.findChild(e);if(-1!==n){if(t===n)return;if(t>=this.childrenList.length)this.childrenList.splice(n,1),this.childrenList.push(e);else{var r=this.childrenList.splice(n,1);t<0?t=0:t>this.childrenList.length&&(t=this.childrenList.length),this.childrenList.splice(t,1,r)}}}},CAAT.NO_PERF&&(CAAT.ActorContainer.prototype.paintActor=CAAT.ActorContainer.prototype.__paintActor),extend(CAAT.ActorContainer,CAAT.Actor,null)}(),function(){CAAT.SpriteActor=function(){return CAAT.SpriteActor.superclass.constructor.call(this),this.glEnabled=!0,this.setAnimationImageIndex([0]),this},CAAT.SpriteActor.prototype={compoundbitmap:null,animationImageIndex:null,prevAnimationTime:-1,changeFPS:1e3,transformation:0,spriteIndex:0,TR_NONE:0,TR_FLIP_HORIZONTAL:1,TR_FLIP_VERTICAL:2,TR_FLIP_ALL:3,setSpriteImage:function(e){return this.compoundbitmap=e,this.width=e.singleWidth,this.height=e.singleHeight,this},setChangeFPS:function(e){return this.changeFPS=e,this},setSpriteTransformation:function(e){this.transformation=e;switch(e){case this.TR_FLIP_HORIZONTAL:this.compoundbitmap.paint=this.compoundbitmap.paintInvertedH;break;case this.TR_FLIP_VERTICAL:this.compoundbitmap.paint=this.compoundbitmap.paintInvertedV;break;case this.TR_FLIP_ALL:this.compoundbitmap.paint=this.compoundbitmap.paintInvertedHV;break;default:this.compoundbitmap.paint=this.compoundbitmap.paintN}return this},setAnimationImageIndex:function(e){return this.animationImageIndex=e,this.spriteIndex=e[0],this},setSpriteIndex:function(e){return this.spriteIndex=e,this},paint:function(e,t){if(this.animationImageIndex.length>1)if(this.prevAnimationTime===-1)this.prevAnimationTime=t;else{var n=t;n-=this.prevAnimationTime,n/=this.changeFPS,n%=this.animationImageIndex.length,this.spriteIndex=this.animationImageIndex[Math.floor(n)]}var r=e.ctx;this.spriteIndex!=-1&&this.compoundbitmap.paint(r,this.spriteIndex,0,0)},paintActorGL:function(e,t){if(-1===this.spriteIndex)return;CAAT.SpriteActor.superclass.paintActorGL.call(this,e,t)},setUV:function(e,t){this.compoundbitmap.setUV(this.spriteIndex,e,t)},glNeedsFlush:function(e){return this.compoundbitmap.image.__texturePage!==e.currentTexturePage?!0:this.frameAlpha!==e.currentOpacity?!0:!1}},extend(CAAT.SpriteActor,CAAT.ActorContainer,null)}(),function(){CAAT.ImageActor=function(){return CAAT.ImageActor.superclass.constructor.call(this),this.glEnabled=!0,this},CAAT.ImageActor.prototype={image:null,transformation:0,TR_NONE:0,TR_FLIP_HORIZONTAL:1,TR_FLIP_VERTICAL:2,TR_FLIP_ALL:3,TR_FIXED_TO_SIZE:4,offsetX:0,offsetY:0,setOffsetX:function(e){return this.offsetX=e|0,this},setOffsetY:function(e){return this.offsetY=e|0,this},setOffset:function(e,t){return this.offsetX=e,this.offsetY=t,this},setImage:function(e){return this.image=e,e&&(this.width===0||this.height===0)&&(this.width=e.width,this.height=e.height),this},setImageTransformation:function(e){this.transformation=e;switch(this.transformation){case this.TR_FLIP_HORIZONTAL:this.paint=this.paintInvertedH;break;case this.TR_FLIP_VERTICAL:this.paint=this.paintInvertedV;break;case this.TR_FLIP_ALL:this.paint=this.paintInvertedHV;break;case this.TR_FIXED_TO_SIZE:this.paint=this.paintFixed}return this},paintFixed:function(e,t){if(this.image)e.ctx.drawImage(this.image,this.offsetX,this.offsetY,this.width,this.height);else{var n=e.ctx;n.fillStyle=this.fillStyle,n.fillRect(0,0,this.width,this.height)}},paint:function(e,t){var n=e.ctx;n.drawImage(this.image,this.offsetX,this.offsetY)},paintActorGL:function(e,t){if(null===this.image)return;CAAT.ImageActor.superclass.paintActorGL.call(this,e,t)},paintInvertedH:function(e,t){var n=e.crc;n.save(),n.translate(this.width,0),n.scale(-1,1),n.drawImage(this.image,this.offsetX,this.offsetY),n.restore()},paintInvertedV:function(e,t){var n=e.crc;n.save(),n.translate(0,this.height),n.scale(1,-1),n.drawImage(this.image,this.offsetX,this.offsetY),n.restore()},paintInvertedHV:function(e,t){var n=e.crc;n.save(),n.translate(0,this.height),n.scale(1,-1),n.translate(this.width,0),n.scale(-1,1),n.drawImage(this.image,this.offsetX,this.offsetY),n.restore()},setUV:function(e,t){var n=t,r=this.image;if(!r.__texturePage)return;var i=r.__u,s=r.__v,o=r.__u1,u=r.__v1;if(this.offsetX||this.offsetY){var a=this.width,f=this.height,l=r.__texturePage;i=(r.__tx-this.offsetX)/l.width,s=(r.__ty-this.offsetY)/l.height,o=i+a/l.width,u=s+f/l.height}r.inverted?(e[n++]=o,e[n++]=s,e[n++]=o,e[n++]=u,e[n++]=i,e[n++]=u,e[n++]=i,e[n++]=s):(e[n++]=i,e[n++]=s,e[n++]=o,e[n++]=s,e[n++]=o,e[n++]=u,e[n++]=i,e[n++]=u)},glNeedsFlush:function(e){return this.image.__texturePage!==e.currentTexturePage?!0:this.frameAlpha!==e.currentOpacity?!0:!1}},extend(CAAT.ImageActor,CAAT.ActorContainer,null)}(),function(){CAAT.TextActor=function(){return CAAT.TextActor.superclass.constructor.call(this),this.font="10px sans-serif",this.textAlign="left",this.textBaseline="top",this.outlineColor="black",this.clip=!1,this},CAAT.TextActor.TRAVERSE_PATH_FORWARD=1,CAAT.TextActor.TRAVERSE_PATH_BACKWARD=-1,CAAT.TextActor.prototype={font:null,textAlign:null,textBaseline:null,fill:!0,text:null,textWidth:0,textHeight:0,outline:!1,outlineColor:null,path:null,pathInterpolator:null,pathDuration:1e4,sign:1,setFill:function(e){return this.fill=e,this},setOutline:function(e){return this.outline=e,this},setPathTraverseDirection:function(e){return this.sign=e,this},setOutlineColor:function(e){return this.outlineColor=e,this},setText:function(e){return this.text=e,this.setFont(this.font),this},setTextAlign:function(e){return this.textAlign=e,this},setAlign:function(e){return this.setTextAlign(e)},setTextBaseline:function(e){return this.textBaseline=e,this},setBaseline:function(e){return this.setTextBaseline(e)},setFont:function(e){if(!e)return this;this.font=e;if(null===this.text||this.text==="")this.width=this.height=0;return this},calcTextSize:function(e){if(e.glEnabled)return this;e.ctx.save(),e.ctx.font=this.font,this.textWidth=e.crc.measureText(this.text).width,this.width===0&&(this.width=this.textWidth);try{var t=this.font.indexOf("px"),n=this.font.substring(0,t);this.textHeight=parseInt(n,10),this.textHeight+=this.textHeight/4>>0}catch(r){this.textHeight=20}return this.height===0&&(this.height=this.textHeight),e.crc.restore(),this},paint:function(e,t){if(this.backgroundImage){CAAT.TextActor.superclass.paint.call(this,e,t);return}if(null===this.text)return;(this.textWidth===0||this.textHeight===0)&&this.calcTextSize(e);var n=e.crc;null!==this.font&&(n.font=this.font),null!==this.textAlign&&(n.textAlign=this.textAlign),null!==this.textBaseline&&(n.textBaseline=this.textBaseline),null!==this.fillStyle&&(n.fillStyle=this.fillStyle);if(null===this.path){var r=0;this.textAlign==="center"?r=this.width/2|0:this.textAlign==="right"&&(r=this.width),this.fill?(n.fillText(this.text,r,0),this.outline&&(null!==this.outlineColor&&(n.strokeStyle=this.outlineColor),n.beginPath(),n.strokeText(this.text,r,0))):(null!==this.outlineColor&&(n.strokeStyle=this.outlineColor),n.strokeText(this.text,r,0))}else this.drawOnPath(e,t)},drawOnPath:function(e,t){var n=e.crc,r=this.sign*this.pathInterpolator.getPosition(t%this.pathDuration/this.pathDuration).y*this.path.getLength(),i=new CAAT.Point(0,0,0),s=new CAAT.Point(0,0,0);for(var o=0;o<this.text.length;o++){var u=this.text[o].toString(),a=n.measureText(u).width,f=this.path.getLength(),l=a/2+r;i=this.path.getPositionFromLength(l).clone(),s=this.path.getPositionFromLength(l-.1).clone();var c=Math.atan2(i.y-s.y,i.x-s.x);n.save(),n.translate(.5+i.x|0,.5+i.y|0),n.rotate(c),this.fill&&n.fillText(u,0,0),this.outline&&(n.strokeStyle=this.outlineColor,n.strokeText(u,0,0)),n.restore(),r+=a}},setPath:function(e,t,n){return this.path=e,this.pathInterpolator=t||(new CAAT.Interpolator).createLinearInterpolator(),this.pathDuration=n||1e4,this.mouseEnabled=!1,this}},extend(CAAT.TextActor,CAAT.ActorContainer,null)}(),function(){CAAT.Button=function(){return CAAT.Button.superclass.constructor.call(this),this.glEnabled=!0,this},CAAT.Button.prototype={iNormal:0,iOver:0,iPress:0,iDisabled:0,iCurrent:0,fnOnClick:null,enabled:!0,setEnabled:function(e){this.enabled=e},initialize:function(e,t,n,r,i,s){return this.setSpriteImage(e),this.iNormal=t||0,this.iOver=n||this.iNormal,this.iPress=r||this.iNormal,this.iDisabled=i||this.iNormal,this.iCurrent=this.iNormal,this.width=e.singleWidth,this.height=e.singleHeight,this.fnOnClick=s,this.spriteIndex=t,this},mouseEnter:function(e){this.setSpriteIndex(this.iOver),CAAT.setCursor("pointer")},mouseExit:function(e){this.setSpriteIndex(this.iNormal),CAAT.setCursor("default")},mouseDown:function(e){this.setSpriteIndex(this.iPress)},mouseUp:function(e){this.setSpriteIndex(this.iNormal)},mouseClick:function(e){this.enabled&&null!==this.fnOnClick&&this.fnOnClick(this)},toString:function(){return"CAAT.Button "+this.iNormal}},extend(CAAT.Button,CAAT.SpriteActor,null)}(),function(){CAAT.ShapeActor=function(){return CAAT.ShapeActor.superclass.constructor.call(this),this.compositeOp="source-over",this.setShape(this.SHAPE_CIRCLE),this},CAAT.ShapeActor.prototype={shape:0,compositeOp:null,SHAPE_CIRCLE:0,SHAPE_RECTANGLE:1,setShape:function(e){return this.shape=e,this.paint=this.shape===this.SHAPE_CIRCLE?this.paintCircle:this.paintRectangle,this},setCompositeOp:function(e){return this.compositeOp=e,this},paint:function(e,t){},paintCircle:function(e,t){var n=e.crc;n.globalCompositeOperation=this.compositeOp,null!==this.fillStyle&&(n.fillStyle=this.fillStyle,n.beginPath(),n.arc(this.width/2,this.height/2,Math.min(this.width,this.height)/2,0,2*Math.PI,!1),n.fill()),null!==this.strokeStyle&&(n.strokeStyle=this.strokeStyle,n.beginPath(),n.arc(this.width/2,this.height/2,Math.min(this.width,this.height)/2,0,2*Math.PI,!1),n.stroke())},paintRectangle:function(e,t){var n=e.crc;n.globalCompositeOperation=this.compositeOp,null!==this.fillStyle&&(n.fillStyle=this.fillStyle,n.beginPath(),n.fillRect(0,0,this.width,this.height),n.fill()),null!==this.strokeStyle&&(n.strokeStyle=this.strokeStyle,n.beginPath(),n.strokeRect(0,0,this.width,this.height),n.stroke())}},extend(CAAT.ShapeActor,CAAT.ActorContainer,null)}(),function(){CAAT.StarActor=function(){return CAAT.StarActor.superclass.constructor.call(this),this.compositeOp="source-over",this},CAAT.StarActor.prototype={nPeaks:0,maxRadius:0,minRadius:0,initialAngle:0,compositeOp:null,setFilled:function(e){return this},setOutlined:function(e){return this},setCompositeOp:function(e){return this.compositeOp=e,this},setInitialAngle:function(e){return this.initialAngle=e,this},initialize:function(e,t,n){return this.setSize(2*t,2*t),this.nPeaks=e,this.maxRadius=t,this.minRadius=n,this},paint:function(e,t){var n=e.ctx,r=this.width/2,i=this.height/2,s=this.maxRadius,o=this.minRadius,u=r+s*Math.cos(this.initialAngle),a=i+s*Math.sin(this.initialAngle);n.globalCompositeOperation=this.compositeOp,n.beginPath(),n.moveTo(u,a);for(var f=1;f<this.nPeaks*2;f++){var l=Math.PI/this.nPeaks*f+this.initialAngle,c=f%2===0?s:o,h=r+c*Math.cos(l),p=i+c*Math.sin(l);n.lineTo(h,p)}n.lineTo(r+s*Math.cos(this.initialAngle),i+s*Math.sin(this.initialAngle)),n.closePath(),this.fillStyle&&(n.fillStyle=this.fillStyle,n.fill()),this.strokeStyle&&(n.strokeStyle=this.strokeStyle,n.stroke())}},extend(CAAT.StarActor,CAAT.ActorContainer,null)}(),function(){CAAT.IMActor=function(){return CAAT.IMActor.superclass.constructor.call(this),this},CAAT.IMActor.prototype={imageProcessor:null,changeTime:100,lastApplicationTime:-1,setImageProcessor:function(e){return this.imageProcessor=e,this},setImageProcessingTime:function(e){return this.changeTime=e,this},paint:function(e,t){t-this.lastApplicationTime>this.changeTime&&(this.imageProcessor.apply(e,t),this.lastApplicationTime=t);var n=e.ctx;this.imageProcessor.paint(e,t)}},extend(CAAT.IMActor,CAAT.ActorContainer,null)}(),function(){CAAT.AudioManager=function(){return this.browserInfo=new CAAT.BrowserDetect,this},CAAT.AudioManager.prototype={browserInfo:null,musicEnabled:!0,fxEnabled:!0,audioCache:null,channels:null,workingChannels:null,loopingChannels:[],audioTypes:{mp3:"audio/mpeg;",ogg:'audio/ogg; codecs="vorbis"',wav:'audio/wav; codecs="1"',mp4:'audio/mp4; codecs="mp4a.40.2"'},initialize:function(e){this.audioCache=[],this.channels=[],this.workingChannels=[];for(var t=0;t<e;t++){var n=document.createElement("audio");if(null!==n){n.finished=-1,this.channels.push(n);var r=this;n.addEventListener("ended",function(e){var t=e.target,n;for(n=0;n<r.workingChannels.length;n++)if(r.workingChannels[n]===t){r.workingChannels.splice(n,1);break}t.caat_callback&&t.caat_callback(t.caat_id),r.channels.push(t)},!1)}}return this},addAudioFromURL:function(e,t,n){var r=null,i=document.createElement("audio");if(null!==i){if(!i.canPlayType)return!1;r=t.substr(t.lastIndexOf(".")+1);var s=i.canPlayType(this.audioTypes[r]);if(s!==""&&s!=="no")return i.src=t,i.preload="auto",i.load(),n&&(i.caat_callback=n,i.caat_id=e),this.audioCache.push({id:e,audio:i}),!0}return!1},addAudioFromDomNode:function(e,t,n){var r=t.src.substr(t.src.lastIndexOf(".")+1);return t.canPlayType(this.audioTypes[r])?(n&&(t.caat_callback=n,t.caat_id=e),this.audioCache.push({id:e,audio:t}),!0):!1},addAudioElement:function(e,t,n){if(typeof t=="string")return this.addAudioFromURL(e,t,n);try{if(t instanceof HTMLAudioElement)return this.addAudioFromDomNode(e,t,n)}catch(r){}return!1},addAudio:function(e,t,n){if(t instanceof Array){for(var r=0;r<t.length;r++)if(this.addAudioElement(e,t[r],n))break}else this.addAudioElement(e,t,n);return this},getAudio:function(e){for(var t=0;t<this.audioCache.length;t++)if(this.audioCache[t].id===e)return this.audioCache[t].audio;return null},play:function(e){if(!this.fxEnabled)return this;var t=this.getAudio(e);if(null!==t&&this.channels.length>0){var n=this.channels.shift();n.src=t.src,n.load(),n.play(),this.workingChannels.push(n)}return this},loop:function(e){if(!this.musicEnabled)return this;var t=this.getAudio(e);if(null!==t){var n=document.createElement("audio");if(null!==n)return n.src=t.src,n.preload="auto",this.browserInfo.browser==="Firefox"?n.addEventListener("ended",function(e){var t=e.target;t.currentTime=0},!1):n.loop=!0,n.load(),n.play(),this.loopingChannels.push(n),n}return null},endSound:function(){var e;for(e=0;e<this.workingChannels.length;e++)this.workingChannels[e].pause(),this.channels.push(this.workingChannels[e]);for(e=0;e<this.loopingChannels.length;e++)this.loopingChannels[e].pause();return this},setSoundEffectsEnabled:function(e){return this.fxEnabled=e,this},isSoundEffectsEnabled:function(){return this.fxEnabled},setMusicEnabled:function(e){this.musicEnabled=e;for(var t=0;t<this.loopingChannels.length;t++)e?this.loopingChannels[t].play():this.loopingChannels[t].pause();return this},isMusicEnabled:function(){return this.musicEnabled}}}(),function(){CAAT.Dock=function(){return CAAT.Dock.superclass.constructor.call(this),this},CAAT.Dock.prototype={scene:null,ttask:null,minSize:0,maxSize:0,range:2,layoutOp:0,OP_LAYOUT_BOTTOM:0,OP_LAYOUT_TOP:1,OP_LAYOUT_LEFT:2,OP_LAYOUT_RIGHT:3,initialize:function(e){return this.scene=e,this},setApplicationRange:function(e){return this.range=e,this},setLayoutOp:function(e){return this.layoutOp=e,this},setSizes:function(e,t){this.minSize=e,this.maxSize=t;for(var n=0;n<this.childrenList.length;n++)this.childrenList[n].width=e,this.childrenList[n].height=e;return this},layout:function(){var e,t;if(this.layoutOp===this.OP_LAYOUT_BOTTOM||this.layoutOp===this.OP_LAYOUT_TOP){var n=0,r=0;for(e=0;e<this.getNumChildren();e++)n+=this.getChildAt(e).width;r=(this.width-n)/2;for(e=0;e<this.getNumChildren();e++)t=this.getChildAt(e),t.x=r,r+=t.width,this.layoutOp===this.OP_LAYOUT_BOTTOM?t.y=this.maxSize-t.height:t.y=0}else{var i=0,s=0;for(e=0;e<this.getNumChildren();e++)i+=this.getChildAt(e).height;s=(this.height-i)/2;for(e=0;e<this.getNumChildren();e++)t=this.getChildAt(e),t.y=s,s+=t.height,this.layoutOp===this.OP_LAYOUT_LEFT?t.x=0:t.x=this.width-t.width}},mouseMove:function(e){this.actorNotPointed()},mouseExit:function(e){this.actorNotPointed()},actorNotPointed:function(){var e,t=this;for(e=0;e<this.getNumChildren();e++){var n=this.getChildAt(e);n.emptyBehaviorList(),n.addBehavior((new CAAT.GenericBehavior).setValues(n.width,this.minSize,n,"width").setFrameTime(this.scene.time,250)).addBehavior((new CAAT.GenericBehavior).setValues(n.height,this.minSize,n,"height").setFrameTime(this.scene.time,250)),e===this.getNumChildren()-1&&n.behaviorList[0].addListener({behaviorApplied:function(e,t,n,r,i){r.parent.layout()},behaviorExpired:function(r,i,s){for(e=0;e<t.getNumChildren();e++)n=t.getChildAt(e),n.width=t.minSize,n.height=t.minSize;s.parent.layout()}})}},actorPointed:function(e,t,n){var r=this.findChild(n),i=0;this.layoutOp===this.OP_LAYOUT_BOTTOM||this.layoutOp===this.OP_LAYOUT_TOP?i=e/n.width:i=t/n.height;var s;for(s=0;s<this.childrenList.length;s++){var o=this.childrenList[s];o.emptyBehaviorList();var u=0;s<r-this.range||s>r+this.range?u=this.minSize:s===r?u=this.maxSize:s<r?u=this.minSize+(this.maxSize-this.minSize)*(Math.cos((s-r-i+1)/this.range*Math.PI)+1)/2:u=this.minSize+(this.maxSize-this.minSize)*(Math.cos((s-r-i)/this.range*Math.PI)+1)/2,o.height=u,o.width=u}this.layout()},actorMouseExit:function(e){null!==this.ttask&&this.ttask.cancel(),this.ttask=this.scene.createTimer(this.scene.time,100,function(n,r,i){e.source.parent.actorNotPointed()},null,null)},actorMouseEnter:function(e){null!==this.ttask&&(this.ttask.cancel(),this.ttask=null)},addChild:function(e){var t=this;return e.__Dock_mouseEnter=e.mouseEnter,e.__Dock_mouseExit=e.mouseExit,e.__Dock_mouseMove=e.mouseMove,e.mouseEnter=function(e){t.actorMouseEnter(e),e.source.__Dock_mouseEnter(e)},e.mouseExit=function(e){t.actorMouseExit(e),e.source.__Dock_mouseExit(e)},e.mouseMove=function(e){t.actorPointed(e.point.x,e.point.y,e.source),e.source.__Dock_mouseMove(e)},e.width=this.minSize,e.height=this.minSize,CAAT.Dock.superclass.addChild.call(this,e)}},extend(CAAT.Dock,CAAT.ActorContainer,null)}(),function(){CAAT.Director=function(){return CAAT.Director.superclass.constructor.call(this),this.browserInfo=new CAAT.BrowserDetect,this.audioManager=(new CAAT.AudioManager).initialize(8),this.scenes=[],this.mousePoint=new CAAT.Point(0,0,0),this.prevMousePoint=new CAAT.Point(0,0,0),this.screenMousePoint=new CAAT.Point(0,0,0),this.isMouseDown=!1,this.lastSelectedActor=null,this.dragging=!1,this},CAAT.Director.prototype={debug:!1,onRenderStart:null,onRenderEnd:null,mousePoint:null,prevMousePoint:null,screenMousePoint:null,isMouseDown:!1,lastSelectedActor:null,dragging:!1,scenes:null,currentScene:null,canvas:null,crc:null,ctx:null,time:0,timeline:0,imagesCache:null,audioManager:null,clear:!0,transitionScene:null,browserInfo:null,gl:null,glEnabled:!1,glTextureManager:null,glTtextureProgram:null,glColorProgram:null,pMatrix:null,coords:null,coordsIndex:0,uv:null,uvIndex:0,front_to_back:!1,currentTexturePage:0,currentOpacity:1,intervalId:null,frameCounter:0,RESIZE_NONE:1,RESIZE_WIDTH:2,RESIZE_HEIGHT:4,RESIZE_BOTH:8,RESIZE_PROPORTIONAL:16,resize:1,getRenderType:function(){return this.glEnabled?"WEBGL":"CANVAS"},windowResized:function(e,t){switch(this.resize){case this.RESIZE_WIDTH:this.setBounds(0,0,e,this.height);break;case this.RESIZE_HEIGHT:this.setBounds(0,0,this.width,t);break;case this.RESIZE_BOTH:this.setBounds(0,0,e,t);break;case this.RESIZE_PROPORTIONAL:this.setScaleProportional(e,t)}},setScaleProportional:function(e,t){var n=Math.min(e/this.referenceWidth,t/this.referenceHeight);this.setScaleAnchored(n,n,0,0),this.canvas.width=this.referenceWidth*n,this.canvas.height=this.referenceHeight*n,this.ctx=this.canvas.getContext(this.glEnabled?"experimental-webgl":"2d"),this.crc=this.ctx,this.glEnabled&&this.glReset()},enableResizeEvents:function(e){e===this.RESIZE_BOTH||e===this.RESIZE_WIDTH||e===this.RESIZE_HEIGHT||e===this.RESIZE_PROPORTIONAL?(this.referenceWidth=this.width,this.referenceHeight=this.height,this.resize=e,CAAT.registerResizeListener(this)):CAAT.unregisterResizeListener(this)},setBounds:function(e,t,n,r){CAAT.Director.superclass.setBounds.call(this,e,t,n,r),this.canvas.width=n,this.canvas.height=r,this.ctx=this.canvas.getContext(this.glEnabled?"experimental-webgl":"2d"),this.crc=this.ctx;for(var i=0;i<this.scenes.length;i++)this.scenes[i].setBounds(0,0,n,r);return this.glEnabled&&this.glReset(),this},initialize:function(e,t,n){n=n||document.createElement("canvas"),this.canvas=n,this.setBounds(0,0,e,t),this.create(),this.enableEvents(),this.timeline=(new Date).getTime(),this.transitionScene=(new CAAT.Scene).create().setBounds(0,0,e,t);var r=document.createElement("canvas");r.width=e,r.height=t;var i=(new CAAT.Actor).create().setBackgroundImage(r);return this.transitionScene.ctx=r.getContext("2d"),this.transitionScene.addChildImmediately(i),this.transitionScene.setEaseListener(this),this},glReset:function(){this.pMatrix=makeOrtho(0,this.canvas.width,this.canvas.height,0,-1,1),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.glColorProgram.setMatrixUniform(this.pMatrix),this.glTextureProgram.setMatrixUniform(this.pMatrix),this.gl.viewportWidth=this.canvas.width,this.gl.viewportHeight=this.canvas.height},initializeGL:function(e,t,n){n=n||document.createElement("canvas"),n.width=e,n.height=t;var r;try{this.gl=n.getContext("experimental-webgl"),this.gl.viewportWidth=e,this.gl.viewportHeight=t}catch(i){}if(!this.gl)return this.initialize(e,t,n);this.canvas=n,this.create(),this.setBounds(0,0,e,t),this.crc=this.ctx,this.enableEvents(),this.timeline=(new Date).getTime(),this.glColorProgram=(new CAAT.ColorProgram(this.gl)).create().initialize(),this.glTextureProgram=(new CAAT.TextureProgram(this.gl)).create().initialize(),this.glTextureProgram.useProgram(),this.glReset();var s=2048;return this.coords=new Float32Array(s*12),this.uv=new Float32Array(s*8),this.gl.clearColor(0,0,0,255),this.front_to_back?(this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LESS)):this.gl.disable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.glEnabled=!0,this},createScene:function(){var e=(new CAAT.Scene).create();return this.addScene(e),e},setImagesCache:function(e,t,n){var r;null!==this.glTextureManager&&(this.glTextureManager.deletePages(),this.glTextureManager=null);if(this.imagesCache){var i=[];for(r=0;r<this.imagesCache.length;r++)i.push(this.imagesCache[r].id);for(r=0;r<i.length;r++)delete this.imagesCache[i[r]]}this.imagesCache=e;if(e)for(r=0;r<e.length;r++)this.imagesCache[e[r].id]=e[r].image;this.tpW=t||2048,this.tpH=n||2048,this.updateGLPages()},updateGLPages:function(){this.glEnabled&&(this.glTextureManager=new CAAT.GLTexturePageManager,this.glTextureManager.createPages(this.gl,this.tpW,this.tpH,this.imagesCache),this.currentTexturePage=this.glTextureManager.pages[0],this.glTextureProgram.setTexture(this.currentTexturePage.texture))},addImage:function(e,t,n){if(this.getImage(e)){for(var r=0;r<this.imagesCache.length;r++)if(this.imagesCache[r].id===e){this.imagesCache[r].image=t;break}this.imagesCache[e]=t}else this.imagesCache.push({id:e,image:t}),this.imagesCache[e]=t;n||this.updateGLPages()},deleteImage:function(e,t){for(var n=0;n<this.imagesCache.length;n++)if(this.imagesCache[n].id===e){delete this.imagesCache[e],this.imagesCache.splice(n,1);break}t||this.updateGLPages()},setGLCurrentOpacity:function(e){this.currentOpacity=e,this.glTextureProgram.setAlpha(e)},glRender:function(e,t,n){e=e||this.coords,n=n||this.uv,t=t||this.coordsIndex;var r=this.gl,i=t/12*2,s=t/3;this.glTextureProgram.updateVertexBuffer(e),this.glTextureProgram.updateUVBuffer(n),r.drawElements(r.TRIANGLES,3*i,r.UNSIGNED_SHORT,0)},glFlush:function(){this.coordsIndex!==0&&this.glRender(this.coords,this.coordsIndex,this.uv),this.coordsIndex=0,this.uvIndex=0},render:function(e){this.time+=e,this.animate(this,e);var t=this.childrenList.length,n,r;if(this.glEnabled){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.coordsIndex=0,this.uvIndex=0;for(n=0;n<t;n++){var i=this.childrenList[n];i.isInAnimationFrame(this.time)&&(r=i.time-i.start_time,i.onRenderStart&&i.onRenderStart(r),i.paintActorGL(this,r),i.onRenderEnd&&i.onRenderEnd(r),i.time+=e)}this.glFlush()}else{this.ctx.globalAlpha=1,this.ctx.globalCompositeOperation="source-over",this.clear&&this.ctx.clearRect(0,0,this.width,this.height);for(n=0;n<t;n++){var i=this.childrenList[n];i.isInAnimationFrame(this.time)&&(r=i.time-i.start_time,this.ctx.save(),i.onRenderStart&&i.onRenderStart(r),i.paintActor(this,r),i.onRenderEnd&&i.onRenderEnd(r),this.ctx.restore(),this.debug&&(this.ctx.strokeStyle="red",i.drawScreenBoundingBox(this,r)),i.time+=e)}}this.frameCounter++},animate:function(e,t){this.setModelViewMatrix(this);for(var n=0;n<this.childrenList.length;n++){var r=this.childrenList[n].time-this.childrenList[n].start_time;this.childrenList[n].animate(this,r)}return this},renderToContext:function(e,t){if(t.isInAnimationFrame(this.time)){e.globalAlpha=1,e.globalCompositeOperation="source-over",e.clearRect(0,0,this.width,this.height),e.setTransform(1,0,0,0,1,0);var n=this.ctx,r=this.crc;this.ctx=this.crc=e,e.save();var i=this.worldModelViewMatrix;this.worldModelViewMatrix=new CAAT.Matrix,this.wdirty=!0,t.animate(this,t.time),t.onRenderStart&&t.onRenderStart(t.time),t.paintActor(this,t.time),t.onRenderEnd&&t.onRenderEnd(t.time),this.worldModelViewMatrix=i,e.restore(),this.ctx=n,this.crc=r}},addScene:function(e){e.setBounds(0,0,this.width,this.height),this.scenes.push(e),e.setEaseListener(this),null===this.currentScene&&this.setScene(0)},getNumScenes:function(){return this.scenes.length},easeInOut:function(e,t,n,r,i,s,o,u,a,f){if(e===this.getCurrentSceneIndex())return;var l=this.scenes[e],c=this.scenes[r];!this.glEnabled&&!navigator.browser==="iOS"&&(this.worldModelViewMatrix.transformRenderingContext(this.transitionScene.ctx),this.renderToContext(this.transitionScene.ctx,c),c=this.transitionScene),l.setExpired(!1),c.setExpired(!1),l.mouseEnabled=!1,c.mouseEnabled=!1,l.resetTransform(),c.resetTransform(),l.setLocation(0,0),c.setLocation(0,0),l.alpha=1,c.alpha=1,t===CAAT.Scene.prototype.EASE_ROTATION?l.easeRotationIn(o,u,n,a):t===CAAT.Scene.prototype.EASE_SCALE?l.easeScaleIn(0,o,u,n,a):l.easeTranslationIn(o,u,n,a),i===CAAT.Scene.prototype.EASE_ROTATION?c.easeRotationOut(o,u,s,f):i===CAAT.Scene.prototype.EASE_SCALE?c.easeScaleOut(0,o,u,s,f):c.easeTranslationOut(o,u,s,f),this.childrenList=[],this.addChild(c),this.addChild(l)},easeInOutRandom:function(e,t,n,r){var i=Math.random(),s=Math.random(),o,u;i<.33?(o=CAAT.Scene.prototype.EASE_ROTATION,u=(new CAAT.Interpolator).createExponentialInOutInterpolator(4)):i<.66?(o=CAAT.Scene.prototype.EASE_SCALE,u=(new CAAT.Interpolator).createElasticOutInterpolator(1.1,.4)):(o=CAAT.Scene.prototype.EASE_TRANSLATE,u=(new CAAT.Interpolator).createBounceOutInterpolator());var a,f;s<.33?(a=CAAT.Scene.prototype.EASE_ROTATION,f=(new CAAT.Interpolator).createExponentialInOutInterpolator(4)):s<.66?(a=CAAT.Scene.prototype.EASE_SCALE,f=(new CAAT.Interpolator).createExponentialOutInterpolator(4)):(a=CAAT.Scene.prototype.EASE_TRANSLATE,f=(new CAAT.Interpolator).createBounceOutInterpolator()),this.easeInOut(e,o,Math.random()*8.99>>0,t,a,Math.random()*8.99>>0,n,r,u,f)},easeIn:function(e,t,n,r,i,s){var o=this.scenes[e];t===CAAT.Scene.prototype.EASE_ROTATION?o.easeRotationIn(n,r,i,s):t===CAAT.Scene.prototype.EASE_SCALE?o.easeScaleIn(0,n,r,i,s):o.easeTranslationIn(n,r,i,s),this.childrenList=[],this.addChild(o),o.resetTransform(),o.setLocation(0,0),o.alpha=1,o.mouseEnabled=!1,o.setExpired(!1)},setScene:function(e){var t=this.scenes[e];this.childrenList=[],this.addChild(t),this.currentScene=t,t.setExpired(!1),t.mouseEnabled=!0,t.resetTransform(),t.setLocation(0,0),t.alpha=1,t.activated()},switchToScene:function(e,t,n,r){var i=this.getSceneIndex(this.currentScene);r?this.easeInOutRandom(e,i,t,n):this.setScene(e)},switchToPrevScene:function(e,t,n){var r=this.getSceneIndex(this.currentScene);if(this.getNumScenes()<=1||r===0)return;n?this.easeInOutRandom(r-1,r,e,t):this.setScene(r-1)},switchToNextScene:function(e,t,n){var r=this.getSceneIndex(this.currentScene);if(this.getNumScenes()<=1||r===this.getNumScenes()-1)return;n?this.easeInOutRandom(r+1,r,e,t):this.setScene(r+1)},mouseEnter:function(e){},mouseExit:function(e){},mouseMove:function(e){},mouseDown:function(e){},mouseUp:function(e){},mouseDrag:function(e){},easeEnd:function(e,t){t?(this.currentScene=e,this.currentScene.activated()):e.setExpired(!0),e.mouseEnabled=!0,e.emptyBehaviorList()},getSceneIndex:function(e){for(var t=0;t<this.scenes.length;t++)if(this.scenes[t]===e)return t;return-1},getScene:function(e){return this.scenes[e]},getCurrentSceneIndex:function(){return this.getSceneIndex(this.currentScene)},getBrowserName:function(){return this.browserInfo.browser},getBrowserVersion:function(){return this.browserInfo.version},getOSName:function(){return this.browserInfo.OS},getImage:function(e){var t=this.imagesCache[e];if(t)return t;for(var n=0;n<this.imagesCache.length;n++)if(this.imagesCache[n].id===e)return this.imagesCache[n].image;return null},addAudio:function(e,t){return this.audioManager.addAudio(e,t),this},audioPlay:function(e){this.audioManager.play(e)},audioLoop:function(e){return this.audioManager.loop(e)},endSound:function(){return this.audioManager.endSound()},setSoundEffectsEnabled:function(e){return this.audioManager.setSoundEffectsEnabled(e)},setMusicEnabled:function(e){return this.audioManager.setMusicEnabled(e)},isMusicEnabled:function(){return this.audioManager.isMusicEnabled()},isSoundEffectsEnabled:function(){return this.audioManager.isSoundEffectsEnabled()},emptyScenes:function(){this.scenes=[]},addChild:function(e){e.parent=this,this.childrenList.push(e)},loop:function(e,t,n){n?(this.onRenderStart=t,this.onRenderEnd=n):t&&(this.onRenderEnd=t),CAAT.loop()},renderFrame:function(e,t){var n=(new Date).getTime(),r=n-this.timeline;this.onRenderStart&&this.onRenderStart(r),this.render(r),this.timeline=n,this.onRenderEnd&&this.onRenderEnd(r)},endLoop:function(){},setClear:function(e){return this.clear=e,this},getAudioManager:function(){return this.audioManager},cumulateOffset:function(e,t,n){var r=n+"Left",i=n+"Top",s=0,o=0,u;while(e&&e.style){e.currentStyle?u=e.currentStyle.position:(u=(e.ownerDocument.defaultView||e.ownerDocument.parentWindow).getComputedStyle(e,null),u=u?u.getPropertyValue("position"):null);if(!!/^(fixed)$/.test(u))break;s+=e[r],o+=e[i],e=e[t]}return{x:s,y:o,style:u}},getOffset:function(e){var t=this.cumulateOffset(e,"offsetParent","offset");if(t.style==="fixed"){var n=this.cumulateOffset(e,e.parentNode?"parentNode":"parentElement","scroll");return{x:t.x+n.x,y:t.y+n.y}}return{x:t.x,y:t.y}},getCanvasCoord:function(e,t){var n=0,r=0;t||(t=window.event);if(t.pageX||t.pageY)n=t.pageX,r=t.pageY;else if(t.clientX||t.clientY)n=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=t.clientY+document.body.scrollTop+document.documentElement.scrollTop;var i=this.getOffset(t.target);n-=i.x,r-=i.y,e.set(n,r),this.screenMousePoint.set(n,r)},enableEvents:function(){function n(e){var n=e.changedTouches,r=n[0],i="";switch(e.type){case"touchstart":i="mousedown";break;case"touchmove":i="mousemove";break;case"touchend":i="mouseup";break;default:return}var s=document.createEvent("MouseEvent");s.initMouseEvent(i,!0,!0,t.canvas,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),t.canvas.dispatchEvent(s),e.preventDefault()}CAAT.RegisterDirector(this);var e=this.canvas,t=this;e.addEventListener("mouseup",function(e){e.preventDefault(),t.isMouseDown=!1,t.getCanvasCoord(t.mousePoint,e);var n;null!==t.lastSelectedActor&&(n=t.lastSelectedActor.viewToModel(new CAAT.Point(t.mousePoint.x,t.mousePoint.y,0)),t.lastSelectedActor.mouseUp((new CAAT.MouseEvent).init(n.x,n.y,e,t.lastSelectedActor,t.screenMousePoint))),t.dragging?t.dragging=!1:null!==t.lastSelectedActor&&t.lastSelectedActor.mouseClick((new CAAT.MouseEvent).init(n.x,n.y,e,t.lastSelectedActor,t.screenMousePoint))},!1),e.addEventListener("mousedown",function(e){e.preventDefault(),t.getCanvasCoord(t.mousePoint,e),t.isMouseDown=!0,t.lastSelectedActor=t.findActorAtPosition(t.mousePoint,new CAAT.Point(t.mousePoint.x,t.mousePoint.y,0));var n=t.mousePoint.x,r=t.mousePoint.y;null!==t.lastSelectedActor&&(t.lastSelectedActor.viewToModel(t.mousePoint),t.prevMousePoint.x=n,t.prevMousePoint.y=r,t.lastSelectedActor.mouseDown((new CAAT.MouseEvent).init(t.mousePoint.x,t.mousePoint.y,e,t.lastSelectedActor,t.screenMousePoint)))},!1),e.addEventListener("mouseover",function(e){e.preventDefault(),t.getCanvasCoord(t.mousePoint,e),t.lastSelectedActor=t.findActorAtPosition(t.mousePoint,new CAAT.Point(t.mousePoint.x,t.mousePoint.y,0));if(null!==t.lastSelectedActor){var n=new CAAT.Point(t.mousePoint.x,t.mousePoint.y,0);t.lastSelectedActor.viewToModel(n),t.lastSelectedActor.mouseEnter((new CAAT.MouseEvent).init(n.x,n.y,e,t.lastSelectedActor,t.screenMousePoint))}},!1),e.addEventListener("mouseout",function(e){e.preventDefault();if(null!==t.lastSelectedActor){t.getCanvasCoord(t.mousePoint,e);var n=new CAAT.Point(t.mousePoint.x,t.mousePoint.y,0);t.lastSelectedActor.viewToModel(n),t.lastSelectedActor.mouseExit((new CAAT.MouseEvent).init(n.x,n.y,e,t.lastSelectedActor,t.screenMousePoint)),t.lastSelectedActor=null}t.isMouseDown=!1},!1),e.addEventListener("mousemove",function(e){e.preventDefault(),t.getCanvasCoord(t.mousePoint,e);if(t.isMouseDown&&null!==t.lastSelectedActor){if(!t.dragging&&Math.abs(t.prevMousePoint.x-t.mousePoint.x)<CAAT.DRAG_THRESHOLD_X&&Math.abs(t.prevMousePoint.y-t.mousePoint.y)<CAAT.DRAG_THRESHOLD_Y)return;t.dragging=!0,null!==t.lastSelectedActor.parent&&t.lastSelectedActor.parent.viewToModel(t.mousePoint),t.lastSelectedActor.mouseDrag((new CAAT.MouseEvent).init(t.mousePoint.x,t.mousePoint.y,e,t.lastSelectedActor,t.screenMousePoint));return}var n=t.findActorAtPosition(t.mousePoint,new CAAT.Point(t.mousePoint.x,t.mousePoint.y,0)),r=n.viewToModel(new CAAT.Point(t.mousePoint.x,t.mousePoint.y,0));if(n!==t.lastSelectedActor){if(null!==t.lastSelectedActor){var i=t.lastSelectedActor.viewToModel(new CAAT.Point(t.mousePoint.x,t.mousePoint.y,0));t.lastSelectedActor.mouseExit((new CAAT.MouseEvent).init(i.x,i.y,e,t.lastSelectedActor,t.screenMousePoint))}null!==n&&n.mouseEnter((new CAAT.MouseEvent).init(r.x,r.y,e,n,t.screenMousePoint))}t.lastSelectedActor=n,null!==n&&t.lastSelectedActor.mouseMove((new CAAT.MouseEvent).init(r.x,r.y,e,t.lastSelectedActor,t.screenMousePoint))},!1),e.addEventListener("dblclick",function(e){e.preventDefault(),t.getCanvasCoord(t.mousePoint,e),null!==t.lastSelectedActor&&(t.lastSelectedActor.viewToModel(t.mousePoint.x,t.mousePoint.y),t.lastSelectedActor.mouseDblClick((new CAAT.MouseEvent).init(t.mousePoint.x,t.mousePoint.y,e,t.lastSelectedActor,t.screenMousePoint)))},!1),e.addEventListener("touchstart",n,!0),e.addEventListener("touchmove",n,!0),e.addEventListener("touchend",n,!0),e.addEventListener("touchcancel",n,!0)}},extend(CAAT.Director,CAAT.ActorContainer,null)}(),function(){CAAT.MouseEvent=function(){return this.point=new CAAT.Point(0,0,0),this.screenPoint=new CAAT.Point(0,0,0),this},CAAT.MouseEvent.prototype={screenPoint:null,point:null,time:0,source:null,shift:!1,control:!1,alt:!1,meta:!1,sourceEvent:null,init:function(e,t,n,r,i){return this.point.set(e,t),this.source=r,this.screenPoint=i,this.alt=n.altKey,this.control=n.ctrlKey,this.shift=n.shiftKey,this.meta=n.metaKey,this.sourceEvent=n,this.x=e,this.y=t,this},isAltDown:function(){return this.alt},isControlDown:function(){return this.control},isShiftDown:function(){return this.shift},isMetaDown:function(){return this.meta},getSourceEvent:function(){return this.sourceEvent}}}(),CAAT.PMR=64,CAAT.DEBUG=!1,CAAT.log=function(){window.console&&window.console.log(Array.prototype.slice.call(arguments))},CAAT.GlobalEventsEnabled=!1,CAAT.prevOnDeviceMotion=null,CAAT.onDeviceMotion=null,CAAT.accelerationIncludingGravity={x:0,y:0,z:0},CAAT.rotationRate={alpha:0,beta:0,gamma:0},CAAT.DRAG_THRESHOLD_X=5,CAAT.DRAG_THRESHOLD_Y=5,CAAT.renderEnabled=!1,CAAT.FPS=60,CAAT.windowResizeListeners=[],CAAT.registerResizeListener=function(e){CAAT.windowResizeListeners.push(e)},CAAT.unregisterResizeListener=function(e){for(var t=0;t<CAAT.windowResizeListeners.length;t++)if(e===CAAT.windowResizeListeners[t]){CAAT.windowResizeListeners.splice(t,1);return}},CAAT.keyListeners=[],CAAT.registerKeyListener=function(e){CAAT.keyListeners.push(e)},CAAT.SHIFT_KEY=16,CAAT.CONTROL_KEY=17,CAAT.ALT_KEY=18,CAAT.ENTER_KEY=13,CAAT.KEY_MODIFIERS={alt:!1,control:!1,shift:!1},CAAT.GlobalEnableEvents=function(){if(CAAT.GlobalEventsEnabled)return;this.GlobalEventsEnabled=!0,window.addEventListener("keydown",function(e){var t=e.which?e.which:e.keyCode;if(t===CAAT.SHIFT_KEY)CAAT.KEY_MODIFIERS.shift=!0;else if(t===CAAT.CONTROL_KEY)CAAT.KEY_MODIFIERS.control=!0;else if(t===CAAT.ALT_KEY)CAAT.KEY_MODIFIERS.alt=!0;else for(var n=0;n<CAAT.keyListeners.length;n++)CAAT.keyListeners[n](t,"down",{alt:CAAT.KEY_MODIFIERS.alt,control:CAAT.KEY_MODIFIERS.control,shift:CAAT.KEY_MODIFIERS.shift})},!1),window.addEventListener("keyup",function(e){var t=e.which?e.which:e.keyCode;if(t===CAAT.SHIFT_KEY)CAAT.KEY_MODIFIERS.shift=!1;else if(t===CAAT.CONTROL_KEY)CAAT.KEY_MODIFIERS.control=!1;else if(t===CAAT.ALT_KEY)CAAT.KEY_MODIFIERS.alt=!1;else for(var n=0;n<CAAT.keyListeners.length;n++)CAAT.keyListeners[n](t,"up",{alt:CAAT.KEY_MODIFIERS.alt,control:CAAT.KEY_MODIFIERS.control,shift:CAAT.KEY_MODIFIERS.shift})},!1),window.addEventListener("resize",function(e){},!1)},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,n){window.setTimeout(t,1e3/CAAT.FPS)}}(),CAAT.loop=function(e){if(CAAT.renderEnabled)return;CAAT.FPS=e||60,CAAT.renderEnabled=!0,CAAT.NO_PERF?setInterval(function(){for(var e=0,t=CAAT.director.length;e<t;e++)CAAT.director[e].renderFrame()},1e3/CAAT.FPS):CAAT.renderFrame()};var gCAATAllowRequestAnimFrame=!0;CAAT.renderFrame=function(){for(var e=0,t=CAAT.director.length;e<t;e++)CAAT.director[e].renderFrame();gCAATAllowRequestAnimFrame==1&&window.requestAnimFrame(CAAT.renderFrame,0)},CAAT.setCursor=function(e){navigator.browser!=="iOS"&&(document.body.style.cursor=e)},CAAT.RegisterDirector=function(t){CAAT.director||(CAAT.director=[]),CAAT.director.push(t),CAAT.GlobalEnableEvents()},function(){function e(e){CAAT.rotationRate={alpha:0,beta:e[0],gamma:e[1]}}window.DeviceOrientationEvent?window.addEventListener("deviceorientation",function(t){e([t.beta,t.gamma])},!0):window.DeviceMotionEvent?window.addEventListener("devicemotion",function(t){e([t.acceleration.x*2,t.acceleration.y*2])},!0):window.addEventListener("MozOrientation",function(t){e([-t.y*45,t.x*45])},!0)}(),function(){CAAT.CompoundImage=function(){return this.paint=this.paintN,this},CAAT.CompoundImage.prototype={TR_NONE:0,TR_FLIP_HORIZONTAL:1,TR_FLIP_VERTICAL:2,TR_FLIP_ALL:3,image:null,rows:0,cols:0,width:0,height:0,singleWidth:0,singleHeight:0,xyCache:null,initialize:function(e,t,n){this.image=e,this.rows=t,this.cols=n,this.width=e.width,this.height=e.height,this.singleWidth=Math.floor(this.width/n),this.singleHeight=Math.floor(this.height/t),this.xyCache=[];var r,i,s;if(e.__texturePage){e.__du=this.singleWidth/e.__texturePage.width,e.__dv=this.singleHeight/e.__texturePage.height;var o=this.singleWidth,u=this.singleHeight,a=this.cols;if(e.inverted){var f=o;o=u,u=f,a=this.rows}var l=this.image.__tx,c=this.image.__ty,h=this.image.__texturePage;for(r=0;r<t*n;r++){var p=r%a>>0,d=r/a>>0,v=l+p*o,m=c+d*u,g=v+o,y=m+u;this.xyCache.push([v/h.width,m/h.height,g/h.width,y/h.height,v,m,g,y])}}else for(r=0;r<t*n;r++)i=(r%this.cols|0)*this.singleWidth,s=(r/this.cols|0)*this.singleHeight,this.xyCache.push([i,s]);return this},paintInvertedH:function(e,t,n,r){return e.save(),e.translate((.5+n|0)+this.singleWidth,.5+r|0),e.scale(-1,1),e.drawImage(this.image,this.xyCache[t][0],this.xyCache[t][1],this.singleWidth,this.singleHeight,0,0,this.singleWidth,this.singleHeight),e.restore(),this},paintInvertedV:function(e,t,n,r){return e.save(),e.translate(n+.5|0,.5+r+this.singleHeight|0),e.scale(1,-1),e.drawImage(this.image,this.xyCache[t][0],this.xyCache[t][1],this.singleWidth,this.singleHeight,0,0,this.singleWidth,this.singleHeight),e.restore(),this},paintInvertedHV:function(e,t,n,r){return e.save(),e.translate(n+.5|0,.5+r+this.singleHeight|0),e.scale(1,-1),e.translate(this.singleWidth,0),e.scale(-1,1),e.drawImage(this.image,this.xyCache[t][0],this.xyCache[t][1],this.singleWidth,this.singleHeight,0,0,this.singleWidth,this.singleHeight),e.restore(),this},paintN:function(e,t,n,r){return e.drawImage(this.image,this.xyCache[t][0]>>0,this.xyCache[t][1]>>0,this.singleWidth,this.singleHeight,n>>0,r>>0,this.singleWidth,this.singleHeight),this},paint:function(e,t,n,r){return this.paintN(e,t,n,r)},paintScaled:function(e,t,n,r,i,s){return e.drawImage(this.image,this.xyCache[t][0],this.xyCache[t][1],this.singleWidth,this.singleHeight,n+.5|0,r+.5|0,i,s),this},getNumImages:function(){return this.rows*this.cols},setUV:function(e,t,n){var r=this.image;if(!r.__texturePage)return;var i=n;r.inverted?(t[i++]=this.xyCache[e][2],t[i++]=this.xyCache[e][1],t[i++]=this.xyCache[e][2],t[i++]=this.xyCache[e][3],t[i++]=this.xyCache[e][0],t[i++]=this.xyCache[e][3],t[i++]=this.xyCache[e][0],t[i++]=this.xyCache[e][1]):(t[i++]=this.xyCache[e][0],t[i++]=this.xyCache[e][1],t[i++]=this.xyCache[e][2],t[i++]=this.xyCache[e][1],t[i++]=this.xyCache[e][2],t[i++]=this.xyCache[e][3],t[i++]=this.xyCache[e][0],t[i++]=this.xyCache[e][3])}}}(),function(){CAAT.SpriteImage=function(){return this.paint=this.paintN,this.setAnimationImageIndex([0]),this},CAAT.SpriteImage.prototype={animationImageIndex:null,prevAnimationTime:-1,changeFPS:1e3,transformation:0,spriteIndex:0,TR_NONE:0,TR_FLIP_HORIZONTAL:1,TR_FLIP_VERTICAL:2,TR_FLIP_ALL:3,TR_FIXED_TO_SIZE:4,image:null,rows:1,columns:1,width:0,height:0,singleWidth:0,singleHeight:0,scaleX:1,scaleY:1,offsetX:0,offsetY:0,xyCache:null,ownerActor:null,setOwner:function(e){return this.ownerActor=e,this},getRows:function(){return this.rows},getColumns:function(){return this.columns},getRef:function(){var e=new CAAT.SpriteImage;return e.image=this.image,e.rows=this.rows,e.columns=this.columns,e.width=this.width,e.height=this.height,e.singleWidth=this.singleWidth,e.singleHeight=this.singleHeight,e.xyCache=this.xyCache,e.offsetX=this.offsetX,e.offsetY=this.offsetY,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e},setOffsetX:function(e){return this.offsetX=e|0,this},setOffsetY:function(e){return this.offsetY=e|0,this},setOffset:function(e,t){return this.offsetX=e,this.offsetY=t,this},initialize:function(e,t,n){this.image=e,this.rows=t,this.columns=n,this.width=e.width,this.height=e.height,this.singleWidth=Math.floor(this.width/n),this.singleHeight=Math.floor(this.height/t),this.xyCache=[];var r,i,s;if(e.__texturePage){e.__du=this.singleWidth/e.__texturePage.width,e.__dv=this.singleHeight/e.__texturePage.height;var o=this.singleWidth,u=this.singleHeight,a=this.columns;if(e.inverted){var f=o;o=u,u=f,a=this.rows}var l=this.image.__tx,c=this.image.__ty,h=this.image.__texturePage;for(r=0;r<t*n;r++){var p=r%a>>0,d=r/a>>0,v=l+p*o,m=c+d*u,g=v+o,y=m+u;this.xyCache.push([v/h.width,m/h.height,g/h.width,y/h.height,v,m,g,y])}}else for(r=0;r<t*n;r++)i=(r%this.columns|0)*this.singleWidth,s=(r/this.columns|0)*this.singleHeight,this.xyCache.push([i,s]);return this},paintInvertedH:function(e,t,n,r){this.setSpriteIndexAtTime(t);var i=e.ctx;return i.save(),i.translate((.5+n|0)+this.singleWidth,.5+r|0),i.scale(-1,1),i.drawImage(this.image,this.xyCache[this.spriteIndex][0],this.xyCache[this.spriteIndex][1],this.singleWidth,this.singleHeight,this.offsetX,this.offsetY,this.singleWidth,this.singleHeight),i.restore(),this},paintInvertedV:function(e,t,n,r){this.setSpriteIndexAtTime(t);var i=e.ctx;return i.save(),i.translate(n+.5|0,.5+r+this.singleHeight|0),i.scale(1,-1),i.drawImage(this.image,this.xyCache[this.spriteIndex][0],this.xyCache[this.spriteIndex][1],this.singleWidth,this.singleHeight,this.offsetX,this.offsetY,this.singleWidth,this.singleHeight),i.restore(),this},paintInvertedHV:function(e,t,n,r){this.setSpriteIndexAtTime(t);var i=e.ctx;return i.save(),i.translate(n+.5|0,.5+r+this.singleHeight|0),i.scale(1,-1),i.translate(this.singleWidth,0),i.scale(-1,1),i.drawImage(this.image,this.xyCache[this.spriteIndex][0],this.xyCache[this.spriteIndex][1],this.singleWidth,this.singleHeight,this.offsetX,this.offsetY,this.singleWidth,this.singleHeight),i.restore(),this},paintN:function(e,t,n,r){return this.setSpriteIndexAtTime(t),e.ctx.drawImage(this.image,this.xyCache[this.spriteIndex][0]>>0,this.xyCache[this.spriteIndex][1]>>0,this.singleWidth,this.singleHeight,this.offsetX+n,this.offsetY+r,this.singleWidth,this.singleHeight),this},paintScaled:function(e,t,n,r){return this.setSpriteIndexAtTime(t),e.ctx.drawImage(this.image,this.xyCache[this.spriteIndex][0],this.xyCache[this.spriteIndex][1],this.singleWidth,this.singleHeight,n+.5|0,r+.5|0,this.ownerActor.width,this.ownerActor.height),this},getCurrentSpriteImageCSSPosition:function(){return"-"+(this.xyCache[this.spriteIndex][0]-this.offsetX)+"px -"+(this.xyCache[this.spriteIndex][1]-this.offsetY)+"px"},getNumImages:function(){return this.rows*this.columns},setUV:function(e,t){var n=this.image;if(!n.__texturePage)return;var r=t,i=this.spriteIndex,s=this.xyCache[i][0],o=this.xyCache[i][1],u=this.xyCache[i][2],a=this.xyCache[i][3];if(this.offsetX||this.offsetY){var f=this.ownerActor.width,l=this.ownerActor.height,c=n.__texturePage,h=-this.offsetX/c.width,p=-this.offsetY/c.height,d=(f-this.offsetX)/c.width,v=(l-this.offsetY)/c.height;s=h+n.__u,o=p+n.__v,u=d+n.__u,a=v+n.__v}n.inverted?(e[r++]=u,e[r++]=o,e[r++]=u,e[r++]=a,e[r++]=s,e[r++]=a,e[r++]=s,e[r++]=o):(e[r++]=s,e[r++]=o,e[r++]=u,e[r++]=o,e[r++]=u,e[r++]=a,e[r++]=s,e[r++]=a)},setChangeFPS:function(e){return this.changeFPS=e,this},setSpriteTransformation:function(e){this.transformation=e;switch(e){case this.TR_FLIP_HORIZONTAL:this.paint=this.paintInvertedH;break;case this.TR_FLIP_VERTICAL:this.paint=this.paintInvertedV;break;case this.TR_FLIP_ALL:this.paint=this.paintInvertedHV;break;case this.TR_FIXED_TO_SIZE:this.paint=this.paintScaled;break;default:this.paint=this.paintN}return this},setAnimationImageIndex:function(e){return this.animationImageIndex=e,this.spriteIndex=e[0],this},setSpriteIndex:function(e){return this.spriteIndex=e,this},setSpriteIndexAtTime:function(e){if(this.animationImageIndex.length>1)if(this.prevAnimationTime===-1)this.prevAnimationTime=e,this.spriteIndex=0;else{var t=e;t-=this.prevAnimationTime,t/=this.changeFPS,t%=this.animationImageIndex.length,this.spriteIndex=this.animationImageIndex[Math.floor(t)]}}}}(),function(){CAAT.ImagePreloader=function(){return this.images=[],this},CAAT.ImagePreloader.prototype={images:null,notificationCallback:null,imageCounter:0,loadImages:function(e,t){e||t&&t(0,[]);var n=this,r;this.notificationCallback=t,this.images=[];for(r=0;r<e.length;r++)this.images.push({id:e[r].id,image:new Image});for(r=0;r<e.length;r++)this.images[r].image.onload=function(){n.imageCounter++,n.notificationCallback(n.imageCounter,n.images)},this.images[r].image.src=e[r].url;e.length===0&&t(0,[])}}}(),function(){CAAT.TimerTask=function(){return this},CAAT.TimerTask.prototype={startTime:0,duration:0,callback_timeout:null,callback_tick:null,callback_cancel:null,scene:null,taskId:0,remove:!1,create:function(e,t,n,r,i){return this.startTime=e,this.duration=t,this.callback_timeout=n,this.callback_tick=r,this.callback_cancel=i,this},checkTask:function(e){var t=e;return t-=this.startTime,t>=this.duration?(this.remove=!0,this.callback_timeout&&this.callback_timeout(e,t,this)):this.callback_tick&&this.callback_tick(e,t,this),this},reset:function(e){return this.remove=!1,this.startTime=e,this.scene.ensureTimerTask(this),this},cancel:function(){return this.remove=!0,null!=this.callback_cancel&&this.callback_cancel(this.scene.time,this.scene.time-this.startTime,this),this}}}(),function(){CAAT.Scene=function(){return CAAT.Scene.superclass.constructor.call(this),this.timerList=[],this.fillStyle=null,this},CAAT.Scene.prototype={easeContainerBehaviour:null,easeContainerBehaviourListener:null,easeIn:!1,EASE_ROTATION:1,EASE_SCALE:2,EASE_TRANSLATE:3,timerList:null,timerSequence:0,checkTimers:function(e){var t=this.timerList.length-1;while(t>=0)this.timerList[t].remove||this.timerList[t].checkTask(e),t--},ensureTimerTask:function(e){return this.hasTimer(e)||this.timerList.push(e),this},hasTimer:function(e){var t=this.timerList.length-1;while(t>=0){if(this.timerList[t]===e)return!0;t--}return!1},createTimer:function(e,t,n,r,i){var s=(new CAAT.TimerTask).create(e,t,n,r,i);return s.taskId=this.timerSequence++,s.sceneTime=this.time,s.scene=this,this.timerList.push(s),s},removeExpiredTimers:function(){var e;for(e=0;e<this.timerList.length;e++)this.timerList[e].remove&&this.timerList.splice(e,1)},animate:function(e,t){this.checkTimers(t),CAAT.Scene.superclass.animate.call(this,e,t),this.removeExpiredTimers()},createAlphaBehaviour:function(e,t){var n=new CAAT.AlphaBehavior;n.setFrameTime(0,e),n.startAlpha=t?0:1,n.endAlpha=t?1:0,this.easeContainerBehaviour.addBehavior(n)},easeTranslationIn:function(e,t,n,r){this.easeTranslation(e,t,n,!0,r)},easeTranslationOut:function(e,t,n,r){this.easeTranslation(e,t,n,!1,r)},easeTranslation:function(e,t,n,r,i){this.easeContainerBehaviour=new CAAT.ContainerBehavior,this.easeIn=r;var s=new CAAT.PathBehavior;i&&s.setInterpolator(i),s.setFrameTime(0,e),n<1?n=1:n>4&&(n=4);switch(n){case CAAT.Actor.prototype.ANCHOR_TOP:r?s.setPath((new CAAT.Path).setLinear(0,-this.height,0,0)):s.setPath((new CAAT.Path).setLinear(0,0,0,-this.height));break;case CAAT.Actor.prototype.ANCHOR_BOTTOM:r?s.setPath((new CAAT.Path).setLinear(0,this.height,0,0)):s.setPath((new CAAT.Path).setLinear(0,0,0,this.height));break;case CAAT.Actor.prototype.ANCHOR_LEFT:r?s.setPath((new CAAT.Path).setLinear(-this.width,0,0,0)):s.setPath((new CAAT.Path).setLinear(0,0,-this.width,0));break;case CAAT.Actor.prototype.ANCHOR_RIGHT:r?s.setPath((new CAAT.Path).setLinear(this.width,0,0,0)):s.setPath((new CAAT.Path).setLinear(0,0,this.width,0))}t&&this.createAlphaBehaviour(e,r),this.easeContainerBehaviour.addBehavior(s),this.easeContainerBehaviour.setFrameTime(this.time,e),this.easeContainerBehaviour.addListener(this),this.emptyBehaviorList(),CAAT.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},easeScaleIn:function(e,t,n,r,i){this.easeScale(e,t,n,r,!0,i),this.easeIn=!0},easeScaleOut:function(e,t,n,r,i){this.easeScale(e,t,n,r,!1,i),this.easeIn=!1},easeScale:function(e,t,n,r,i,s){this.easeContainerBehaviour=new CAAT.ContainerBehavior;var o=0,u=0,a=0,f=0;switch(r){case CAAT.Actor.prototype.ANCHOR_TOP_LEFT:case CAAT.Actor.prototype.ANCHOR_TOP_RIGHT:case CAAT.Actor.prototype.ANCHOR_BOTTOM_LEFT:case CAAT.Actor.prototype.ANCHOR_BOTTOM_RIGHT:case CAAT.Actor.prototype.ANCHOR_CENTER:a=1,f=1;break;case CAAT.Actor.prototype.ANCHOR_TOP:case CAAT.Actor.prototype.ANCHOR_BOTTOM:o=1,a=1,u=0,f=1;break;case CAAT.Actor.prototype.ANCHOR_LEFT:case CAAT.Actor.prototype.ANCHOR_RIGHT:u=1,f=1,o=0,a=1;break;default:alert("scale anchor ?? "+r)}if(!i){var l;l=o,o=a,a=l,l=u,u=f,f=l}n&&this.createAlphaBehaviour(t,i);var c=this.getAnchorPercent(r),h=(new CAAT.ScaleBehavior).setFrameTime(e,t).setValues(o,a,u,f,c.x,c.y);s&&h.setInterpolator(s),this.easeContainerBehaviour.addBehavior(h),this.easeContainerBehaviour.setFrameTime(this.time,t),this.easeContainerBehaviour.addListener(this),this.emptyBehaviorList(),CAAT.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},addBehavior:function(e){return this},easeRotationIn:function(e,t,n,r){this.easeRotation(e,t,n,!0,r),this.easeIn=!0},easeRotationOut:function(e,t,n,r){this.easeRotation(e,t,n,!1,r),this.easeIn=!1},easeRotation:function(e,t,n,r,i){this.easeContainerBehaviour=new CAAT.ContainerBehavior;var s=0,o=0;n==CAAT.Actor.prototype.ANCHOR_CENTER&&(n=CAAT.Actor.prototype.ANCHOR_TOP);switch(n){case CAAT.Actor.prototype.ANCHOR_TOP:case CAAT.Actor.prototype.ANCHOR_BOTTOM:case CAAT.Actor.prototype.ANCHOR_LEFT:case CAAT.Actor.prototype.ANCHOR_RIGHT:s=Math.PI*(Math.random()<.5?1:-1);break;case CAAT.Actor.prototype.ANCHOR_TOP_LEFT:case CAAT.Actor.prototype.ANCHOR_TOP_RIGHT:case CAAT.Actor.prototype.ANCHOR_BOTTOM_LEFT:case CAAT.Actor.prototype.ANCHOR_BOTTOM_RIGHT:s=Math.PI/2*(Math.random()<.5?1:-1);break;default:alert("rot anchor ?? "+n)}if(!1===r){var u=s;s=o,o=u}t&&this.createAlphaBehaviour(e,r);var a=this.getAnchorPercent(n),f=(new CAAT.RotateBehavior).setFrameTime(0,e).setValues(s,o,a.x,a.y);i&&f.setInterpolator(i),this.easeContainerBehaviour.addBehavior(f),this.easeContainerBehaviour.setFrameTime(this.time,e),this.easeContainerBehaviour.addListener(this),this.emptyBehaviorList(),CAAT.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},setEaseListener:function(e){this.easeContainerBehaviourListener=e},behaviorExpired:function(e){this.easeContainerBehaviourListener.easeEnd(this,this.easeIn)},activated:function(){},setExpired:function(e){this.expired=e},paint:function(e,t){if(this.fillStyle){var n=e.crc;n.fillStyle=this.fillStyle,n.fillRect(0,0,this.width,this.height)}}},extend(CAAT.Scene,CAAT.ActorContainer,null)}(),CAAT.modules=CAAT.modules||{},CAAT.modules.CircleManager=CAAT.modules.CircleManager||{},function(){CAAT.modules.CircleManager.PackedCircle=function(){return this.boundsRule=CAAT.modules.CircleManager.PackedCircle.BOUNDS_RULE_IGNORE,this.position=new CAAT.Point(0,0,0),this.offset=new CAAT.Point(0,0,0),this.targetPosition=new CAAT.Point(0,0,0),this},CAAT.modules.CircleManager.PackedCircle.prototype={id:0,delegate:null,position:new CAAT.Point(0,0,0),offset:new CAAT.Point(0,0,0),targetPosition:null,targetChaseSpeed:.02,isFixed:!1,boundsRule:0,collisionMask:0,collisionGroup:0,BOUNDS_RULE_WRAP:1,BOUNDS_RULE_CONSTRAINT:2,BOUNDS_RULE_DESTROY:4,BOUNDS_RULE_IGNORE:8,containsPoint:function(e){var t=this.position.getDistanceSquared(e);return t<this.radiusSquared},getDistanceSquaredFromPosition:function(e){var t=this.position.getDistanceSquared(e);return t<this.radiusSquared},intersects:function(e){var t=this.position.getDistanceSquared(e.position);return t<this.radiusSquared||t<e.radiusSquared},setPosition:function(e){return this.position=e,this},setDelegate:function(e){return this.delegate=e,this},setOffset:function(e){return this.offset=e,this},setTargetPosition:function(e){return this.targetPosition=e,this},setTargetChaseSpeed:function(e){return this.targetChaseSpeed=e,this},setIsFixed:function(e){return this.isFixed=e,this},setCollisionMask:function(e){return this.collisionMask=e,this},setCollisionGroup:function(e){return this.collisionGroup=e,this},setRadius:function(e){return this.radius=e,this.radiusSquared=this.radius*this.radius,this},initialize:function(e){if(e)for(var t in e)this[t]=e[t];return this},dealloc:function(){this.position=null,this.offset=null,this.delegate=null,this.targetPosition=null}}}(),function(){CAAT.modules.CircleManager.PackedCircleManager=function(){return this},CAAT.modules.CircleManager.PackedCircleManager.prototype={allCircles:[],numberOfCollisionPasses:1,numberOfTargetingPasses:0,bounds:new CAAT.Rectangle,addCircle:function(e){return e.id=this.allCircles.length,this.allCircles.push(e),this},removeCircle:function(e){var t=0,n=!1,r=this.allCircles.length;if(r===0)throw"Error: (PackedCircleManager) attempting to remove circle, and allCircles.length === 0!!";while(r--)if(this.allCircles[r]===e){n=!0,t=r;break}if(!n)throw"Could not locate circle in allCircles array!";return this.allCircles[t].dealloc(),this.allCircles[t]=null,this},forceCirclesToMatchDelegatePositions:function(){var e=this.allCircles.length;for(var t=0;t<e;t++){var n=this.allCircles[t];if(!n||!n.delegate)continue;n.position.set(n.delegate.x+n.offset.x,n.delegate.y+n.offset.y)}},pushAllCirclesTowardTarget:function(e){var t=new CAAT.Point(0,0,0),n=this.allCircles,r=n.length;for(var i=0;i<this.numberOfTargetingPasses;i++)for(var s=0;s<r;s++){var o=n[s];if(o.isFixed)continue;t.x=o.position.x-(o.targetPosition.x+o.offset.x),t.y=o.position.y-(o.targetPosition.y+o.offset.y),t.multiply(o.targetChaseSpeed),o.position.x-=t.x,o.position.y-=t.y}},handleCollisions:function(){this.removeExpiredElements();var e=new CAAT.Point(0,0,0),t=this.allCircles,n=t.length;for(var r=0;r<this.numberOfCollisionPasses;r++)for(var i=0;i<n;i++){var s=t[i];for(var o=i+1;o<n;o++){var u=t[o];if(!this.circlesCanCollide(s,u))continue;var a=u.position.x-s.position.x,f=u.position.y-s.position.y,l=(s.radius+u.radius)*1.08,c=s.position.getDistanceSquared(u.position);if(c<l*l-.02){e.x=a,e.y=f,e.normalize();var h=(l-Math.sqrt(c))*.5;e.multiply(h),u.isFixed||(s.isFixed&&e.multiply(2.2),u.position.translatePoint(e)),s.isFixed||(u.isFixed&&e.multiply(2.2),s.position.subtract(e))}}}},handleBoundaryForCircle:function(e,t){var n=e.position.x,r=e.position.y,i=e.radius,s=i*2,o=1,u=4,a=8,f=16,l=32;t=u|a,t&o&&n-s>this.bounds.right?e.position.x=this.bounds.left+i:t&o&&n+s<this.bounds.left&&(e.position.x=this.bounds.right-i),t&u&&r-s>this.bounds.bottom?e.position.y=this.bounds.top-i:t&u&&r+s<this.bounds.top&&(e.position.y=this.bounds.bottom+i),t&a&&n+i>=this.bounds.right?e.position.x=e.position.x=this.bounds.right-i:t&a&&n-i<this.bounds.left&&(e.position.x=this.bounds.left+i),t&f&&r+i>this.bounds.bottom?e.position.y=this.bounds.bottom-i:t&f&&r-i<this.bounds.top&&(e.position.y=this.bounds.top+i)},getCircleAt:function(e,t,n){var r=this.allCircles,i=r.length,s=new CAAT.Point(e,t,0),o=null,u=Number.MAX_VALUE;for(var a=0;a<i;a++){var f=r[a];if(!f)continue;var l=f.position.getDistanceSquared(s);l<u&&l<f.radiusSquared+n&&(u=l,o=f)}return o},circlesCanCollide:function(e,t){return!e||!t||e===t?!1:!0},setBounds:function(e,t,n,r){this.bounds.x=e,this.bounds.y=t,this.bounds.width=n,this.bounds.height=r},setNumberOfCollisionPasses:function(e){return this.numberOfCollisionPasses=e,this},setNumberOfTargetingPasses:function(e){return this.numberOfTargetingPasses=e,this},sortOnDistanceToTarget:function(e,t){var n=e.getDistanceSquaredFromPosition(e.targetPosition),r=t.getDistanceSquaredFromPosition(e.targetPosition),i=0;return n>r?i=-1:n<r&&(i=1),i},removeExpiredElements:function(){for(var e=this.allCircles.length;e>=0;e--)this.allCircles[e]===null&&this.allCircles.splice(e,1)},initialize:function(e){if(e)for(var t in e)this[t]=e[t];return this}}}(),function(){CAAT.modules.LocalStorage=function(){return this},CAAT.modules.LocalStorage.prototype={save:function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(n){}return this},load:function(e){try{return JSON.parse(localStorage.getItem(e))}catch(t){return null}},remove:function(e){try{localStorage.removeItem(e)}catch(t){}return this}}}(),function(){CAAT.modules.ImageUtil=function(){return this},CAAT.modules.ImageUtil.prototype={createAlphaSpriteSheet:function(e,t,n,r,i){if(e<t){var s=e;e=t,t=s}var o=document.createElement("canvas");o.width=r.width,o.height=r.height*n;var u=o.getContext("2d");u.fillStyle=i?i:"rgba(255,255,255,0)",u.fillRect(0,0,r.width,r.height*n);var a;for(a=0;a<n;a++)u.globalAlpha=1-(e-t)/n*(a+1),u.drawImage(r,0,a*r.height);return o},rotate:function(e,t){t=t||0;if(!t)return e;var n=document.createElement("canvas");n.width=e.height,n.height=e.width;var r=n.getContext("2d");r.globalAlpha=1,r.fillStyle="rgba(0,0,0,0)",r.clearRect(0,0,n.width,n.height);var i=new CAAT.Matrix;return i.multiply((new CAAT.Matrix).setTranslate(n.width/2,n.width/2)),i.multiply((new CAAT.Matrix).setRotation(t*Math.PI/180)),i.multiply((new CAAT.Matrix).setTranslate(-n.width/2,-n.width/2)),i.transformRenderingContext(r),r.drawImage(e,0,0),n},optimize:function(e,t){t>>=0;var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var r=n.getContext("2d");r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,e.width,e.height),r.drawImage(e,0,0);var i=r.getImageData(0,0,e.width,e.height),s=i.data,o,u,a=n.height,f=0,l=n.width,c=0,h=!1;for(o=0;o<n.height;o++){for(u=0;u<n.width;u++)if(s[o*n.width*4+3+u*4]>t){h=!0;break}if(h)break}a=o,h=!1;for(o=n.height-1;o>=a;o--){for(u=3;u<n.width*4;u+=4)if(s[o*n.width*4+3+u*4]>t){h=!0;break}if(h)break}f=o,h=!1;for(u=0;u<n.width;u++){for(o=0;o<n.height;o++)if(s[o*n.width*4+3+u*4]>t){h=!0;break}if(h)break}l=u,h=!1;for(u=n.width-1;u>=l;u--){for(o=0;o<n.height;o++)if(s[o*n.width*4+3+u*4]>t){h=!0;break}if(h)break}c=u;if(0===l&&0===a&&n.width-1===c&&n.height-1===f)return n;var p=c-l+1,d=f-a+1,v=r.getImageData(l,a,p,d);return n.width=p,n.height=d,r=n.getContext("2d"),r.putImageData(v,0,0),n},createThumb:function(e,t,n,r){t=t||24,n=n||24;var i=document.createElement("canvas");i.width=t,i.height=n;var s=i.getContext("2d");if(r){var o=Math.max(e.width,e.height),u=e.width/o*t,a=e.height/o*n;s.drawImage(e,(t-u)/2,(n-a)/2,u,a)}else s.drawImage(e,0,0,t,n);return i}}}(),function(){CAAT.modules.LayoutUtils={},CAAT.modules.LayoutUtils.row=function(e,t,n){var r=t,i=n,s=e.width,o=0,u=0,a=0,f=0,l=Number.MIN_VALUE,c=Number.MAX_VALUE;for(a=r.length-1;a;a-=1)c<r[a].width&&(c=r[a].width),l<r[a].height&&(l=r[a].height);i.padding_left&&(o=i.padding_left,s-=o),i.padding_right&&(s-=i.padding_right);if(i.top){var h=parseInt(i.top,10);if(!isNaN(h))u=h;else switch(i.top){case"center":u=(e.height-l)/2;break;case"top":u=0;break;case"bottom":u=e.height-l}}var p=s/r.length;for(a=0,f=r.length;a<f;a++)r[a].setLocation(o+a*p+(p-r[a].width)/2,u)}}(),function(){CAAT.Interpolator=function(){return this.interpolated=new CAAT.Point(0,0,0),this},CAAT.Interpolator.prototype={interpolated:null,paintScale:90,createLinearInterpolator:function(e,t){return this.getPosition=function(r){var i=r;return e&&(r<.5?r*=2:r=1-(r-.5)*2),t!==null&&t&&(r=1-r),this.interpolated.set(i,r)},this},createBackOutInterpolator:function(e){return this.getPosition=function(n){var r=n;e&&(n<.5?n*=2:n=1-(n-.5)*2),n-=1;var i=1.70158;return this.interpolated.set(r,n*n*((i+1)*n+i)+1)},this},createExponentialInInterpolator:function(e,t){return this.getPosition=function(r){var i=r;return t&&(r<.5?r*=2:r=1-(r-.5)*2),this.interpolated.set(i,Math.pow(r,e))},this},createExponentialOutInterpolator:function(e,t){return this.getPosition=function(r){var i=r;return t&&(r<.5?r*=2:r=1-(r-.5)*2),this.interpolated.set(i,1-Math.pow(1-r,e))},this},createExponentialInOutInterpolator:function(e,t){return this.getPosition=function(r){var i=r;return t&&(r<.5?r*=2:r=1-(r-.5)*2),r*2<1?this.interpolated.set(i,Math.pow(r*2,e)/2):this.interpolated.set(i,1-Math.abs(Math.pow(r*2-2,e))/2)},this},createQuadricBezierInterpolator:function(e,t,n,r){return this.getPosition=function(s){var o=s;return r&&(s<.5?s*=2:s=1-(s-.5)*2),s=(1-s)*(1-s)*e.y+2*(1-s)*s*t.y+s*s*n.y,this.interpolated.set(o,s)},this},createCubicBezierInterpolator:function(e,t,n,r,i){return this.getPosition=function(o){var u=o;i&&(o<.5?o*=2:o=1-(o-.5)*2);var a=o*o,l=o*a;return o=e.y+o*(-e.y*3+o*(3*e.y-e.y*o))+o*(3*t.y+o*(-6*t.y+t.y*3*o))+a*(n.y*3-n.y*3*o)+r.y*l,this.interpolated.set(u,o)},this},createElasticOutInterpolator:function(e,t,n){return this.getPosition=function(i){n&&(i<.5?i*=2:i=1-(i-.5)*2);if(i===0)return{x:0,y:0};if(i===1)return{x:1,y:1};var s=t/(2*Math.PI)*Math.asin(1/e);return this.interpolated.set(i,e*Math.pow(2,-10*i)*Math.sin((i-s)*2*Math.PI/t)+1)},this},createElasticInInterpolator:function(e,t,n){return this.getPosition=function(i){n&&(i<.5?i*=2:i=1-(i-.5)*2);if(i===0)return{x:0,y:0};if(i===1)return{x:1,y:1};var s=t/(2*Math.PI)*Math.asin(1/e);return this.interpolated.set(i,-(e*Math.pow(2,10*(i-=1))*Math.sin((i-s)*2*Math.PI/t)))},this},createElasticInOutInterpolator:function(e,t,n){return this.getPosition=function(i){n&&(i<.5?i*=2:i=1-(i-.5)*2);var s=t/(2*Math.PI)*Math.asin(1/e);return i*=2,i<=1?this.interpolated.set(i,-0.5*e*Math.pow(2,10*(i-=1))*Math.sin((i-s)*2*Math.PI/t)):this.interpolated.set(i,1+.5*e*Math.pow(2,-10*(i-=1))*Math.sin((i-s)*2*Math.PI/t))},this},bounce:function(e){return(e/=1)<1/2.75?{x:e,y:7.5625*e*e}:e<2/2.75?{x:e,y:7.5625*(e-=1.5/2.75)*e+.75}:e<2.5/2.75?{x:e,y:7.5625*(e-=2.25/2.75)*e+.9375}:{x:e,y:7.5625*(e-=2.625/2.75)*e+.984375}},createBounceOutInterpolator:function(e){return this.getPosition=function(n){return e&&(n<.5?n*=2:n=1-(n-.5)*2),this.bounce(n)},this},createBounceInInterpolator:function(e){return this.getPosition=function(n){e&&(n<.5?n*=2:n=1-(n-.5)*2);var r=this.bounce(1-n);return r.y=1-r.y,r},this},createBounceInOutInterpolator:function(e){return this.getPosition=function(n){e&&(n<.5?n*=2:n=1-(n-.5)*2);var r;return n<.5?(r=this.bounce(1-n*2),r.y=(1-r.y)*.5,r):(r=this.bounce(n*2-1,e),r.y=r.y*.5+.5,r)},this},paint:function(e,t){var n=e.crc;n.save(),n.beginPath(),n.moveTo(0,this.getPosition(0).y*this.paintScale);for(var r=0;r<=this.paintScale;r++)n.lineTo(r,this.getPosition(r/this.paintScale).y*this.paintScale);n.strokeStyle="black",n.stroke(),n.restore()},getContour:function(e){var t=[];for(var n=0;n<=e;n++)t.push({x:n/e,y:this.getPosition(n/e).y});return t},enumerateInterpolators:function(){return[(new CAAT.Interpolator).createLinearInterpolator(!1,!1),"Linear pingpong=false, inverse=false",(new CAAT.Interpolator).createLinearInterpolator(!0,!1),"Linear pingpong=true, inverse=false",(new CAAT.Interpolator).createLinearInterpolator(!1,!0),"Linear pingpong=false, inverse=true",(new CAAT.Interpolator).createLinearInterpolator(!0,!0),"Linear pingpong=true, inverse=true",(new CAAT.Interpolator).createExponentialInInterpolator(2,!1),"ExponentialIn pingpong=false, exponent=2",(new CAAT.Interpolator).createExponentialOutInterpolator(2,!1),"ExponentialOut pingpong=false, exponent=2",(new CAAT.Interpolator).createExponentialInOutInterpolator(2,!1),"ExponentialInOut pingpong=false, exponent=2",(new CAAT.Interpolator).createExponentialInInterpolator(2,!0),"ExponentialIn pingpong=true, exponent=2",(new CAAT.Interpolator).createExponentialOutInterpolator(2,!0),"ExponentialOut pingpong=true, exponent=2",(new CAAT.Interpolator).createExponentialInOutInterpolator(2,!0),"ExponentialInOut pingpong=true, exponent=2",(new CAAT.Interpolator).createExponentialInInterpolator(4,!1),"ExponentialIn pingpong=false, exponent=4",(new CAAT.Interpolator).createExponentialOutInterpolator(4,!1),"ExponentialOut pingpong=false, exponent=4",(new CAAT.Interpolator).createExponentialInOutInterpolator(4,!1),"ExponentialInOut pingpong=false, exponent=4",(new CAAT.Interpolator).createExponentialInInterpolator(4,!0),"ExponentialIn pingpong=true, exponent=4",(new CAAT.Interpolator).createExponentialOutInterpolator(4,!0),"ExponentialOut pingpong=true, exponent=4",(new CAAT.Interpolator).createExponentialInOutInterpolator(4,!0),"ExponentialInOut pingpong=true, exponent=4",(new CAAT.Interpolator).createExponentialInInterpolator(6,!1),"ExponentialIn pingpong=false, exponent=6",(new CAAT.Interpolator).createExponentialOutInterpolator(6,!1),"ExponentialOut pingpong=false, exponent=6",(new CAAT.Interpolator).createExponentialInOutInterpolator(6,!1),"ExponentialInOut pingpong=false, exponent=6",(new CAAT.Interpolator).createExponentialInInterpolator(6,!0),"ExponentialIn pingpong=true, exponent=6",(new CAAT.Interpolator).createExponentialOutInterpolator(6,!0),"ExponentialOut pingpong=true, exponent=6",(new CAAT.Interpolator).createExponentialInOutInterpolator(6,!0),"ExponentialInOut pingpong=true, exponent=6",(new CAAT.Interpolator).createBounceInInterpolator(!1),"BounceIn pingpong=false",(new CAAT.Interpolator).createBounceOutInterpolator(!1),"BounceOut pingpong=false",(new CAAT.Interpolator).createBounceInOutInterpolator(!1),"BounceInOut pingpong=false",(new CAAT.Interpolator).createBounceInInterpolator(!0),"BounceIn pingpong=true",(new CAAT.Interpolator).createBounceOutInterpolator(!0),"BounceOut pingpong=true",(new CAAT.Interpolator).createBounceInOutInterpolator(!0),"BounceInOut pingpong=true",(new CAAT.Interpolator).createElasticInInterpolator(1.1,.4,!1),"ElasticIn pingpong=false, amp=1.1, d=.4",(new CAAT.Interpolator).createElasticOutInterpolator(1.1,.4,!1),"ElasticOut pingpong=false, amp=1.1, d=.4",(new CAAT.Interpolator).createElasticInOutInterpolator(1.1,.4,!1),"ElasticInOut pingpong=false, amp=1.1, d=.4",(new CAAT.Interpolator).createElasticInInterpolator(1.1,.4,!0),"ElasticIn pingpong=true, amp=1.1, d=.4",(new CAAT.Interpolator).createElasticOutInterpolator(1.1,.4,!0),"ElasticOut pingpong=true, amp=1.1, d=.4",(new CAAT.Interpolator).createElasticInOutInterpolator(1.1,.4,!0),"ElasticInOut pingpong=true, amp=1.1, d=.4",(new CAAT.Interpolator).createElasticInInterpolator(1,.2,!1),"ElasticIn pingpong=false, amp=1.0, d=.2",(new CAAT.Interpolator).createElasticOutInterpolator(1,.2,!1),"ElasticOut pingpong=false, amp=1.0, d=.2",(new CAAT.Interpolator).createElasticInOutInterpolator(1,.2,!1),"ElasticInOut pingpong=false, amp=1.0, d=.2",(new CAAT.Interpolator).createElasticInInterpolator(1,.2,!0),"ElasticIn pingpong=true, amp=1.0, d=.2",(new CAAT.Interpolator).createElasticOutInterpolator(1,.2,!0),"ElasticOut pingpong=true, amp=1.0, d=.2",(new CAAT.Interpolator).createElasticInOutInterpolator(1,.2,!0),"ElasticInOut pingpong=true, amp=1.0, d=.2"]}}}(),function(){CAAT.InterpolatorActor=function(){return CAAT.InterpolatorActor.superclass.constructor.call(this),this},CAAT.InterpolatorActor.prototype={interpolator:null,contour:null,S:50,gap:5,setGap:function(e){return this.gap=e,this},setInterpolator:function(e,t){return this.interpolator=e,this.contour=e.getContour(t||this.S),this},paint:function(e,t){CAAT.InterpolatorActor.superclass.paint.call(this,e,t);if(this.backgroundImage)return this;if(this.interpolator){var n=e.crc,r=this.width-2*this.gap,i=this.height-2*this.gap;n.beginPath(),n.moveTo(this.gap+r*this.contour[0].x,-this.gap+this.height-i*this.contour[0].y);for(var s=1;s<this.contour.length;s++)n.lineTo(this.gap+r*this.contour[s].x,-this.gap+this.height-i*this.contour[s].y);n.strokeStyle=this.strokeStyle,n.stroke()}},getInterpolator:function(){return this.interpolator}},extend(CAAT.InterpolatorActor,CAAT.ActorContainer,null)}(),function(){CAAT.PathSegment=function(){return this.bbox=new CAAT.Rectangle,this},CAAT.PathSegment.prototype={color:"black",length:0,bbox:null,parent:null,setParent:function(e){return this.parent=e,this},setColor:function(e){return e&&(this.color=e),this},endCurvePosition:function(){},startCurvePosition:function(){},setPoints:function(e){},setPoint:function(e,t){},getPosition:function(e){},getLength:function(){return this.length},getBoundingBox:function(){return this.bbox},numControlPoints:function(){},getControlPoint:function(e){},endPath:function(){},getContour:function(e){},updatePath:function(e){},applyAsPath:function(e){},transform:function(e){}}}(),function(){CAAT.LinearPath=function(){return CAAT.LinearPath.superclass.constructor.call(this),this.points=[],this.points.push(new CAAT.Point),this.points.push(new CAAT.Point),this.newPosition=new CAAT.Point(0,0,0),this},CAAT.LinearPath.prototype={points:null,newPosition:null,applyAsPath:function(e){e.lineTo(this.points[0].x,this.points[1].y)},setPoint:function(e,t){t===0?this.points[0]=e:t===1&&(this.points[1]=e)},updatePath:function(e){var t=this.points[1].x-this.points[0].x,n=this.points[1].y-this.points[0].y;return this.length=Math.sqrt(t*t+n*n),this.bbox.setEmpty(),this.bbox.union(this.points[0].x,this.points[0].y),this.bbox.union(this.points[1].x,this.points[1].y),this},setPoints:function(e){return this.points[0]=e[0],this.points[1]=e[1],this.updatePath(),this},setInitialPosition:function(e,t){return this.points[0].x=e,this.points[0].y=t,this.newPosition.set(e,t),this},setFinalPosition:function(e,t){return this.points[1].x=e,this.points[1].y=t,this},endCurvePosition:function(){return this.points[1]},startCurvePosition:function(){return this.points[0]},getPosition:function(e){if(e>1||e<0)e%=1;return e<0&&(e=1+e),this.newPosition.set(this.points[0].x+(this.points[1].x-this.points[0].x)*e,this.points[0].y+(this.points[1].y-this.points[0].y)*e),this.newPosition},initialPositionX:function(){return this.points[0].x},finalPositionX:function(){return this.points[1].x},paint:function(e,t){var n=e.crc;n.save(),n.strokeStyle=this.color,n.beginPath(),n.moveTo(this.points[0].x,this.points[0].y),n.lineTo(this.points[1].x,this.points[1].y),n.stroke(),t&&(n.globalAlpha=.5,n.fillStyle="#7f7f00",n.beginPath(),n.arc(this.points[0].x,this.points[0].y,CAAT.Curve.prototype.HANDLE_SIZE/2,0,2*Math.PI,!1),n.arc(this.points[1].x,this.points[1].y,CAAT.Curve.prototype.HANDLE_SIZE/2,0,2*Math.PI,!1),n.fill()),n.restore()},numControlPoints:function(){return 2},getControlPoint:function(e){if(0===e)return this.points[0];if(1===e)return this.points[1]},getContour:function(e){var t=[];return t.push(this.getPosition(0).clone()),t.push(this.getPosition(1).clone()),t}},extend(CAAT.LinearPath,CAAT.PathSegment)}(),function(){CAAT.CurvePath=function(){return CAAT.CurvePath.superclass.constructor.call(this),this.newPosition=new CAAT.Point(0,0,0),this},CAAT.CurvePath.prototype={curve:null,newPosition:null,applyAsPath:function(e){return this.curve.applyAsPath(e),this},setPoint:function(e,t){this.curve&&this.curve.setPoint(e,t)},setPoints:function(e){var t=new CAAT.Bezier;return t.setPoints(e),this.curve=t,this},setQuadric:function(e,t,n,r,i,s){var o=new CAAT.Bezier;return o.setQuadric(e,t,n,r,i,s),this.curve=o,this.updatePath(),this},setCubic:function(e,t,n,r,i,s,o,u){var a=new CAAT.Bezier;return a.setCubic(e,t,n,r,i,s,o,u),this.curve=a,this.updatePath(),this},updatePath:function(e){return this.curve.update(),this.length=this.curve.getLength(),this.curve.getBoundingBox(this.bbox),this},getPosition:function(e){if(e>1||e<0)e%=1;return e<0&&(e=1+e),this.curve.solve(this.newPosition,e),this.newPosition},getPositionFromLength:function(e){return this.curve.solve(this.newPosition,e/this.length),this.newPosition},initialPositionX:function(){return this.curve.coordlist[0].x},finalPositionX:function(){return this.curve.coordlist[this.curve.coordlist.length-1].x},paint:function(e,t){this.curve.drawHandles=t,e.ctx.strokeStyle=this.color,this.curve.paint(e)},numControlPoints:function(){return this.curve.coordlist.length},getControlPoint:function(e){return this.curve.coordlist[e]},endCurvePosition:function(){return this.curve.endCurvePosition()},startCurvePosition:function(){return this.curve.startCurvePosition()},getContour:function(e){var t=[];for(var n=0;n<=e;n++)t.push({x:n/e,y:this.getPosition(n/e).y});return t}},extend(CAAT.CurvePath,CAAT.PathSegment,null)}(),function(){CAAT.ShapePath=function(){return CAAT.ShapePath.superclass.constructor.call(this),this.points=[],this.points.push(new CAAT.Point),this.points.push(new CAAT.Point),this.points.push(new CAAT.Point),this.points.push(new CAAT.Point),this.points.push(new CAAT.Point),this.newPosition=new CAAT.Point,this},CAAT.ShapePath.prototype={points:null,length:-1,cw:!0,bbox:null,newPosition:null,applyAsPath:function(e){return this.cw?(e.lineTo(this.points[0].x,this.points[0].y),e.lineTo(this.points[1].x,this.points[1].y),e.lineTo(this.points[2].x,this.points[2].y),e.lineTo(this.points[3].x,this.points[3].y),e.lineTo(this.points[4].x,this.points[4].y)):(e.lineTo(this.points[4].x,this.points[4].y),e.lineTo(this.points[3].x,this.points[3].y),e.lineTo(this.points[2].x,this.points[2].y),e.lineTo(this.points[1].x,this.points[1].y),e.lineTo(this.points[0].x,this.points[0].y)),this},setPoint:function(e,t){t>=0&&t<this.points.length&&(this.points[t]=e)},setPoints:function(e){return this.points=[],this.points.push(e[0]),this.points.push((new CAAT.Point).set(e[1].x,e[0].y)),this.points.push(e[1]),this.points.push((new CAAT.Point).set(e[0].x,e[1].y)),this.points.push(e[0].clone()),this.updatePath(),this},setClockWise:function(e){return this.cw=e!==undefined?e:!0,this},isClockWise:function(){return this.cw},setInitialPosition:function(e,t){for(var n=0,r=this.points.length;n<r;n++)this.points[n].x=e,this.points[n].y=t;return this},setFinalPosition:function(e,t){return this.points[2].x=e,this.points[2].y=t,this.points[1].x=e,this.points[1].y=this.points[0].y,this.points[3].x=this.points[0].x,this.points[3].y=t,this.points[4].x=this.points[0].x,this.points[4].y=this.points[0].y,this.updatePath(),this},endCurvePosition:function(){return this.points[4]},startCurvePosition:function(){return this.points[0]},getPosition:function(e){if(e>1||e<0)e%=1;e<0&&(e=1+e);if(-1===this.length)this.newPosition.set(0,0);else{var t=this.bbox.width/this.length,n=this.bbox.height/this.length,r=0,i,s,o=0;this.cw?(s=[0,1,2,3,4],i=[t,n,t,n]):(s=[4,3,2,1,0],i=[n,t,n,t]);while(o<i.length){if(!(r+i[o]<e))break;r+=i[o],o++}e-=r;var u=s[o],a=s[o+1];this.newPosition.set(this.points[u].x+(this.points[a].x-this.points[u].x)*e/i[o],this.points[u].y+(this.points[a].y-this.points[u].y)*e/i[o])}return this.newPosition},initialPositionX:function(){return this.points[0].x},finalPositionX:function(){return this.points[2].x},paint:function(e,t){var n=e.crc;n.save(),n.strokeStyle=this.color,n.beginPath(),n.strokeRect(this.bbox.x,this.bbox.y,this.bbox.width,this.bbox.height);if(t){n.globalAlpha=.5,n.fillStyle="#7f7f00";for(var r=0;r<this.points.length;r++)n.beginPath(),n.arc(this.points[r].x,this.points[r].y,CAAT.Curve.prototype.HANDLE_SIZE/2,0,2*Math.PI,!1),n.fill()}n.restore()},numControlPoints:function(){return this.points.length},getControlPoint:function(e){return this.points[e]},getContour:function(e){var t=[];for(var n=0;n<this.points.length;n++)t.push(this.points[n]);return t},updatePath:function(e){e&&(e===this.points[0]?(this.points[1].y=e.y,this.points[3].x=e.x):e===this.points[1]?(this.points[0].y=e.y,this.points[2].x=e.x):e===this.points[2]?(this.points[3].y=e.y,this.points[1].x=e.x):e===this.points[3]&&(this.points[0].x=e.x,this.points[2].y=e.y),this.points[4].x=this.points[0].x,this.points[4].y=this.points[0].y),this.bbox.setEmpty();for(var t=0;t<4;t++)this.bbox.union(this.points[t].x,this.points[t].y);return this.length=2*this.bbox.width+2*this.bbox.height,this.points[0].x=this.bbox.x,this.points[0].y=this.bbox.y,this.points[1].x=this.bbox.x+this.bbox.width,this.points[1].y=this.bbox.y,this.points[2].x=this.bbox.x+this.bbox.width,this.points[2].y=this.bbox.y+this.bbox.height,this.points[3].x=this.bbox.x,this.points[3].y=this.bbox.y+this.bbox.height,this.points[4].x=this.bbox.x,this.points[4].y=this.bbox.y,this}},extend(CAAT.ShapePath,CAAT.PathSegment)}(),function(){CAAT.Path=function(){return CAAT.Path.superclass.constructor.call(this),this.newPosition=new CAAT.Point(0,0,0),this.pathSegments=[],this.behaviorList=[],this.matrix=new CAAT.Matrix,this.tmpMatrix=new CAAT.Matrix,this},CAAT.Path.prototype={pathSegments:null,pathSegmentDurationTime:null,pathSegmentStartTime:null,newPosition:null,pathLength:-1,beginPathX:-1,beginPathY:-1,trackPathX:-1,trackPathY:-1,ax:-1,ay:-1,point:[],interactive:!0,behaviorList:null,rb_angle:0,rb_rotateAnchorX:0,rb_rotateAnchorY:0,sb_scaleX:1,sb_scaleY:1,sb_scaleAnchorX:0,sb_scaleAnchorY:0,tb_x:0,tb_y:0,matrix:null,tmpMatrix:null,pathPoints:null,width:0,height:0,applyAsPath:function(e){e.beginPath(),e.globalCompositeOperation="source-out",e.moveTo(this.getFirstPathSegment().startCurvePosition().x,this.getFirstPathSegment().startCurvePosition().y);for(var t=0;t<this.pathSegments.length;t++)this.pathSegments[t].applyAsPath(e);return e.globalCompositeOperation="source-over",this},setInteractive:function(e){return this.interactive=e,this},getFirstPathSegment:function(){return this.pathSegments.length?this.pathSegments[0]:null},getLastPathSegment:function(){return this.pathSegments.length?this.pathSegments[this.pathSegments.length-1]:null},endCurvePosition:function(){return this.pathSegments.length?this.pathSegments[this.pathSegments.length-1].endCurvePosition():(new CAAT.Point).set(this.beginPathX,this.beginPathY)},startCurvePosition:function(){return this.pathSegments[0].startCurvePosition()},getCurrentPathSegment:function(){return this.pathSegments[this.pathSegments.length-1]},setLinear:function(e,t,n,r){return this.beginPath(e,t),this.addLineTo(n,r),this.endPath(),this},setQuadric:function(e,t,n,r,i,s){return this.beginPath(e,t),this.addQuadricTo(n,r,i,s),this.endPath(),this},setCubic:function(e,t,n,r,i,s,o,u){return this.beginPath(e,t),this.addCubicTo(n,r,i,s,o,u),this.endPath(),this},setRectangle:function(e,t,n,r){return this.beginPath(e,t),this.addRectangleTo(n,r),this.endPath(),this},addSegment:function(e){return e.setParent(this),this.pathSegments.push(e),this},addRectangleTo:function(e,t,n,r){var i=new CAAT.ShapePath;return i.setPoints([this.endCurvePosition(),(new CAAT.Point).set(e,t)]),i.setClockWise(n),i.setColor(r),i.setParent(this),this.pathSegments.push(i),this},addQuadricTo:function(e,t,n,r,i){var s=new CAAT.Bezier;s.setPoints([this.endCurvePosition(),(new CAAT.Point).set(e,t),(new CAAT.Point).set(n,r)]),this.trackPathX=n,this.trackPathY=r;var o=(new CAAT.CurvePath).setColor(i).setParent(this);return o.curve=s,this.pathSegments.push(o),this},addCubicTo:function(e,t,n,r,i,s,o){var u=new CAAT.Bezier;u.setPoints([this.endCurvePosition(),(new CAAT.Point).set(e,t),(new CAAT.Point).set(n,r),(new CAAT.Point).set(i,s)]),this.trackPathX=i,this.trackPathY=s;var a=(new CAAT.CurvePath).setColor(o).setParent(this);return a.curve=u,this.pathSegments.push(a),this},addCatmullTo:function(e,t,n,r,i,s,o){var u=(new CAAT.CatmullRom).setColor(o);u.setCurve(this.trackPathX,this.trackPathY,e,t,n,r,i,s),this.trackPathX=i,this.trackPathY=s;var a=(new CAAT.CurvePath).setParent(this);return a.curve=u,this.pathSegments.push(a),this},addLineTo:function(e,t,n){var r=(new CAAT.LinearPath).setColor(n);return r.setPoints([this.endCurvePosition(),(new CAAT.Point).set(e,t)]),r.setParent(this),this.trackPathX=e,this.trackPathY=t,this.pathSegments.push(r),this},beginPath:function(e,t){return this.trackPathX=e,this.trackPathY=t,this.beginPathX=e,this.beginPathY=t,this},closePath:function(){return this.getLastPathSegment().setPoint(this.getFirstPathSegment().startCurvePosition(),this.getLastPathSegment().numControlPoints()-1),this.trackPathX=this.beginPathX,this.trackPathY=this.beginPathY,this.endPath(),this},endPath:function(){return this.pathSegmentStartTime=[],this.pathSegmentDurationTime=[],this.updatePath(),this},getPosition:function(e){if(e>1||e<0)e%=1;e<0&&(e=1+e);for(var t=0;t<this.pathSegments.length;t++)if(this.pathSegmentStartTime[t]<=e&&e<=this.pathSegmentStartTime[t]+this.pathSegmentDurationTime[t]){e=this.pathSegmentDurationTime[t]?(e-this.pathSegmentStartTime[t])/this.pathSegmentDurationTime[t]:0;var n=this.pathSegments[t].getPosition(e);this.newPosition.x=n.x,this.newPosition.y=n.y;break}return this.newPosition},getPositionFromLength:function(e){e%=this.getLength(),e<0&&(e+=this.getLength());var t=0;for(var n=0;n<this.pathSegments.length;n++){if(t<=e&&e<=this.pathSegments[n].getLength()+t){e-=t;var r=this.pathSegments[n].getPositionFromLength(e);this.newPosition.x=r.x,this.newPosition.y=r.y;break}t+=this.pathSegments[n].getLength()}return this.newPosition},paint:function(e){for(var t=0;t<this.pathSegments.length;t++)this.pathSegments[t].paint(e,this.interactive)},release:function(){this.ax=-1,this.ay=-1},getNumSegments:function(){return this.pathSegments.length},getSegment:function(e){return this.pathSegments[e]},numControlPoints:function(){return this.points.length},getControlPoint:function(e){return this.points[e]},updatePath:function(e){var t,n;this.length=0,this.bbox.setEmpty(),this.points=[];for(t=0;t<this.pathSegments.length;t++){this.pathSegments[t].updatePath(e),this.length+=this.pathSegments[t].getLength(),this.bbox.unionRectangle(this.pathSegments[t].bbox);for(n=0;n<this.pathSegments[t].numControlPoints();n++)this.points.push(this.pathSegments[t].getControlPoint(n))}this.width=this.bbox.width,this.height=this.bbox.height,this.pathSegmentStartTime=[],this.pathSegmentDurationTime=[];var t;for(t=0;t<this.pathSegments.length;t++)this.pathSegmentStartTime.push(0),this.pathSegmentDurationTime.push(0);for(t=0;t<this.pathSegments.length;t++)this.pathSegmentDurationTime[t]=this.getLength()?this.pathSegments[t].getLength()/this.getLength():0,t>0?this.pathSegmentStartTime[t]=this.pathSegmentStartTime[t-1]+this.pathSegmentDurationTime[t-1]:this.pathSegmentStartTime[0]=0,this.pathSegments[t].endPath();return this},press:function(e,t){if(!this.interactive)return;var n=CAAT.Curve.prototype.HANDLE_SIZE/2;for(var r=0;r<this.pathSegments.length;r++)for(var i=0;i<this.pathSegments[r].numControlPoints();i++){var s=this.pathSegments[r].getControlPoint(i);if(e>=s.x-n&&t>=s.y-n&&e<s.x+n&&t<s.y+n){this.point=s;return}}this.point=null},drag:function(e,t){if(!this.interactive)return;if(null===this.point)return;if(-1===this.ax||-1===this.ay)this.ax=e,this.ay=t;this.point.x+=e-this.ax,this.point.y+=t-this.ay,this.ax=e,this.ay=t,this.updatePath(this.point)},getContour:function(e){var t=[];for(var n=0;n<=e;n++)t.push((new CAAT.Point).set(n/e,this.getPosition(n/e).y,0));return t},setPoints:function(e){if(this.points.length===e.length)for(var t=0;t<e.length;t++)this.points[t].x=e[t].x,this.points[t].y=e[t].y;return this},setPoint:function(e,t){return t>=0&&t<this.points.length&&(this.points[t].x=e.x,this.points[t].y=e.y),this},emptyBehaviorList:function(){return this.behaviorList=[],this},extractPathPoints:function(){if(!this.pathPoints){var e;this.pathPoints=[];for(e=0;e<this.numControlPoints();e++)this.pathPoints.push(this.getControlPoint(e).clone())}return this},addBehavior:function(e){return this.behaviorList.push(e),this.extractPathPoints(),this},removeBehaviour:function(e){var t=this.behaviorList.length-1;while(t)if(this.behaviorList[t]===e)return this.behaviorList.splice(t,1),this;return this},removeBehaviorById:function(e){for(var t=0;t<this.behaviorList.length;t++)this.behaviorList[t].id===e&&this.behaviorList.splice(t,1);return this},applyBehaviors:function(e){if(this.behaviorList.length){for(var t=0;t<this.behaviorList.length;t++)this.behaviorList[t].apply(e,this);this.setATMatrix();for(t=0;t<this.numControlPoints();t++)this.setPoint(this.matrix.transformCoord(this.pathPoints[t].clone()),t)}return this},setATMatrix:function(){this.matrix.identity();var e=this.tmpMatrix.identity(),t=this.matrix.matrix;t[2]+=this.tb_x,t[5]+=this.tb_y,this.rb_angle&&(t[2]+=t[0]*this.rb_rotateAnchorX+t[1]*this.rb_rotateAnchorY,t[5]+=t[3]*this.rb_rotateAnchorX+t[4]*this.rb_rotateAnchorY,this.matrix.multiply(e.setRotation(this.rb_angle)),t[2]+=-t[0]*this.rb_rotateAnchorX-t[1]*this.rb_rotateAnchorY,t[5]+=-t[3]*this.rb_rotateAnchorX-t[4]*this.rb_rotateAnchorY);if(this.sb_scaleX!=1||this.sb_scaleY!=1&&(this.sb_scaleAnchorX||this.sb_scaleAnchorY))t[2]+=t[0]*this.sb_scaleAnchorX+t[1]*this.sb_scaleAnchorY,t[5]+=t[3]*this.sb_scaleAnchorX+t[4]*this.sb_scaleAnchorY,t[0]=t[0]*this.sb_scaleX,t[1]=t[1]*this.sb_scaleY,t[3]=t[3]*this.sb_scaleX,t[4]=t[4]*this.sb_scaleY,t[2]+=-t[0]*this.sb_scaleAnchorX-t[1]*this.sb_scaleAnchorY,t[5]+=-t[3]*this.sb_scaleAnchorX-t[4]*this.sb_scaleAnchorY;return this},setRotationAnchored:function(e,t,n){return this.rb_angle=e,this.rb_rotateAnchorX=t+this.bbox.x,this.rb_rotateAnchorY=n+this.bbox.y,this},setScaleAnchored:function(e,t,n,r){return this.sb_scaleX=e,this.sb_scaleAnchorX=n+this.bbox.x,this.sb_scaleY=t,this.sb_scaleAnchorY=r+this.bbox.y,this},setLocation:function(e,t){return this.tb_x=e,this.tb_y=t,this}},extend(CAAT.Path,CAAT.PathSegment,null)}(),function(){CAAT.PathActor=function(){return CAAT.PathActor.superclass.constructor.call(this),this},CAAT.PathActor.prototype={path:null,pathBoundingRectangle:null,bOutline:!1,outlineColor:"black",getPath:function(){return this.path},setPath:function(e){return this.path=e,this.pathBoundingRectangle=e.getBoundingBox(),this},paint:function(e,t){var n=e.crc;n.strokeStyle="black",this.path.paint(e),this.bOutline&&(n.strokeStyle=this.outlineColor,n.strokeRect(0,0,this.width,this.height))},showBoundingBox:function(e,t){this.bOutline=e,e&&t&&(this.outlineColor=t)},setInteractive:function(e){return this.path&&this.path.setInteractive(e),this},mouseDrag:function(e){this.path.drag(e.point.x,e.point.y)},mouseDown:function(e){this.path.press(e.point.x,e.point.y)},mouseUp:function(e){this.path.release()}},extend(CAAT.PathActor,CAAT.ActorContainer,null)}(),function(){CAAT.ImageProcessor=function(){return this},CAAT.ImageProcessor.prototype={canvas:null,ctx:null,width:0,height:0,imageData:null,bufferImage:null,grabPixels:function(e){var t=document.createElement("canvas");if(t!==null){t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0);try{var r=n.getImageData(0,0,t.width,t.height);return r}catch(i){return CAAT.log("error pixelgrabbing.",e),null}}return null},makeArray:function(e,t){var n=[];for(var r=0;r<e;r++)n.push(t);return n},makeArray2D:function(e,t,n){var r=[];for(var i=0;i<e;i++)r.push(this.makeArray(t,n));return r},initialize:function(e,t){return this.width=e,this.height=t,this.canvas=document.createElement("canvas"),this.canvas!==null&&(this.canvas.width=e,this.canvas.height=t,this.ctx=this.canvas.getContext("2d"),this.imageData=this.ctx.getImageData(0,0,e,t),this.bufferImage=this.imageData.data),this},clear:function(e,t,n,r){if(null===this.imageData)return this;var i=this.imageData.data;for(var s=0;s<this.width*this.height;s++)i[s*4+0]=e,i[s*4+1]=t,i[s*4+2]=n,i[s*4+3]=r;return this},getImageData:function(){return this.ctx.getImageData(0,0,this.width,this.height)},apply:function(e,t){return null!==this.imageData&&this.ctx.putImageData(this.imageData,0,0),this},getCanvas:function(){return this.canvas},createPattern:function(e){return this.ctx.createPattern(this.canvas,e?e:"repeat")},paint:function(e,t){if(null!==this.canvas){var n=e.ctx;n.drawImage(this.getCanvas(),0,0)}}}}(),function(){CAAT.IMPlasma=function(){return CAAT.IMPlasma.superclass.constructor.call(this),this},CAAT.IMPlasma.prototype={wavetable:null,m_colorMap:null,spd1:1,spd2:2,spd3:3,spd4:4,pos1:0,pos2:0,pos3:0,pos4:0,tpos1:0,tpos2:0,tpos3:0,tpos4:0,m_colorMapSize:256,i1:0,i2:0,i3:0,i4:0,b1:!1,b2:!1,b3:!1,b4:!1,color:[4294967295,4294902015,4294967040,4278255360,4294901760,4278190335,4278190080],initialize:function(e,t,n){CAAT.IMPlasma.superclass.initialize.call(this,e,t),this.wavetable=[];for(var r=0;r<256;r++)this.wavetable.push(Math.floor(32*(1+Math.cos(r*2*Math.PI/256))));return this.pos1=Math.floor(255*Math.random()),this.pos2=Math.floor(255*Math.random()),this.pos3=Math.floor(255*Math.random()),this.pos4=Math.floor(255*Math.random()),this.m_colorMap=CAAT.Color.prototype.makeRGBColorRamp(n!==null?n:this.color,256,CAAT.Color.prototype.RampEnumeration.RAMP_CHANNEL_RGBA_ARRAY),this.setB(),this},setB:function(){this.b1=Math.random()>.5,this.b2=Math.random()>.5,this.b3=Math.random()>.5,this.b4=Math.random()>.5,this.spd1=Math.floor((Math.random()*3+1)*(Math.random()<.5?1:-1)),this.spd2=Math.floor((Math.random()*3+1)*(Math.random()<.5?1:-1)),this.spd3=Math.floor((Math.random()*3+1)*(Math.random()<.5?1:-1)),this.spd4=Math.floor((Math.random()*3+1)*(Math.random()<.5?1:-1)),this.i1=Math.floor((Math.random()*2.4+1)*(Math.random()<.5?1:-1)),this.i2=Math.floor((Math.random()*2.4+1)*(Math.random()<.5?1:-1)),this.i3=Math.floor((Math.random()*2.4+1)*(Math.random()<.5?1:-1)),this.i4=Math.floor((Math.random()*2.4+1)*(Math.random()<.5?1:-1))},apply:function(e,t){var n=0;this.tpos1=this.pos1,this.tpos2=this.pos2;for(var r=0;r<this.height;r++){this.tpos3=this.pos3,this.tpos4=this.pos4;for(var i=0;i<this.width;i++){var s=this.tpos1+this.tpos2+this.tpos3,o=this.tpos2+this.tpos3-this.tpos1,u=this.tpos3+this.tpos4-this.tpos2,a=this.tpos4+this.tpos1-this.tpos2;this.b1&&(s=-s),this.b2&&(o=-o),this.b3&&(u=-u),this.b4&&(a=-a);var f=Math.floor(this.wavetable[s&255]+this.wavetable[o&255]+this.wavetable[u&255]+this.wavetable[a&255]);this.bufferImage[n++]=this.m_colorMap[f][0],this.bufferImage[n++]=this.m_colorMap[f][1],this.bufferImage[n++]=this.m_colorMap[f][2],this.bufferImage[n++]=this.m_colorMap[f][3],this.tpos3+=this.i1,this.tpos3&=255,this.tpos4+=this.i2,this.tpos4&=255}this.tpos1+=this.i3,this.tpos1&=255,this.tpos2+=this.i4,this.tpos2&=255}return this.pos1+=this.spd1,this.pos2-=this.spd2,this.pos3+=this.spd3,this.pos4-=this.spd4,this.pos1&=255,this.pos3&=255,this.pos2&=255,this.pos4&=255,CAAT.IMPlasma.superclass.apply.call(this,e,t)}},extend(CAAT.IMPlasma,CAAT.ImageProcessor,null)}(),function(){CAAT.IMBump=function(){return CAAT.IMBump.superclass.constructor.call(this),this},CAAT.IMBump.prototype={m_avgX:null,m_avgY:null,m_tt:null,phong:null,m_radius:75,m_lightcolor:null,bcolor:!1,lightPosition:[],prepareBump:function(e,t){var n,r;this.m_radius=t?t:75;var i=this.grabPixels(e);this.m_tt=this.makeArray(this.height,0);for(n=0;n<this.height;n++)this.m_tt[n]=this.width*n;this.m_avgX=this.makeArray2D(this.height,this.width,0),this.m_avgY=this.makeArray2D(this.height,this.width,0);var s=this.makeArray2D(this.height,this.width,0);if(null===i)return;var o=i.data;for(n=0;n<this.height;n++)for(r=0;r<this.width;r++){var u=(n*this.width+r)*4;s[n][r]=o[u]+o[u+1]+o[u+2]}s=this.soften(s);for(var a=1;a<this.width-1;a++)for(var f=1;f<this.height-1;f++)this.m_avgX[f][a]=Math.floor(s[f][a+1]-s[f][a-1]),this.m_avgY[f][a]=Math.floor(s[f+1][a]-s[f-1][a]);s=null},soften:function(e){var t,n=this.makeArray2D(this.height,this.width,0);for(var r=0;r<this.width;r++)for(var i=0;i<this.height;i++)t=e[i][r],t+=e[(i+1)%this.height][r],t+=e[(i+this.height-1)%this.height][r],t+=e[i][(r+1)%this.width],t+=e[i][(r+this.width-1)%this.width],t+=e[(i+1)%this.height][(r+1)%this.width],t+=e[(i+this.height-1)%this.height][(r+this.width-1)%this.width],t+=e[(i+this.height-1)%this.height][(r+1)%this.width],t+=e[(i+1)%this.height][(r+this.width-1)%this.width],t/=9,n[i][r]=t/3;return n},calculatePhong:function(){this.phong=this.makeArray2D(this.m_radius,this.m_radius,0);var e,t,n;for(e=0;e<this.m_radius;e++)for(t=0;t<this.m_radius;t++){var r=t/this.m_radius,i=e/this.m_radius;n=(1-Math.sqrt(r*r+i*i))*.8,n<0&&(n=0),this.phong[e][t]=Math.floor(n*255)}},drawColored:function(e){var t,n,r;for(t=0;t<this.height;t++)for(n=0;n<this.width;n++){var i=0,s=0,o=0;for(r=0;r<this.m_lightcolor.length;r++){var u=this.lightPosition[r].x,a=this.lightPosition[r].y,f=Math.floor(Math.abs(this.m_avgX[t][n]-n+u)),l=Math.floor(Math.abs(this.m_avgY[t][n]-t+a));f>=this.m_radius&&(f=this.m_radius-1),l>=this.m_radius&&(l=this.m_radius-1);var c=this.phong[f][l],h=0,p=0,d=0;if(c>=0)h=this.m_lightcolor[r][0]*c/128,p=this.m_lightcolor[r][1]*c/128,d=this.m_lightcolor[r][2]*c/128;else{c=128+c;var v=this.m_lightcolor[r][0],m=this.m_lightcolor[r][1],g=this.m_lightcolor[r][2];h=Math.floor(v+(255-v)*c/128),p=Math.floor(m+(255-m)*c/128),d=Math.floor(g+(255-g)*c/128)}i+=h,s+=p,o+=d}i>255&&(i=255),s>255&&(s=255),o>255&&(o=255);var y=(n+this.m_tt[t])*4;e[y]=i,e[y+1]=s,e[y+2]=o,e[y+3]=255}},setLightColors:function(e){this.m_lightcolor=e,this.lightPosition=[];for(var t=0;t<this.m_lightcolor.length;t++){var n=this.width*Math.random(),r=this.height*Math.random();this.lightPosition.push((new CAAT.Point).set(n,r))}return this},initialize:function(e,t){return CAAT.IMBump.superclass.initialize.call(this,e.width,e.height),this.setLightColors([[255,128,0],[0,0,255]]),this.prepareBump(e,t),this.calculatePhong(),this},setLightPosition:function(e,t,n){return this.lightPosition[e].set(t,n),this},apply:function(e,t){return this.drawColored(this.bufferImage),CAAT.IMBump.superclass.apply.call(this,e,t)}},extend(CAAT.IMBump,CAAT.ImageProcessor,null)}(),function(){CAAT.IMRotoZoom=function(){return CAAT.IMRotoZoom.superclass.constructor.call(this),this},CAAT.IMRotoZoom.prototype={m_alignv:1,m_alignh:1,distortion:2,mask:0,shift:0,sourceImageData:null,initialize:function(e,t,n){CAAT.IMRotoZoom.superclass.initialize.call(this,e,t),this.clear(255,128,0,255),this.sourceImageData=this.grabPixels(n);if(null!==this.sourceImageData)switch(this.sourceImageData.width){case 1024:this.mask=1023,this.shift=10;break;case 512:this.mask=511,this.shift=9;break;case 256:this.mask=255,this.shift=8;break;case 128:this.mask=127,this.shift=7;break;case 64:this.mask=63,this.shift=6;break;case 32:this.mask=31,this.shift=5;break;case 16:this.mask=15,this.shift=4;break;case 8:this.mask=7,this.shift=3}return this.setCenter(),this},rotoZoom:function(e,t){var n=(new Date).getTime(),r=Math.PI*2*Math.cos(n*1e-4),i=600+550*Math.sin(n*2e-4),s=this.distortion,o=0,u=Math.floor(Math.cos(r)*i),a=Math.floor(Math.sin(r)*i),f=0,l=0;switch(this.m_alignh){case 0:f=0;break;case 1:f=this.height>>1;break;case 2:f=this.height-1}switch(this.m_alignv){case 0:l=0;break;case 1:l=this.width>>1;break;case 2:l=this.width-1}var c=(this.width>>1<<8)-u*l+a*f&65535,h=(this.height>>1<<8)-a*l-u*f&65535,p=this.sourceImageData.width,d=this.sourceImageData.height,v=this.sourceImageData.data;while(o<this.width*this.height*4){var m=c,g=h;for(var y=0;y<this.width;y++){var b=(g>>this.shift&this.mask)*p+(m>>this.shift&this.mask);b<<=2,this.bufferImage[o++]=v[b++],this.bufferImage[o++]=v[b++],this.bufferImage[o++]=v[b++],this.bufferImage[o++]=v[b++],m+=u,g+=a}s+=this.distortion,c-=a,h+=u-s}},apply:function(e,t){return null!==this.sourceImageData&&this.rotoZoom(e,t),CAAT.IMRotoZoom.superclass.apply.call(this,e,t)},setCenter:function(){var e=Math.random();e<.33?this.m_alignv=0:e<.66?this.m_alignv=1:this.m_alignv=2,e=Math.random(),e<.33?this.m_alignh=0:e<.66?this.m_alignh=1:this.m_alignh=2}},extend(CAAT.IMRotoZoom,CAAT.ImageProcessor,null)}(),function(){CAAT.Program=function(e){return this.gl=e,this},CAAT.Program.prototype={shaderProgram:null,gl:null,setAlpha:function(e){},getShader:function(e,t,n){var r;if(t==="x-shader/x-fragment")r=e.createShader(e.FRAGMENT_SHADER);else{if(t!=="x-shader/x-vertex")return null;r=e.createShader(e.VERTEX_SHADER)}return e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(alert(e.getShaderInfoLog(r)),null)},getDomShader:function(e,t){var n=document.getElementById(t);if(!n)return null;var r="",i=n.firstChild;while(i)i.nodeType===3&&(r+=i.textContent),i=i.nextSibling;var s;if(n.type==="x-shader/x-fragment")s=e.createShader(e.FRAGMENT_SHADER);else{if(n.type!=="x-shader/x-vertex")return null;s=e.createShader(e.VERTEX_SHADER)}return e.shaderSource(s,r),e.compileShader(s),e.getShaderParameter(s,e.COMPILE_STATUS)?s:(alert(e.getShaderInfoLog(s)),null)},initialize:function(){return this},getFragmentShader:function(){return null},getVertexShader:function(){return null},create:function(){var e=this.gl;return this.shaderProgram=e.createProgram(),e.attachShader(this.shaderProgram,this.getVertexShader()),e.attachShader(this.shaderProgram,this.getFragmentShader()),e.linkProgram(this.shaderProgram),e.useProgram(this.shaderProgram),this},setMatrixUniform:function(e){this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,new Float32Array(e.flatten()))},useProgram:function(){return this.gl.useProgram(this.shaderProgram),this}}}(),function(){CAAT.ColorProgram=function(e){return CAAT.ColorProgram.superclass.constructor.call(this,e),this},CAAT.ColorProgram.prototype={colorBuffer:null,vertexPositionBuffer:null,vertexPositionArray:null,getFragmentShader:function(){return this.getShader(this.gl,"x-shader/x-fragment","#ifdef GL_ES \nprecision highp float; \n#endif \nvarying vec4 color; \nvoid main(void) { \n  gl_FragColor = color;\n}\n")},getVertexShader:function(){return this.getShader(this.gl,"x-shader/x-vertex","attribute vec3 aVertexPosition; \nattribute vec4 aColor; \nuniform mat4 uPMatrix; \nvarying vec4 color; \nvoid main(void) { \ngl_Position = uPMatrix * vec4(aVertexPosition, 1.0); \ncolor= aColor; \n}\n")},initialize:function(){this.shaderProgram.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition"),this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute),this.shaderProgram.vertexColorAttribute=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.gl.enableVertexAttribArray(this.shaderProgram.vertexColorAttribute),this.shaderProgram.pMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uPMatrix"),this.useProgram(),this.colorBuffer=this.gl.createBuffer(),this.setColor([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);var e=4096,t;return this.vertexPositionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexPositionBuffer),this.vertexPositionArray=new Float32Array(e*12),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertexPositionArray,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,!1,0,0),CAAT.ColorProgram.superclass.initialize.call(this)},setColor:function(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.shaderProgram.vertexColorAttribute,this.colorBuffer,this.gl.FLOAT,!1,0,0)}},extend(CAAT.ColorProgram,CAAT.Program,null)}(),function(){CAAT.TextureProgram=function(e){return CAAT.TextureProgram.superclass.constructor.call(this,e),this},CAAT.TextureProgram.prototype={vertexPositionBuffer:null,vertexPositionArray:null,vertexUVBuffer:null,vertexUVArray:null,vertexIndexBuffer:null,linesBuffer:null,prevAlpha:-1,prevR:-1,prevG:-1,prevB:-1,prevA:-1,prevTexture:null,getFragmentShader:function(){return this.getShader(this.gl,"x-shader/x-fragment","#ifdef GL_ES \nprecision highp float; \n#endif \nvarying vec2 vTextureCoord; \nuniform sampler2D uSampler; \nuniform float alpha; \nuniform bool uUseColor;\nuniform vec4 uColor;\nvoid main(void) { \nif ( uUseColor ) {\n  gl_FragColor= vec4(uColor.rgb, uColor.a*alpha);\n} else { \n  vec4 textureColor= texture2D(uSampler, vec2(vTextureCoord)); \n  gl_FragColor = vec4(textureColor.rgb, textureColor.a * alpha); \n}\n}\n")},getVertexShader:function(){return this.getShader(this.gl,"x-shader/x-vertex","attribute vec3 aVertexPosition; \nattribute vec2 aTextureCoord; \nuniform mat4 uPMatrix; \nvarying vec2 vTextureCoord; \nvoid main(void) { \ngl_Position = uPMatrix * vec4(aVertexPosition, 1.0); \nvTextureCoord = aTextureCoord;\n}\n")},useProgram:function(){CAAT.TextureProgram.superclass.useProgram.call(this),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexPositionBuffer),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexUVBuffer),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)},initialize:function(){var e;this.linesBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.linesBuffer);var t=[];for(e=0;e<1024;e++)t[e]=e;this.linesBufferArray=new Uint16Array(t),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.linesBufferArray,this.gl.DYNAMIC_DRAW),this.shaderProgram.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition"),this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute),this.shaderProgram.textureCoordAttribute=this.gl.getAttribLocation(this.shaderProgram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute),this.shaderProgram.pMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uPMatrix"),this.shaderProgram.samplerUniform=this.gl.getUniformLocation(this.shaderProgram,"uSampler"),this.shaderProgram.alphaUniform=this.gl.getUniformLocation(this.shaderProgram,"alpha"),this.shaderProgram.useColor=this.gl.getUniformLocation(this.shaderProgram,"uUseColor"),this.shaderProgram.color=this.gl.getUniformLocation(this.shaderProgram,"uColor"),this.setAlpha(1),this.setUseColor(!1);var n=4096;this.vertexPositionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexPositionBuffer),this.vertexPositionArray=new Float32Array(n*12),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertexPositionArray,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,!1,0,0),this.vertexUVBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexUVBuffer),this.vertexUVArray=new Float32Array(n*8),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertexUVArray,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.shaderProgram.textureCoordAttribute,2,this.gl.FLOAT,!1,0,0),this.vertexIndexBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);var r=[];for(e=0;e<n;e++)r.push(0+e*4),r.push(1+e*4),r.push(2+e*4),r.push(0+e*4),r.push(2+e*4),r.push(3+e*4);return this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(r),this.gl.STATIC_DRAW),CAAT.TextureProgram.superclass.initialize.call(this)},setUseColor:function(e,t,n,r,i){this.gl.uniform1i(this.shaderProgram.useColor,e?1:0),e&&(this.prevA!==i||this.prevR!==t||this.prevG!==n||this.prevB!==r)&&(this.gl.uniform4f(this.shaderProgram.color,t,n,r,i),this.prevA=i,this.prevR=t,this.prevG=n,this.prevB=r)},setTexture:function(e){if(this.prevTexture!==e){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),t.uniform1i(this.shaderProgram.samplerUniform,0),this.prevTexture=e}return this},updateVertexBuffer:function(e){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexPositionBuffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,e),this},updateUVBuffer:function(e){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexUVBuffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,e),this},setAlpha:function(e){return this.prevAlpha!==e&&(this.gl.uniform1f(this.shaderProgram.alphaUniform,e),this.prevAlpha=e),this},drawLines:function(e,t,n,r,i,s,o){var u=this.gl;this.setAlpha(s),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,this.linesBuffer),u.lineWidth(o),this.updateVertexBuffer(e),this.setUseColor(!0,n,r,i,1),u.drawElements(u.LINES,t,u.UNSIGNED_SHORT,0),this.setAlpha(1),this.setUseColor(!1),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)},drawPolylines:function(e,t,n,r,i,s,o){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,this.linesBuffer),u.lineWidth(o),this.setAlpha(s),this.updateVertexBuffer(e),this.setUseColor(!0,n,r,i,1),u.drawElements(u.LINE_STRIP,t,u.UNSIGNED_SHORT,0),this.setAlpha(1),this.setUseColor(!1),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}},extend(CAAT.TextureProgram,CAAT.Program,null)}(),function(){CAAT.GLTextureElement=function(){return this},CAAT.GLTextureElement.prototype={inverted:!1,image:null,u:0,v:0,glTexture:null}}(),function(){CAAT.GLTextureScan=function(e){return this.freeChunks=[{position:0,size:e||1024}],this},CAAT.GLTextureScan.prototype={freeChunks:null,findWhereFits:function(e){if(this.freeChunks.length===0)return[];var t=[],n;for(n=0;n<this.freeChunks.length;n++){var r=0;while(r+e<=this.freeChunks[n].size)t.push(r+this.freeChunks[n].position),r+=e}return t},fits:function(e,t){var n=0;for(n=0;n<this.freeChunks.length;n++){var r=this.freeChunks[n];if(r.position<=e&&e+t<=r.position+r.size)return!0}return!1},substract:function(e,t){var n=0;for(n=0;n<this.freeChunks.length;n++){var r=this.freeChunks[n];if(r.position<=e&&e+t<=r.position+r.size){var i=0,s=0,o=0,u=0;return i=r.position,s=e-r.position,o=e+t,u=r.position+r.size-o,this.freeChunks.splice(n,1),s>0&&this.freeChunks.splice(n++,0,{position:i,size:s}),u>0&&this.freeChunks.splice(n,0,{position:o,size:u}),!0}}return!1},log:function(e){if(0===this.freeChunks.length)CAAT.log("index "+e+" empty");else{var t="index "+e;for(var n=0;n<this.freeChunks.length;n++){var r=this.freeChunks[n];t+="["+r.position+","+r.size+"]"}CAAT.log(t)}}}}(),function(){CAAT.GLTextureScanMap=function(e,t){this.scanMapHeight=t,this.scanMapWidth=e,this.scanMap=[];for(var n=0;n<this.scanMapHeight;n++)this.scanMap.push(new CAAT.GLTextureScan(this.scanMapWidth));return this},CAAT.GLTextureScanMap.prototype={scanMap:null,scanMapWidth:0,scanMapHeight:0,whereFitsChunk:function(e,t){if(e>this.width||t>this.height)return null;var n,r,i=0;while(i<=this.scanMapHeight-t){var s=null,o=!1;for(;i<=this.scanMapHeight-t;i++){s=this.scanMap[i].findWhereFits(e);if(null!==s&&s.length>0){o=!0;break}}if(!o)return null;var u=Number.MAX_VALUE;for(r=0;r<s.length;r++){var a=!0;for(n=i;n<i+t;n++)if(!this.scanMap[n].fits(s[r],e)){a=!1;break}if(a)return{x:s[r],y:i}}i++}return null},substract:function(e,t,n,r){for(var i=0;i<r;i++)this.scanMap[i+t].substract(e,n)||CAAT.log("Error: removing chunk ",n,r," at ",e,t)},log:function(){for(var e=0;e<this.scanMapHeight;e++)this.scanMap[e].log(e)}}}(),function(){CAAT.GLTexturePage=function(e,t){return this.width=e||1024,this.height=t||1024,this.images=[],this},CAAT.GLTexturePage.prototype={width:1024,height:1024,gl:null,texture:null,allowImagesInvertion:!1,padding:4,scan:null,images:null,criteria:"area",initialize:function(e){this.gl=e,this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);var t=new Uint8Array(this.width*this.height*4);for(var n=0;n<4*this.width*this.height;)t[n++]=0,t[n++]=0,t[n++]=0,t[n++]=0;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,t),e.enable(e.BLEND);for(var r=0;r<this.images.length;r++){var i=this.images[r];i.inverted&&(i=CAAT.modules.ImageUtil.prototype.rotate(i,-90)),e.texSubImage2D(e.TEXTURE_2D,0,this.images[r].__tx,this.images[r].__ty,e.RGBA,e.UNSIGNED_BYTE,i)}},create:function(e){var t=[];for(var n=0;n<e.length;n++){var r=e[n].image;t.push(r)}this.createFromImages(t)},clear:function(){this.createFromImages([])},update:function(e,t,n,r){this.allowImagesInvertion=e,this.padding=t,n<100&&(n=100),r<100&&(r=100),this.width=n,this.height=r,this.createFromImages(this.images)},createFromImages:function(e){var t;this.scan=new CAAT.GLTextureScanMap(this.width,this.height),this.images=[];if(this.allowImagesInvertion)for(t=0;t<e.length;t++)e[t].inverted=this.allowImagesInvertion&&e[t].height<e[t].width;var n=this;e.sort(function(e,t){var r=e.width*e.height,i=t.width*t.height;return n.criteria==="width"?e.width<t.width?1:e.width>t.width?-1:0:n.criteria==="height"?e.height<t.height?1:e.height>t.height?-1:0:r<i?1:r>i?-1:0});for(t=0;t<e.length;t++){var r=e[t];this.packImage(r)}},addImage:function(e,t,n){this.allowImagesInvertion=t,this.padding=n,this.images.push(e),this.createFromImages(Array.prototype.slice.call(this.images))},endCreation:function(){var e=this.gl;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D)},deletePage:function(){for(var e=0;e<this.images.length;e++)delete this.images[e].__texturePage,delete this.images[e].__u,delete this.images[e].__v;this.gl.deleteTexture(this.texture)},toCanvas:function(e,t){e=e||document.createElement("canvas"),e.width=this.width,e.height=this.height;var n=e.getContext("2d");n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,this.width,this.height);for(var r=0;r<this.images.length;r++){n.drawImage(this.images[r].inverted?CAAT.modules.ImageUtil.prototype.rotate(this.images[r],90):this.images[r],this.images[r].__tx,this.images[r].__ty),t&&(n.strokeStyle="red",n.strokeRect(this.images[r].__tx,this.images[r].__ty,this.images[r].__w,this.images[r].__h));if(this.images[r].__gridC&&this.images[r].__gridR)for(var i=0;i<this.images[r].__gridR;i++)for(var s=0;s<this.images[r].__gridC;s++)n.strokeStyle="blue",n.strokeRect(this.images[r].__tx+s*this.images[r].__w/this.images[r].__gridC,this.images[r].__ty+i*this.images[r].__h/this.images[r].__gridR,this.images[r].__w/this.images[r].__gridC,this.images[r].__h/this.images[r].__gridR)}return t&&(n.strokeStyle="red",n.strokeRect(0,0,this.width,this.height)),e},packImage:function(e){var t,n;e.inverted?(t=e.height,n=e.width):(t=e.width,n=e.height);var r=t,i=n,s;r&&this.padding&&(s=this.padding,r+s<=this.width&&(r+=s)),i&&this.padding&&(s=this.padding,i+s<=this.height&&(i+=s));var o=this.scan.whereFitsChunk(r,i);null!==o?(this.images.push(e),e.__tx=o.x,e.__ty=o.y,e.__u=o.x/this.width,e.__v=o.y/this.height,e.__u1=(o.x+t)/this.width,e.__v1=(o.y+n)/this.height,e.__texturePage=this,e.__w=t,e.__h=n,this.scan.substract(o.x,o.y,r,i)):CAAT.log("Imagen ",e.src," de tama�o ",e.width,e.height," no cabe.")},changeHeuristic:function(e){this.criteria=e}}}(),function(){CAAT.GLTexturePageManager=function(){return this.pages=[],this},CAAT.GLTexturePageManager.prototype={pages:null,createPages:function(e,t,n,r){var i=!1;while(!i){var s=new CAAT.GLTexturePage(t,n);s.create(r),s.initialize(e),s.endCreation(),this.pages.push(s),i=!0;for(var o=0;o<r.length;o++)if(!r[o].image.__texturePage){r[o].image.width<=t&&r[o].height<=n&&(i=!1);break}}},deletePages:function(){for(var e=0;e<this.pages.length;e++)this.pages[e].deletePage();this.pages=null}}}();function getElementPosition(e){var t=e,n="",r=0,i=0;if(t==null)return null;while(typeof t=="object"&&typeof t.tagName!="undefined"){i+=t.offsetTop,r+=t.offsetLeft,n=t.tagName.toUpperCase(),n=="BODY"&&(t=0),typeof t=="object"&&typeof t.offsetParent=="object"&&(t=t.offsetParent);if(t==null)return null}return{x:r,y:i}}var TGE=TGE||{};TGE.Game=function(){this.mCanvasDiv=null,this.mReorientationDiv=null,this.mDirector=null,this.mScene=null,this.mCanvasPosition=null,this.mGameManager=new TGE.ObjectsManager,this.mLayers={},this.mBackground=null,this.mCameraLocation=null,this.mScalingFactor=1,this.mLoadingStartTime=(new Date).getTime(),this.mLoadingScreen=null,this.mImageAssetLists=new Array,this.mPlaying=!1,this.mPaused=!1,this.mCurrentLevel=null,this.mPauseButton=null,this.mUserPauseEnabled=!1,this.mGameTime=0,this.mFilterStrength=10,this.mFrameTime=0,this.mLastLoop=new Date,this.mLastDisplay=new Date,this.mThisLoop,this.mFPSText=null,this.mMaxTickTime=.1,this.mMinTickTime=Number.MIN_VALUE,this.mUIManager=new TGE.ObjectsManager,this.mScreenManager=new TGE.ScreenManager(this),this.mMouseX=0,this.mMouseY=0,this.mMouseDown=!1,this.mKeysDown={},this.mDeviceInfo=new TGE.BrowserDetect,this.mDefaultLinkTarget="_blank",this.mButtonClickEvent="mousedown",CAAT.renderFrame=function(){for(var e=0,t=CAAT.director.length;e<t;e++)CAAT.director[e].renderFrame()}},TGE.Game.prototype={IsPlatformAcceptable:function(){var e=!1;if(this.mDeviceInfo.OSOrDevices.toLowerCase()=="iphone"||this.mDeviceInfo.OSOrDevices.toLowerCase()=="ipad"){var t=this.mDeviceInfo.OSversion.charCodeAt(0)-48;return t>=5}if(this.mDeviceInfo.OSOrDevices.toLowerCase()=="android")return!0;if(this.mDeviceInfo.OSOrDevices.toLowerCase()=="windows"||this.mDeviceInfo.OSOrDevices.toLowerCase()=="mac"){var n=this.mDeviceInfo.browser.toLowerCase(),r=parseFloat(this.mDeviceInfo.version);if(n=="firefox")return r>=8;if(n=="explorer")return r>=9;if(n=="chrome")return r>=14;if(n=="safari")return r>=5.1}return!0},DetermineCanvasPosition:function(){this.mCanvasPosition=getElementPosition(this.mCanvasDiv)},Launch:function(e,t){return this.mCanvasDiv=document.getElementById(e),this.mCanvasDiv==null?(console.log("***** ERROR: Could not find canvas div '"+e+"'"),!1):(this.ResizeViewportForDevice(),this.mReorientationDiv=document.getElementById(t),this.DetermineCanvasPosition(),window.addEventListener("resize",TGE.Game.prototype.DetermineCanvasPosition.bind(this),!1),this.mCanvasDiv.addEventListener(this.mButtonClickEvent,TGE.Game.prototype.Click.bind(this),!1),this.mCanvasDiv.addEventListener("mousedown",TGE.Game.prototype.MouseDown.bind(this),!0),this.mCanvasDiv.addEventListener("mouseup",TGE.Game.prototype.MouseUp.bind(this),!0),this.mCanvasDiv.addEventListener("mousemove",TGE.Game.prototype.MouseMove.bind(this),!0),this.mCanvasDiv.addEventListener("keyup",TGE.Game.prototype.KeyDown.bind(this),!0),this.mCanvasDiv.addEventListener("keydown",TGE.Game.prototype.KeyDown.bind(this),!0),this.InitializeRenderer(),this.mDeviceOrientation=new TGE.DeviceOrientation,this.mDeviceOrientation.RegisterOrientationChange(TGE.Game.prototype.OrientationChanged.bind(this)),this.BeginLoad(),!0)},ResizeViewportForDevice:function(){viewport=document.querySelector("meta[name=viewport]");switch(this.mDeviceInfo.OSOrDevices){case"iPhone":this.mCanvasDiv.clientWidth==960||this.mCanvasDiv.clientWidth==640?viewport.setAttribute("content","width=device-width, maximum-scale=0.5, minimum-scale=0.5,initial-scale=0.5, user-scalable=no"):viewport.setAttribute("content","width=device-width, maximum-scale=1.0, minimum-scale=1.0,initial-scale=1.0, user-scalable=no");break;case"Android":this.mDefaultLinkTarget="_self";break;case"iPad":parseInt(window.innerWidth)>1e3?viewport.setAttribute("content","width=device-width; maximum-scale=2.0; minimum-scale=2.0,initial-scale=2.0,user-scalable=no"):viewport.setAttribute("content","width=device-width; maximum-scale=1.07; minimum-scale=1.07,initial-scale=1.07,user-scalable=no");break;case"Windows":case"Mac":this.mButtonClickEvent="click";break;default:viewport.setAttribute("content","width=device-width, maximum-scale=1, minimum-scale=1, initial-scale=1,user-scalable=no")}if(window.navigator.standalone==1)switch(this.mDeviceInfo.OSOrDevices){case"iPhone":viewport.setAttribute("content","width=device-width, height=device-height, maximum-scale=0.50, minimum-scale=0.50,initial-scale=0.50, user-scalable=no");break;case"iPad":viewport.setAttribute("content","width=device-width; maximum-scale=1.07; minimum-scale=1.07,initial-scale=1.07,user-scalable=no")}},InitializeRenderer:function(){var e=!1;this.mCanvasDiv?this.mCanvasDiv instanceof HTMLDivElement?e=!1:this.mCanvasDiv instanceof HTMLCanvasElement?e=!0:this.mCanvasDiv=document.body:(this.mCanvasDiv=document.createElement("div"),document.body.appendChild(this.mCanvasDiv)),this.mDirector=(new CAAT.Director).initialize(this.mCanvasDiv.clientWidth,this.mCanvasDiv.clientHeight,e?this.mCanvasDiv:undefined).setClear(!1),e||this.mCanvasDiv.appendChild(this.mDirector.canvas),this.mDirector.setImagesCache(new Array),this.mScene=this.mDirector.createScene(),this.mDirector.setScene(0)},OrientationChanged:function(e){if(this.mReorientationDiv==null)return;switch(e){case"portrait":this.mCanvasDiv.style.display="none",this.mReorientationDiv.style.display="block",this.PauseGame(!0);break;case"landscape":this.mReorientationDiv.style.display="none",this.mCanvasDiv.style.display="block"}},AssignImageAssetList:function(e,t){this.mImageAssetLists[e]={loaded:!1,list:t}},LoadAssetList:function(e,t,n){var r=new TGE.AssetLoader,i=this.mImageAssetLists[e];r.LoadAssetList(this,i,t,n)},BeginLoad:function(){this.LoadAssetList("loading",null,TGE.Game.prototype.LoadRequiredAssets.bind(this))},LoadRequiredAssets:function(){this.mScreenManager.Initialize(this);var e=null;typeof LoadingScreen!="undefined"&&(this.mLoadingScreen=this.ShowScreen(LoadingScreen),e=TGE.Game.prototype.loadRequiredAssetsCallback.bind(this)),this.Update(),this.LoadAssetList("required",e,TGE.Game.prototype.finishedLoadingRequiredAssets.bind(this))},loadRequiredAssetsCallback:function(e){this.mLoadingScreen!=null&&typeof this.mLoadingScreen.UpdateProgress=="function"&&this.mLoadingScreen.UpdateProgress(e)},finishedLoadingRequiredAssets:function(){var e=Math.round(((new Date).getTime()-this.mLoadingStartTime)/1e3);this.AnalyticGameEvent("load",e),this.GotoMainMenu()},LoadLevelAssets:function(e,t,n){this.LoadAssetList("level_"+e.toString(),t,n)},StartLevel:function(e){var t=e==this.mCurrentLevel;this.mCurrentLevel=e,this.subclassSetupLevel(this.mCurrentLevel),this.AnalyticLevelEvent(t?"replay":"start"),(!this.mPlaying||this.mPaused)&&this.StartPlaying()},FinishLevel:function(){this.AnalyticLevelEvent("complete"),this.subclassFinishLevel()},Replay:function(){this.StartLevel(this.mCurrentLevel)},StartPlaying:function(){this.mGameTime=0,this.mPaused=!1,this.mPlaying=!0,this.subclassStartPlaying()},ClearScene:function(){this.mGameManager.Purge(),this.mUIManager.Purge(),this.mCameraLocation=$V([0,0]),this.mScene.emptyChildren(),this.mFPSText=null,this.SetupLayers(),this.mBackground=new CAAT.ActorContainer,this.mBackground.setBounds(0,0,this.mDirector.width,this.mDirector.height),this.mBackground.setFillStyle("#000"),this.AddCAATActorToScene(this.mBackground),this.mScreenManager.Initialize(this),this.CreateLayer("FPS");var e=this.GetImage("pause_button");if(e!=null&&e.width>0){var t=Math.max(e.width,e.height);this.mPauseButton=this.CreateUIEntity(TGE.ScreenEntity).Setup(this.Width()-t/2,t/2,"pause_button","ScreenManager"),this.EnableUserPause()}},SetupLayers:function(){this.mLayers={},this.CreateLayer("TGE_default"),this.subclassSetupLayers()},ShowScreen:function(e){return this.mScreenManager.ShowScreen(e)},GotoMainMenu:function(){this.mPaused=!1,this.mPlaying=!1,this.ClearScene(),typeof MainMenu!="undefined"?this.ShowScreen(MainMenu):this.StartPlaying()},PauseGame:function(e){if(!this.mPlaying||e==this.mPaused)return;this.mPaused=e,this.AnalyticGameEvent(this.mPaused?"pause":"resume",this.mCurrentLevel),this.DetermineCanvasPosition(),typeof PauseScreen!="undefined"&&(this.mPaused?(this.ShowScreen(PauseScreen,!1),this.DisableUserPause()):(this.mScreenManager.CloseScreen(PauseScreen),this.EnableUserPause()))},DisableUserPause:function(){this.mUserPauseEnabled=!1,this.mPauseButton!=null&&this.mPauseButton.Hide()},EnableUserPause:function(){this.mUserPauseEnabled=!0,this.mPauseButton!=null&&this.mPauseButton.Show()},Update:function(){var e=(this.mThisLoop=new Date)-this.mLastLoop;this.mFrameTime+=(e-this.mFrameTime)/this.mFilterStrength,this.mLastLoop=this.mThisLoop,this.updateFPSDisplay(),e/=1e3,e=Math.max(this.mMinTickTime,e),e=Math.min(this.mMaxTickTime,e),this.mPaused||(this.mGameTime+=e),this.mScreenManager.Update(e),this.mUIManager.NotifyObjectsOfMouseOver(this.mMouseX,this.mMouseY),this.mPaused||(this.mGameManager.NotifyObjectsOfMouseOver(this.mMouseX,this.mMouseY),this.updateObjects(e)),this.mPlaying&&!this.mPaused&&this.subclassUpdateGame(e),this.updateObjectsToScreen(),CAAT.renderFrame(),requestAnimFrame(TGE.Game.prototype.Update.bind(this))},SetConstantTickTime:function(e){this.mMinTickTime=this.mMaxTickTime=e},SetBackgroundColor:function(e){this.mBackground.setFillStyle(e)},AddImage:function(e,t){this.mDirector.addImage(e,t,!0)},CreateLayer:function(e){var t=new CAAT.ActorContainer;this.mLayers[e]=t,this.mScene.addChild(t)},CreateWorldEntity:function(e){var t=new e;return e.prototype.constructor.apply(t,[this]),this.mGameManager.AddObject(t),t},CreateUIEntity:function(e){var t=new e;return e.prototype.constructor.apply(t,[this]),this.mUIManager.AddObject(t),t},AddCAATActorToScene:function(e,t){t=typeof t!="undefined"?t:"TGE_default";var n=this.mScene;t!=null&&t in this.mLayers&&(n=this.mLayers[t]),n.addChild(e)},RemoveCAATActorFromScene:function(e,t){t=typeof t!="undefined"?t:"TGE_default";var n=this.mScene;t!=null&&t in this.mLayers&&(n=this.mLayers[t]),n.removeChild(e)},ShowFramerateDisplay:function(e,t,n,r){this.mFPSText!=null&&this.mFPSText.MarkForRemoval(),this.mFPSText=this.CreateUIEntity(TGE.Text).Setup(e,t,"",n.toString()+"px Arial","center","middle",r,"FPS")},updateFPSDisplay:function(){var e=this.mThisLoop-this.mLastDisplay;if(e<1e3)return;this.mLastDisplay=this.mThisLoop,this.mFrameTime>0&&this.mFPSText!=null&&(this.mFPSText.Show(),this.mFPSText.SetText(Math.round(1e3/this.mFrameTime).toFixed(0)+"fps"))},updateObjects:function(e){this.mGameManager.Update(e),this.mUIManager.Update(e)},updateObjectsToScreen:function(){this.mGameManager.UpdateObjectsToScreen(),this.mUIManager.UpdateObjectsToScreen()},EndGame:function(){if(!this.mPlaying)return;this.mPlaying=!1,this.DisableUserPause(),this.subclassEndGame(),typeof GameOver!="undefined"&&this.ShowScreen(GameOver)},CurrentLevel:function(){return this.mCurrentLevel},Click:function(e){this.mUIManager.NotifyObjectsOfClick(this.mMouseX*this.mScalingFactor,this.mMouseY*this.mScalingFactor)},MouseMove:function(e){this.mMouseX=e.pageX-this.mCanvasPosition.x,this.mMouseY=e.pageY-this.mCanvasPosition.y,this.mPaused||this.subclassMouseMove()},MouseDown:function(e){this.mMouseX=e.pageX-this.mCanvasPosition.x,this.mMouseY=e.pageY-this.mCanvasPosition.y,this.mMouseDown=!0;if(this.mUserPauseEnabled&&this.mPauseButton!=null){var t=Math.max(this.mPauseButton.Width(),this.mPauseButton.Height());if(this.mMouseX>this.Width()-t&&this.mMouseY<t){this.PauseGame(!0);return}}this.mUIManager.NotifyObjectsOfMouseDown(this.mMouseX*this.mScalingFactor,this.mMouseY*this.mScalingFactor),this.mPaused||(this.mGameManager.NotifyObjectsOfMouseDown(this.mMouseX*this.mScalingFactor,this.mMouseY*this.mScalingFactor),this.subclassMouseDown())},MouseUp:function(e){this.mMouseX=e.pageX-this.mCanvasPosition.x,this.mMouseY=e.pageY-this.mCanvasPosition.y,this.mMouseDown=!1,this.mUIManager.NotifyObjectsOfMouseUp(this.mMouseX*this.mScalingFactor,this.mMouseY*this.mScalingFactor),this.mPaused||(this.mGameManager.NotifyObjectsOfMouseUp(this.mMouseX*this.mScalingFactor,this.mMouseY*this.mScalingFactor),this.subclassMouseUp())},MouseX:function(){return this.mMouseX},MouseY:function(){return this.mMouseY},IsMouseDown:function(){return this.mMouseDown},KeyDown:function(e){this.mKeysDown[e.keyCode]=!0},KeyUp:function(e){this.mKeysDown[e.keyCode]=!1},IsKeyDown:function(e){return this.mKeysDown[e]},Width:function(){return this.mDirector.width},Height:function(){return this.mDirector.height},GameTime:function(){return this.mGameTime},NumGameObjects:function(){return this.mGameManager.NumObjects()},NumUIObjects:function(){return this.mUIManager.NumObjects()},CameraLocation:function(){return this.mCameraLocation},ScreenX:function(e){return this.mDirector.width/2+(e-this.mCameraLocation.e(1))},ScreenY:function(e){return this.mDirector.height/2-(e-this.mCameraLocation.e(2))},GetImage:function(e){return this.mDirector.getImage(e)},OpenURL:function(e){this.AnalyticClickThruEvent(e),window.open(e,this.mDefaultLinkTarget)},PlayGame:function(){this.AnalyticGameEvent("begin"),this.subclassPlayGame()},CurrentScore:function(){return 0},subclassSetupLayers:function(){},subclassPlayGame:function(){this.StartLevel(-1)},subclassSetupLevel:function(e){},subclassStartPlaying:function(){},subclassStartLevel:function(){},subclassFinishLevel:function(){},subclassUpdateGame:function(e){},subclassEndGame:function(e){},subclassMouseMove:function(){},subclassMouseDown:function(){},subclassMouseUp:function(){},AnalyticGameEvent:function(e,t){this.mAnalytics!=null&&this.mAnalytics.LogGameEvent(e,this.mCurrentLevel,t)},AnalyticShareEvent:function(e){this.mAnalytics!=null&&this.mAnalytics.LogShareEvent(e,this.mCurrentLevel)},AnalyticLevelEvent:function(e){this.mAnalytics!=null&&this.mAnalytics.LogLevelEvent(e,this.mCurrentLevel,this.mGameTime)},AnalyticAchievementEvent:function(e,t){this.mAnalytics!=null&&this.mAnalytics.LogAchievementEvent(e,this.mCurrentLevel,t)},AnalyticClickThruEvent:function(e){this.mAnalytics!=null&&this.mAnalytics.LogClickThruEvent(e,this.mCurrentLevel)},AnalyticCustomEvent:function(e,t,n){this.mAnalytics!=null&&this.mAnalytics.LogCustomEvent(e,this.mCurrentLevel,n)}},TGE.ObjectsManager=function(){this.mObjectsArray=[]},TGE.ObjectsManager.prototype={AddObject:function(e){this.mObjectsArray.push(e)},Update:function(e){for(var t=this.mObjectsArray.length-1;t>=0;t--)this.mObjectsArray[t].Update(e),this.mObjectsArray[t].MarkedForRemoval()&&(this.mObjectsArray[t].Cleanup(),this.mObjectsArray.splice(t,1))},UpdateObjectsToScreen:function(){for(var e=0;e<this.mObjectsArray.length;e++)this.mObjectsArray[e].UpdateScreenPosition()},NotifyObjectsOfClick:function(e,t){for(var n=0;n<this.mObjectsArray.length;n++)if(this.mObjectsArray[n].Visible()){var r=this.mObjectsArray[n].ScreenPosition().e(1),i=this.mObjectsArray[n].ScreenPosition().e(2),s=this.mObjectsArray[n].Width(),o=this.mObjectsArray[n].Height();e>r&&e<r+s&&t>i&&t<i+o&&this.mObjectsArray[n].Click()}},NotifyObjectsOfMouseOver:function(e,t){for(var n=0;n<this.mObjectsArray.length;n++)if(this.mObjectsArray[n].Visible()){var r=this.mObjectsArray[n].ScreenPosition().e(1),i=this.mObjectsArray[n].ScreenPosition().e(2),s=this.mObjectsArray[n].Width(),o=this.mObjectsArray[n].Height();e>r&&e<r+s&&t>i&&t<i+o?(this.mObjectsArray[n].mMouseOver=!0,this.mObjectsArray[n].MouseOver()):this.mObjectsArray[n].mMouseOver&&(this.mObjectsArray[n].mMouseOver=!1,this.mObjectsArray[n].MouseLeave())}},NotifyObjectsOfMouseDown:function(e,t){for(var n=0;n<this.mObjectsArray.length;n++)if(this.mObjectsArray[n].Visible()){var r=this.mObjectsArray[n].ScreenPosition().e(1),i=this.mObjectsArray[n].ScreenPosition().e(2),s=this.mObjectsArray[n].Width(),o=this.mObjectsArray[n].Height();e>r&&e<r+s&&t>i&&t<i+o&&this.mObjectsArray[n].MouseDown()}},NotifyObjectsOfMouseUp:function(e,t){for(var n=0;n<this.mObjectsArray.length;n++)if(this.mObjectsArray[n].Visible()){var r=this.mObjectsArray[n].ScreenPosition().e(1),i=this.mObjectsArray[n].ScreenPosition().e(2),s=this.mObjectsArray[n].Width(),o=this.mObjectsArray[n].Height();e>r&&e<r+s&&t>i&&t<i+o&&this.mObjectsArray[n].MouseUp()}},Purge:function(){for(var e=this.mObjectsArray.length-1;e>=0;e--)this.mObjectsArray[e].Cleanup(),this.mObjectsArray.splice(e,1)},NumObjects:function(){return this.mObjectsArray.length}},TGE.AssetLoader=function(){return this.mAssetList,this.mUpdateCallback,this.mCompleteCallback,this},TGE.AssetLoader.prototype={LoadAssetList:function(e,t,n,r){this.mAssetList=t,this.mUpdateCallback=n,this.mCompleteCallback=r;var s=new PxLoader;if(t!=null&&t.loaded==0){for(i=0;i<t.list.length;i++)e.AddImage(t.list[i].id,s.addImage(t.list[i].url));s.addProgressListener(TGE.AssetLoader.prototype.loaderCallback.bind(this)),s.addCompletionListener(TGE.AssetLoader.prototype.completeCallback.bind(this)),s.start()}else this.mUpdateCallback!=null&&this.mUpdateCallback(1),this.mCompleteCallback!=null&&this.mCompleteCallback.call()},loaderCallback:function(e){e.error&&console.log("***** ERROR: could not load image '"+e.resource.getName()+"'");if(this.mUpdateCallback!=null){var t=e.completedCount/e.totalCount;this.mUpdateCallback(t)}},completeCallback:function(){this.mAssetList!=null&&(this.mAssetList.loaded=!0,this.mAssetList=null),this.mCompleteCallback!=null&&this.mCompleteCallback()}},TGE.SpriteAnimation=function(e,t,n,r,i,s){this.mFPS=i,this.mNumberOfFrames=r,this.mLooping=s,this.mAge=0,this.mPaused=!1,this.mFinishedCallback=null,this.mFrameOffset=0,this.mCurrentFrame=0,this.mCompoundImage=(new CAAT.CompoundImage).initialize(e,t,n)},TGE.SpriteAnimation.prototype={Play:function(e){this.mAge=0,this.mFinishedCallback=e},Pause:function(){this.mPaused=!0},Resume:function(){this.mPaused=!1},SetAnimationIndexOffset:function(e){this.mFrameOffset=e},Update:function(e){this.mPaused||(this.mAge+=e);var t=1/this.mFPS,n=Math.floor(this.mAge/t);this.mCurrentFrame=0,this.mLooping||n<this.mNumberOfFrames?this.mCurrentFrame=n%this.mNumberOfFrames:(this.mCurrentFrame=this.mNumberOfFrames-1,this.mFinishedCallback!=null&&(this.mFinishedCallback.call(),this.mFinishedCallback=null)),this.mCurrentFrame+=this.mFrameOffset}},TGE.ScreenEntity=function(e){this.mGame=e,this.mLayer,this.mCAATContainer,this.mCameraCulling,this.mPosition=$V([0,0]),this.mScreenPosition=$V([0,0]),this.mVisible=!0,this.mAge=0,this.mMarkedForRemoval=!1,this.mLockXPosition=!1,this.mAnimations={},this.mMouseOver=!1,this.mScaleX=1,this.mScaleY=1},TGE.ScreenEntity.prototype={Setup:function(e,t,n,r){this.mPosition=$V([e,t]),this.mLayer=r;var i=this.mGame.GetImage(n);return i==null?this:(this.CreateCAATContainer(CAAT.SpriteActor),this.SetImage(n),this)},SetImage:function(e,t,n){var r=this.mGame.GetImage(e);if(r==null)return;this.mCAATContainer==null&&this.CreateCAATContainer(CAAT.SpriteActor),t=typeof t!="undefined"?t:1,n=typeof n!="undefined"?n:1;var i=new CAAT.CompoundImage;i.initialize(r,t,n),this.mCAATContainer.setSpriteImage(i)},SetImageIndex:function(e){this.mCAATContainer.setSpriteIndex(e)},LoadAnimation:function(e,t,n,r,i,s,o){var u=new TGE.SpriteAnimation(this.mGame.GetImage(t),n,r,i,s,o);this.mAnimations[e]=u},PlayAnimation:function(e,t){if(this.mCurrentAnimation==this.mAnimations[e])return;this.PlayAnimationFromStart(e,t)},PlayAnimationFromStart:function(e,t){this.mCAATContainer==null&&this.CreateCAATContainer(CAAT.SpriteActor);var n=this.mAnimations[e];n!=null&&(this.mCurrentAnimation=n,this.mCAATContainer.setSpriteImage(this.mCurrentAnimation.mCompoundImage),this.mCAATContainer.setSpriteIndex(0),this.mCurrentAnimation.Play(t),this.UpdateScreenPosition())},Show:function(){this.mVisible=!0,this.mCAATContainer!=null&&(this.mCAATContainer.visible=!0)},Hide:function(){this.mVisible=!1,this.mCAATContainer!=null&&(this.mCAATContainer.visible=!1)},Visible:function(){return this.mVisible},Click:function(){},MouseOver:function(){},MouseLeave:function(){},MouseDown:function(){},MouseUp:function(){},SetPosition:function(e,t){this.mPosition=$V([e,t])},Position:function(){return this.mPosition},ScreenPosition:function(){return this.mScreenPosition},SetRotation:function(e,t,n){this.mCAATContainer!=null&&(t==null||n==null?this.mCAATContainer.setRotation(e):this.mCAATContainer.setRotationAnchored(e,t,n))},SetScale:function(e,t){var n=t==null?e:t;this.mScaleX=e,this.mScaleY=n,this.mCAATContainer!=null&&this.mCAATContainer.setScale(e,n)},SetAlpha:function(e){this.mCAATContainer!=null&&(this.mCAATContainer.alpha=e)},Age:function(){return this.mAge},Update:function(e){this.mAge+=e,this.subclassUpdate(e),this.ShouldBeRemoved()&&this.MarkForRemoval(),this.mCurrentAnimation!=null&&(this.mCurrentAnimation.Update(e),this.mCAATContainer.setSpriteIndex(this.mCurrentAnimation.mCurrentFrame))},Width:function(){var e=this.mCAATContainer!=null?this.mCAATContainer.width:0;return e*this.mScaleX},Height:function(){var e=this.mCAATContainer!=null?this.mCAATContainer.height:0;return e*this.mScaleY},UpdateScreenPosition:function(){if(this.mGame!=null&&this.mCAATContainer!=null){var e=this.Width()/this.mScaleX/2,t=this.Height()/this.mScaleY/2,n=this.mPosition.e(1)-e,r=this.mPosition.e(2)-t;this.setScreenPosition(n,r)}},setScreenPosition:function(e,t){this.mScreenPosition=$V([e,t]),this.mCAATContainer.setLocation(e,t)},Cleanup:function(){this.mCAATContainer!=null&&this.mGame.RemoveCAATActorFromScene(this.mCAATContainer,this.mLayer),this.subclassCleanup()},MarkForRemoval:function(){this.mMarkedForRemoval=!0},MarkedForRemoval:function(){return this.mMarkedForRemoval},ShouldBeRemoved:function(){if(this.mCameraCulling!=null){var e=this.mPosition.e(1),t=this.mPosition.e(2),n=this.Width()/2,r=this.Height()/2;if(this.mCameraCulling[0]&&this.mGame.ScreenY(t-r)<0)return!0;if(this.mCameraCulling[1]&&this.mGame.ScreenX(e-n)>this.mGame.Width())return!0;if(this.mCameraCulling[2]&&this.mGame.ScreenY(t+r)>this.mGame.Height())return!0;if(this.mCameraCulling[3]&&this.mGame.ScreenX(e+n)<0)return!0}return this.subclassShouldBeRemoved()},CreateCAATContainer:function(e){this.mCAATContainer!=null&&this.mGame.RemoveCAATActorFromScene(this.mCAATContainer,this.mLayer),this.mCAATContainer=new e,e.prototype.constructor.apply(this.mCAATContainer,[this]),this.mGame.AddCAATActorToScene(this.mCAATContainer,this.mLayer)},subclassUpdate:function(e){},subclassShouldBeRemoved:function(){return!1},subclassCleanup:function(){}},TGE.Button=function(e){TGE.ScreenEntity.call(this,e),this.mState="idle",this.mMouseOver=!1,this.mMouseDown=!1,this.mPressFunction},TGE.Button.prototype={Setup:function(e,t,n,r,i,s){return this.mNumStates=i,TGE.ScreenEntity.prototype.Setup.call(this,e,t,null,s),this.SetImage(n,1,i),this.mPressFunction=r,this.setButtonState("idle"),this},Click:function(){if(!this.mMouseDown)return;this.mPressFunction!=null&&this.mPressFunction.call(this)},MouseOver:function(){this.mMouseOver=!0},MouseDown:function(){this.mMouseDown=!0},MouseUp:function(){},subclassUpdate:function(e){this.mMouseDown=this.mMouseDown&&this.mGame.IsMouseDown(),this.mMouseOver?this.setButtonState(this.mMouseDown?"down":"hover"):this.setButtonState("idle"),this.mMouseOver=!1},setButtonState:function(e){if(e==this.mState)return;this.mState=e;var t=0;switch(this.mState){case"disable":t=3;break;case"down":t=2;break;case"hover":t=1;break;case"idle":default:t=0}t<this.mNumStates&&this.SetImageIndex(t)}},extend(TGE.Button,TGE.ScreenEntity,null),TGE.Text=function(e){TGE.ScreenEntity.call(this,e),this.mTextActor},TGE.Text.prototype={Setup:function(e,t,n,r,i,s,o,u){return TGE.ScreenEntity.prototype.Setup.call(this,e,t,null,u),this.mHorizontalAlignment=i,this.mVerticalAlignment=s,this.CreateCAATContainer(CAAT.ActorContainer),this.mTextActor=new CAAT.TextActor,this.mCAATContainer.addChild(this.mTextActor),this.mTextActor.setFont(r).setTextAlign("left").setTextBaseline("top").setText(n).setFillStyle(o),this.UpdateScreenPosition(),this},SetText:function(e,t){if(this.mTextActor==null)return;this.mTextActor.setText(e),t!=null&&this.mTextActor.setFillStyle(t)},UpdateScreenPosition:function(){if(this.mCAATContainer!=null){var e,t,n=this.Width(),r=this.Height();switch(this.mHorizontalAlignment){case"left":e=this.mPosition.e(1);break;case"right":e=this.mPosition.e(1)-n;break;case"center":default:e=this.mPosition.e(1)-n/2}switch(this.mVerticalAlignment){case"top":t=this.mPosition.e(2);break;case"bottom":t=this.mPosition.e(2)-r;break;case"middle":default:t=this.mPosition.e(2)-r/2}this.setScreenPosition(e,t)}},Width:function(){return this.mTextActor.textWidth*this.mScaleX},Height:function(){return 30}},extend(TGE.Text,TGE.ScreenEntity,null),TGE.GameWorldEntity=function(e){TGE.ScreenEntity.call(this,e)},TGE.GameWorldEntity.prototype={CullToCamera:function(e,t,n,r){this.mCameraCulling=[e,t,n,r]},UpdateScreenPosition:function(){if(this.mCAATContainer!=null){var e=this.Width()/this.mScaleX/2,t=this.Height()/this.mScaleY/2,n=this.mPosition.e(1)-e,r=this.mPosition.e(2)+t;n=this.mLockXPosition?n:this.mGame.ScreenX(n),r=this.mGame.ScreenY(r),this.setScreenPosition(n,r)}},SetPosition:function(e,t){this.mPosition=$V([e,t])},Position:function(){return this.mPosition},LockXPosition:function(){this.mLockXPosition=!0}},extend(TGE.GameWorldEntity,TGE.ScreenEntity,null),TGE.Screen=function(e){this.mScreenManager=e,this.mBackground=null,this.mUIElements=new Array,this.mFrameCount=0,this.mDestroyed=!1},TGE.Screen.prototype={Setup:function(){},Close:function(){this.mScreenManager.CloseScreen(this.constructor)},Game:function(){return this.mScreenManager.Game()},CreateUIEntity:function(e){var t=this.mScreenManager.CreateUIEntity(e);return this.mUIElements.push(t),t},DisplayNumber:function(e,t,n,r,s,o,u,a){var f=e.toString(),l=24,c=2,h=f.length*s;if(u){var p=Math.floor((f.length-1)/3);h+=p*l,h-=p*c}var d=o=="center"?t+h/2+s/2:t+h;d-=s;var v=n,m=0;for(i=f.length-1;i>=0;i--){u&&m==3&&(d+=c,this.CreateUIEntity(TGE.ScreenEntity).Setup(d,v,"big_digits_comma",a),d-=l,m=0);var g=this.CreateUIEntity(TGE.ScreenEntity).Setup(d,v,null,a);g.SetImage(r,1,10),g.SetImageIndex(f.charCodeAt(i)-48),d-=s,m++}},FillBackground:function(e){this.mBackground=new CAAT.ActorContainer,this.mBackground.setBounds(0,0,this.mScreenManager.Game().Width(),this.mScreenManager.Game().Height()),this.mBackground.setFillStyle(e),this.mScreenManager.Game().AddCAATActorToScene(this.mBackground,this.mScreenManager.mLayerName)},Finalize:function(){this.HideAll();for(var e=0;e<this.mUIElements.length;e++)this.mUIElements[e].UpdateScreenPosition()},ShowAll:function(){for(var e=0;e<this.mUIElements.length;e++)this.mUIElements[e].Show()},HideAll:function(){for(var e=0;e<this.mUIElements.length;e++)this.mUIElements[e].Hide()},Update:function(e){this.mFrameCount++,this.mFrameCount==5&&this.ShowAll()},Destroy:function(){this.mBackground!=null&&this.mScreenManager.Game().RemoveCAATActorFromScene(this.mBackground,this.mScreenManager.mLayerName);for(var e=0;e<this.mUIElements.length;e++)this.mUIElements[e].MarkForRemoval();this.mDestroyed=!0}},TGE.ScreenManager=function(e){this.mGame=e,this.mLayerName="ScreenManager",this.mScreens=new Array,this.mBlackout=null,this.mBlackoutAlpha=1},TGE.ScreenManager.prototype={Initialize:function(e){for(var t in this.mScreens)this.mScreens[t]!=null&&(this.mScreens[t].Destroy(),this.mScreens[t]=null);e.CreateLayer(this.mLayerName),e.CreateLayer("Fade"),this.mBlackout=e.CreateUIEntity(TGE.ScreenEntity).Setup(e.Width()/2,e.Height()/2,"screen_fade","Fade"),this.mBlackout.SetScale(8)},CreateUIEntity:function(e){return this.mGame.CreateUIEntity(e)},ShowScreen:function(e,t){var n=new e;return e.prototype.constructor.apply(n,[this]),this.mScreens[e.name]=n,n.Setup(),n.Finalize(),t!=0&&this.ResetFade(),n},CloseScreen:function(e){var t=this.mScreens[e.name];if(t==null)return;t.Destroy(),this.mScreens[e]=null},ResetFade:function(){this.mBlackoutAlpha=1,this.mBlackout.SetAlpha(1),this.mBlackout.Show()},Update:function(e){this.mBlackoutAlpha-=e*3,this.mBlackoutAlpha<=0&&(this.mBlackoutAlpha=0,this.mBlackout.Hide()),this.mBlackout.SetAlpha(this.mBlackoutAlpha);for(var t in this.mScreens)this.mScreens[t]!=null&&this.mScreens[t].Update(e)},Game:function(){return this.mGame},XFromPercentage:function(e){return this.mGame.Width()*e},YFromPercentage:function(e){return this.mGame.Height()*e},FixedDistanceFromTop:function(e){return e},FixedDistanceFromBottom:function(e){return this.mGame.Height()-e},FixedDistanceFromLeft:function(e){return e},FixedDistanceFromRight:function(e){return this.mGame.Width()-e}},TGE.Analytics=function(e){return this.mGameName=e,this},TGE.Analytics.prototype={LogGameEvent:function(e,t,n){var r=this.mGameName;(e=="pause"||e=="resume")&&t!=null&&t>0&&(r+=" - level "+t.toString());var i="ANALYTIC EVENT: game, "+e+", "+r;e=="load"&&(i+=", "+n.toString()),window.console.log(i)},LogShareEvent:function(e,t){var n=this.mGameName;t!=null&&t>0&&(n+=" - level "+t.toString());var r="ANALYTIC EVENT: share, "+e+", "+n;window.console.log(r)},LogLevelEvent:function(e,t,n){var r=this.mGameName;t!=null&&t>0&&(r+=" - level "+t.toString());var i="ANALYTIC EVENT: level, "+e+", "+r;(e=="complete"||e=="fail")&&n!=null&&(i+=", "+n.toString()),window.console.log(i)},LogAchievementEvent:function(e,t,n){var r=this.mGameName;t!=null&&t>0&&(r+=" - level "+t.toString());var i="ANALYTIC EVENT: achievement, "+e+", "+r;n!=null&&(i+=", "+n.toString()),window.console.log(i)},LogClickThruEvent:function(e,t){var n=this.mGameName;t!=null&&t>0&&(n+=" - level "+t.toString());var r="ANALYTIC EVENT: clickthru, "+e+", "+n;window.console.log(r)},LogCustomEvent:function(e,t,n){var r=this.mGameName;t!=null&&t>0&&(r+=" - level "+t.toString());var i="ANALYTIC EVENT: custom, "+e+", "+r;n!=null&&(i+=", "+n.toString()),window.console.log(i)}},TGE.GoogleAnalytics=function(e){return TGE.GoogleAnalytics.superclass.constructor.call(this,e),this},TGE.GoogleAnalytics.prototype={LogGameEvent:function(e,t,n){try{var r=this.mGameName;if(e=="pause"||e=="resume"&&t!=null&&t>0)r+=" - level "+t.toString();var i="game",s=e,o=r,u=n;_gaq.push(["_trackEvent",i,s,o,u])}catch(a){console.log("GoogleAnalytics game event error: "+a.toString())}},LogShareEvent:function(e,t){try{var n=this.mGameName;t!=null&&t>0&&(n+=" - level "+t.toString());var r="share",i=e,s=n,o=null;_gaq.push(["_trackEvent",r,i,s,o])}catch(u){console.log("GoogleAnalytics share event error: "+u.toString())}},LogLevelEvent:function(e,t,n){try{var r=this.mGameName;t!=null&&t>0&&(r+=" - level "+t.toString());var i="level",s=e,o=r,u;if(e=="complete"||e=="fail"&&n!=null)u=n;_gaq.push(["_trackEvent",i,s,o,u])}catch(a){console.log("GoogleAnalytics level event error: "+a.toString())}},LogAchievementEvent:function(e,t,n){try{var r=this.mGameName;t!=null&&t>0&&(r+=" - level "+t.toString());var i="achievement",s=e,o=r,u=n;_gaq.push(["_trackEvent",i,s,o,u])}catch(a){console.log("GoogleAnalytics achievement event error: "+a.toString())}},LogClickThruEvent:function(e,t){try{var n=this.mGameName;t!=null&&t>0&&(n+=" - level "+t.toString());var r="clickthru",i=e,s=n,o=null;_gaq.push(["_trackEvent",r,i,s,o])}catch(u){console.log("GoogleAnalytics clickthru event error: "+u.toString())}},LogCustomEvent:function(e,t,n){try{var r=this.mGameName;t!=null&&t>0&&(r+=" - level "+t.toString());var i="custom",s=e,o=r,u=n;_gaq.push(["_trackEvent",i,s,o,u])}catch(a){console.log("GoogleAnalytics custom event error: "+a.toString())}}},extend(TGE.GoogleAnalytics,TGE.Analytics,null),TGE.ParallaxPane=function(e){TGE.GameWorldEntity.call(this,e),this.mTrackingSpeed=1,this.mPane1=null,this.mPane2=null,this.mHorizontalOffset=0},TGE.ParallaxPane.prototype={Setup:function(e,t,n,r){return TGE.GameWorldEntity.prototype.Setup.call(this,0,e,null,r),this.CreateCAATContainer(CAAT.ActorContainer),this.mTrackingSpeed=t,this.mPane1=(new CAAT.ActorContainer).setBackgroundImage(this.mGame.GetImage(n),!0),this.mCAATContainer.addChild(this.mPane1),this.mPane1.setLocation(0,0),this.mPane2=(new CAAT.ActorContainer).setBackgroundImage(this.mGame.GetImage(n),!0),this.mCAATContainer.addChild(this.mPane2),this.mPane2.setLocation(this.mGame.Width(),0),this},SetHorizontalOffset:function(e){this.mHorizontalOffset=e},UpdateScreenPosition:function(){if(this.mPane1!=null&&this.mPane2!=null){var e=this.mGame.CameraLocation().e(1),t=(-e+this.mHorizontalOffset)*this.mTrackingSpeed/this.mScaleX,n=this.mGame.Width()/this.mScaleX;this.mPane1.setLocation(t%n,this.mGame.ScreenY(this.mPosition.e(2))),this.mPane2.setLocation(this.mPane1.x+n,this.mGame.ScreenY(this.mPosition.e(2)))}}},extend(TGE.ParallaxPane,TGE.GameWorldEntity,null),TGE.BrowserDetect=function(){return this.init(),this},TGE.BrowserDetect.prototype={browser:"",version:0,OSOrDevices:"",OSversion:0,detectOSversion:function(e){var t="-1",n="",r=navigator.userAgent.toString();switch(e){case"Windows Phone":n=/Windows Phone OS\s+[\d\.]+/,t=String(r.match(n)).substring(17,20);break;case"iPhone":case"iPad":n=/OS\s+[\d\_]+/,t=String(r.match(n)).substring(3,6);break;case"Windows":n=/Windows NT\s+[\d\.]+/,String(r.match(n)).substring(11,14)=="6.1"?t="7":String(r.match(n)).substring(11,14)=="5.1"?t="XP":String(r.match(n)).substring(11,14)=="5.2"?t="XP":String(r.match(n)).substring(11,14)=="6.0"?t="Vista":String(r.match(n)).substring(11,15)=="5.01"?t="2000 SP1":String(r.match(n)).substring(11,14)=="5.0"&&(t="2000");break;case"Mac":n=/Mac OS X\s+[\d\_]+/,t=String(r.match(n)).substring(9,13);break;case"Android":n=/ndroid\s+[\d\.]+/,t=String(r.match(n)).substring(7,10)}return t},init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OSOrDevices=this.searchString(this.dataOSOrDevices)||"an unknown OS or Device",this.OSversion=this.detectOSversion(this.OSOrDevices)},searchString:function(e){for(var t=0;t<e.length;t++)if(e[t]!=null){var n=e[t].string,r=e[t].prop;this.versionSearchString=e[t].versionSearch||e[t].identity;if(n){if(n.indexOf(e[t].subString)!==-1)return e[t].identity}else if(r)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(t===-1)return;return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Explorer",identity:"Explorer",versionSearch:"Explorer"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{prop:window.opera,identity:"Opera"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.vendor,subString:"BlackBerry",identity:"BlackBerry"}],dataOSOrDevices:[{string:navigator.platform,subString:"Windows Phone",identity:"Windows Phone"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"iPod",identity:"iPod"},{string:navigator.userAgent,subString:"Android",identity:"Android"},,{string:navigator.userAgent,subString:"webOS",identity:"webOS"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},function(){TGE.PlatformCompatibility=function(){return this},TGE.PlatformCompatibility.prototype={isAudioSupported:function(){var e=document.createElement("audio"),t=!1;try{if(t=!!e.canPlayType)t=new Boolean(t),t.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),t.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),t.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),t.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(n){}return t},isAudioFormatSupported:function(e){var t=document.createElement("audio"),n=!1,r;try{if(n=!!t.canPlayType){n=new Boolean(n);switch(e){case"ogg":r=t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"");break;case"mp3":r=t.canPlayType("audio/mpeg;").replace(/^no$/,"");break;case"wav":r=t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"");break;case"m4a":r=(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,"");break;default:}}}catch(i){}return r},isCanvasSupported:function(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},isVideoSupported:function(){var e=document.createElement("video"),t=!1;try{if(t=!!e.canPlayType)t=new Boolean(t),t.ogg=e.canPlayType('video/ogg; codecs="theora"'),t.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"'),t.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"')}catch(n){}return t},isDragAndDropSupported:function(){var e=document.createElement("div");return bool="draggable"in e||"ondragstart"in e&&"ondrop"in e,bool},isGeolocationSupported:function(){return!!navigator.geolocation},isWebGlSupported:function(){try{var e=document.createElement("canvas"),t;t=!(!window.WebGLRenderingContext||!e.getContext("experimental-webgl")&&!e.getContext("webgl")),e=undefined}catch(n){t=!1}return t},isHistorySupported:function(){return!!window.history&&!!history.pushState},isVideoSupported:function(){var e=document.createElement("video"),t=!1},isLocalStorageSupported:function(){try{return localStorage.setItem(mod,mod),localStorage.removeItem(mod),!0}catch(e){return!1}},isSessionStorageSupported:function(){try{return sessionStorage.setItem(mod,mod),sessionStorage.removeItem(mod),!0}catch(e){return!1}},isSVGSupported:function(){return ns={svg:"http://www.w3.org/2000/svg"},!!document.createElementNS&&!!document.createElementNS(ns.svg,"svg").createSVGRect}}}(),function(){TGE.DeviceOrientation=function(){return this},TGE.DeviceOrientation.prototype={orientationChangeCallBack:null,RegisterOrientationChange:function(e){TGE.DeviceOrientation.prototype.orientationChangeCallBack=e,window.addEventListener("orientationchange",TGE.DeviceOrientation.prototype.internalOrientationChanged),TGE.DeviceOrientation.prototype.internalOrientationChanged()},internalOrientationChanged:function(){window.orientation==0||window.orientation==180?TGE.DeviceOrientation.prototype.orientationChangeCallBack("portrait"):TGE.DeviceOrientation.prototype.orientationChangeCallBack("landscape")}}}();function LoadingScreen(e){return TGE.Screen.call(this,e),this.mLoadingText=null,this}function MainMenu(e){return TGE.Screen.call(this,e),this}function GameOver(e){return TGE.Screen.call(this,e),this}function PauseScreen(e){return TGE.Screen.call(this,e),this}function TransitionScreen(e){return TGE.Screen.call(this,e),this.mRocketCat=null,this.mBobTimer=0,this.mBaseY=0,this.mBobAmplitude=8,this.mBobFrequency=5,this.mLoadingText=null,this}function Player(e){TGE.GameWorldEntity.call(this,e),this.mStopped=!1,this.mTrotting=!1,this.mBaseHorizontalSpeed=.65,this.mHorizontalSpeed=0,this.mVerticalSpeed=0,this.mInvincibilityTimer=0,this.mHasShield=!1,this.mThruster=null,this.mThrusterAlpha=0,this.mHelmet=null,this.mBundleGlow=null}function StationaryObstacle(e){return TGE.GameWorldEntity.call(this,e),this.mType=1,this.mTriggered=!1,this.mRadius=0,this.mRadiusYOffset=0,this}function MovingObstacle(e){return TGE.GameWorldEntity.call(this,e),this.mType="A",this.mBaseY=0,this.mBobAmplitude=0,this.mBobFrequency=0,this.mRotationSpeed=0,this.mRotation=0,this.mTriggered=!1,this}function Coin(e){return TGE.GameWorldEntity.call(this,e),this.mPickedUp=!1,this.mLarge=!1,this}function FloHelmet(e){return TGE.GameWorldEntity.call(this,e),this.mTriggered=!1,this.mHelmet=null,this.mHelmetX=0,this.mHelmetY=0,this.mBaseY=0,this.mBobAmplitude=0,this.mBobFrequency=0,this}function BundlePowerup(e){return TGE.GameWorldEntity.call(this,e),this.mPart=0,this}function Bundler(e){return TGE.GameWorldEntity.call(this,e),this.mTriggered=!1,this.mBaseY=0,this.mBobAmplitude=0,this.mBobFrequency=0,this.mBackgroundOffsetX=8,this.mBackgroundOffsetY=48,this.mBackgroundEmpty=null,this.mBackgroundSwirl=null,this}function RocketCatGame(){TGE.Game.call(this),this.mAnalytics=new TGE.GoogleAnalytics("Rocket Cat Adventures"),this.AssignImageAssetList("loading",gLoadingScreenImages),this.AssignImageAssetList("required",gCoreGameImages),this.AssignImageAssetList("level_2",gLevel2Images),this.AssignImageAssetList("level_3",gLevel3Images),this.mPauseButtonSize=100,this.mFreezeGameplay=!1,this.mLastStationaryObstacle=0,this.mLastCoin=0,this.mTransitionTimer=0,this.mDistance=0,this.mCoins=0,this.mBundlerScore=0,this.mBundlesScore=0,this.mHelmetScore=0,this.mPlayer=null,this.mBestScore=-1,this.mDistanceDigitIcons=new Array,this.mCoinsDigitIcons=new Array,this.mModalImage=null,this.mPauseButton=null,this.mAchievementPopup=null,this.mAchievementMessage=null,this.mAchievementPopupTimer=0,this.mNextAchievementDistance=100,this.mStartMessage=null,this.mStartMessageDigits=null,this.mStartMessageTimer=0,this.mEndCardLoadTimer=0,this.mEndCardName="",this.mLevelEvents={},this.mLastLevelEventTimer=0,this.mCurrentLevelEventIndex=0,this.mGotBundlePart1=!1,this.mBundleBonusTimer=0,this.mBundlerBoostTimer=0,this.mCurrentLevelAssetsLoaded=!0,this.mCoinFrequency=0,this.mCoinY=0,this.mCoinWaveAmplitude=0,this.mCoinWaveFrequency=0,this.mCoinRandomRange=0,this.mCoinWaveTimer=0,this.mNumStationaryObstacleTypes=0,this.mNumMovingObstacleTypes=0,this.mStationaryObstacleFrequency=0,this.mStationaryObstaclePattern="random",this.mStationaryObstaclePatternIndex=0}var level1=[{rocket_cat_speed:.6},{begin_card:"Just coin stuff"},{time:1,event:"coin_frequency",value:0},{time:4,event:"coin_frequency",value:150},{time:9,event:"coin_frequency",value:0},{time:10,event:"coin_frequency",value:150},{time:10,event:"coin_y",value:.75},{time:13,event:"coin_frequency",value:0},{time:14,event:"coin_frequency",value:150},{time:14,event:"coin_y",value:.25},{time:17,event:"coin_frequency",value:0},{time:18,event:"coin_frequency",value:150},{time:18,event:"coin_y",value:.5},{time:18,event:"coin_sinewave",frequency:4,amplitude:100},{time:25,event:"coin_frequency",value:0},{time:5,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"76823587X"},{time:0,event:"stationary_obstacle_frequency",value:950},{time:14,event:"end_card"},{begin_card:"Shapes!"},{time:0,event:"coin_frequency",value:0},{time:.5,event:"coin_shape",shape:"box",size:2},{time:1,event:"coin_shape",shape:"box",size:2},{time:1.5,event:"coin_shape",shape:"box",size:2},{time:2,event:"coin_shape",shape:"box",size:2},{time:2.5,event:"coin_shape",shape:"box",size:2},{time:3,event:"coin_shape",shape:"box",size:2},{time:3.5,event:"coin_shape",shape:"box",size:2},{time:4,event:"coin_shape",shape:"box",size:2},{time:5,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"78X"},{time:0,event:"stationary_obstacle_frequency",value:600},{time:2,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"87X"},{time:0,event:"stationary_obstacle_frequency",value:1},{time:.2,event:"end_card"},{begin_card:"Powerups"},{time:.1,event:"flo_helmet",height:.6},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"8B78BX"},{time:0,event:"stationary_obstacle_frequency",value:900},{time:10,event:"end_card"},{begin_card:"Powerups"},{time:.1,event:"flo_helmet",height:.6},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"8B8B7X"},{time:0,event:"stationary_obstacle_frequency",value:900},{time:8,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:.5,event:"end_card"},{begin_card:"Just coin stuff"},{time:0,event:"coin_sinewave",frequency:0,amplitude:0},{time:1,event:"coin_frequency",value:0},{time:2,event:"coin_frequency",value:150},{time:3,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:.01,event:"end_card"},{begin_card:"Powerups"},{time:0,event:"coin_powerup_bundle",part:1,height:.5},{time:0,event:"coin_sinewave",frequency:0,amplitude:0},{time:.01,event:"coin_frequency",value:150},{time:.01,event:"coin_y",value:.5},{time:2,event:"coin_powerup_bundle",part:2,height:.5},{time:10,event:"coin_frequency",value:0},{time:11,event:"end_card"},{begin_card:"Powerups"},{time:.5,event:"flo_helmet",height:.4},{begin_card:"Moving Obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"A7A7A7A7A7A7X"},{time:0,event:"stationary_obstacle_frequency",value:500},{time:10,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:2,event:"end_card"},{time:0,event:"bundler",height:.48},{time:.5,event:"coin_frequency",value:90},{time:.5,event:"coin_sinewave",frequency:0,amplitude:0},{time:1,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"387631X"},{time:0,event:"stationary_obstacle_frequency",value:700},{time:3,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:.5,event:"end_card"},{begin_card:"END"},{time:0,event:"level_finished"}],level2=[{rocket_cat_speed:3},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{rocket_cat_speed:.65},{begin_card:"Just coin stuff"},{time:.5,event:"coin_frequency",value:150},{time:1,event:"coin_y",value:.5},{time:3,event:"end_card"},{begin_card:"Shapes!"},{time:0,event:"coin_frequency",value:0},{time:.3,event:"coin_shape",shape:"box",size:1},{time:.4,event:"coin_shape",shape:"box",size:2},{time:.6,event:"coin_shape",shape:"box",size:3},{time:.9,event:"coin_shape",shape:"box",size:2},{time:1.1,event:"coin_shape",shape:"box",size:1},{time:1.3,event:"coin_shape",shape:"box",size:2},{time:1.5,event:"coin_shape",shape:"box",size:3},{time:1.7,event:"coin_shape",shape:"box",size:2},{time:1.9,event:"coin_shape",shape:"box",size:1},{time:2,event:"coin_shape",shape:"box",size:1},{time:2,event:"end_card"},{begin_card:"Powerups"},{time:.5,event:"flo_helmet",height:.5},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"2A5BD1X"},{time:0,event:"stationary_obstacle_frequency",value:650},{time:6,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Shapes!"},{time:0,event:"coin_frequency",value:0},{time:.5,event:"coin_shape",shape:"box",size:2},{time:1,event:"coin_shape",shape:"box",size:2},{time:1.5,event:"coin_shape",shape:"box",size:2},{time:2,event:"coin_shape",shape:"box",size:2},{time:2.5,event:"coin_shape",shape:"box",size:2},{time:3,event:"coin_shape",shape:"box",size:2},{time:3.5,event:"coin_shape",shape:"box",size:2},{time:4,event:"coin_shape",shape:"box",size:2},{time:4.7,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Powerups"},{time:.5,event:"flo_helmet",height:.5},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"1DS5DC2D53D4X"},{time:0,event:"stationary_obstacle_frequency",value:750},{time:16,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:.5,event:"end_card"},{begin_card:"Just coin stuff"},{time:0,event:"coin_sinewave",frequency:0,amplitude:0},{time:1,event:"coin_frequency",value:0},{time:2,event:"coin_frequency",value:150},{time:3,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:.01,event:"end_card"},{begin_card:"Powerups"},{time:0,event:"coin_powerup_bundle",part:1,height:.5},{time:0,event:"coin_sinewave",frequency:0,amplitude:0},{time:.01,event:"coin_frequency",value:150},{time:.01,event:"coin_y",value:.5},{time:2,event:"coin_powerup_bundle",part:2,height:.5},{time:2,event:"coin_sinewave",frequency:3.7,amplitude:-70},{time:10,event:"coin_frequency",value:0},{time:11,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Powerups"},{time:1,event:"flo_helmet",height:.5},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Moving Obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"C"},{time:0,event:"stationary_obstacle_frequency",value:950},{time:10,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Shapes!"},{time:0,event:"coin_frequency",value:0},{time:.5,event:"coin_shape",shape:"box",size:2},{time:1,event:"coin_shape",shape:"box",size:3},{time:1.5,event:"coin_shape",shape:"box",size:2},{time:2,event:"coin_shape",shape:"box",size:3},{time:2.5,event:"coin_shape",shape:"box",size:2},{time:3,event:"coin_shape",shape:"box",size:3},{time:3.5,event:"coin_shape",shape:"box",size:2},{time:4,event:"coin_shape",shape:"box",size:3},{time:5,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Powerups"},{time:1,event:"flo_helmet",height:.5},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:2,event:"end_card"},{begin_card:"Moving Obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"AB"},{time:0,event:"stationary_obstacle_frequency",value:70},{time:3,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{time:0,event:"bundler",height:.48},{time:.5,event:"coin_frequency",value:150},{time:.5,event:"coin_sinewave",frequency:0,amplitude:0},{time:1,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"A61616A616A61X"},{time:0,event:"stationary_obstacle_frequency",value:700},{time:4,event:"end_card"},{begin_card:"END"},{time:0,event:"level_finished"}],level3=[{rocket_cat_speed:3},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{rocket_cat_speed:.7},{begin_card:"Powerups"},{time:.5,event:"flo_helmet",height:.5},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Obstacles and Coins"},{time:0,event:"stationary_obstacle_frequency",value:0},{time:0,event:"coin_frequency",value:150},{time:0,event:"coin_sinewave",frequency:3,amplitude:-50},{time:8,event:"stationary_obstacle_pattern",value:"132"},{time:8,event:"stationary_obstacle_frequency",value:1300},{time:14.5,event:"coin_sinewave",amplitude:0},{time:14.5,event:"stationary_obstacle_frequency",value:0},{time:15,event:"stationary_obstacle_pattern",value:"13X"},{time:15,event:"stationary_obstacle_frequency",value:1},{time:16,event:"end_card"},{rocket_cat_speed:.75},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Shapes!"},{time:0,event:"coin_frequency",value:0},{time:.3,event:"coin_shape",shape:"box",size:1},{time:.4,event:"coin_shape",shape:"box",size:2},{time:.6,event:"coin_shape",shape:"box",size:2},{time:.9,event:"coin_shape",shape:"box",size:2},{time:1.1,event:"coin_shape",shape:"box",size:1},{time:1.3,event:"coin_shape",shape:"box",size:2},{time:1.5,event:"coin_shape",shape:"box",size:3},{time:1.7,event:"coin_shape",shape:"box",size:2},{time:1.9,event:"coin_shape",shape:"box",size:1},{time:2,event:"coin_shape",shape:"box",size:1},{time:2,event:"end_card"},{rocket_cat_speed:.8},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:.1,event:"end_card"},{time:0,event:"bundler",height:.48},{time:.5,event:"coin_frequency",value:90},{time:.5,event:"coin_sinewave",frequency:0,amplitude:0},{time:.5,event:"end_card"},{begin_card:"Just coin stuff"},{time:0,event:"coin_sinewave",frequency:0,amplitude:0},{time:1,event:"coin_frequency",value:0},{time:1,event:"coin_frequency",value:150},{time:3,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:.01,event:"end_card"},{begin_card:"Powerups"},{time:0,event:"coin_powerup_bundle",part:1,height:.5},{time:0,event:"coin_sinewave",frequency:0,amplitude:0},{time:.01,event:"coin_frequency",value:150},{time:.01,event:"coin_y",value:.5},{time:1,event:"coin_powerup_bundle",part:2,height:.5},{time:1,event:"coin_sinewave",frequency:0,amplitude:0},{time:8,event:"coin_frequency",value:0},{time:12,event:"end_card"},{rocket_cat_speed:.85},{begin_card:"Powerups"},{time:.5,event:"flo_helmet",height:.5},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"123EAB3DEBCA3EDAB3A"},{time:0,event:"stationary_obstacle_frequency",value:1e3},{time:20,event:"end_card"},{rocket_cat_speed:.9},{begin_card:"Powerups"},{time:.5,event:"flo_helmet",height:.5},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Shapes!"},{time:0,event:"coin_frequency",value:0},{time:1,event:"coin_shape",shape:"box",size:3},{time:2,event:"coin_shape",shape:"box",size:3},{time:3,event:"coin_shape",shape:"box",size:3},{time:4,event:"coin_shape",shape:"box",size:3},{time:5,event:"coin_shape",shape:"box",size:3},{time:6,event:"coin_shape",shape:"box",size:3},{time:7,event:"coin_shape",shape:"box",size:3},{time:8,event:"coin_shape",shape:"box",size:3},{time:9,event:"coin_shape",shape:"box",size:3},{time:10,event:"coin_shape",shape:"box",size:3},{time:11,event:"end_card"},{rocket_cat_speed:1},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"E"},{time:0,event:"stationary_obstacle_frequency",value:700},{time:10,event:"end_card"},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{rocket_cat_speed:1.5},{begin_card:"Powerups"},{time:.5,event:"flo_helmet",height:.5},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"E"},{time:0,event:"stationary_obstacle_frequency",value:500},{time:10,event:"end_card"},{rocket_cat_speed:2},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Powerups"},{time:.5,event:"flo_helmet",height:.5},{begin_card:"NOTHING"},{time:0,event:"nothing"},{time:1,event:"end_card"},{begin_card:"Obstacles and Coins"},{time:0,event:"stationary_obstacle_frequency",value:0},{time:0,event:"coin_frequency",value:80},{time:0,event:"coin_sinewave",frequency:3,amplitude:-50},{time:8,event:"stationary_obstacle_pattern",value:"1E3E2"},{time:8,event:"stationary_obstacle_frequency",value:1300},{time:14.5,event:"coin_sinewave",amplitude:0},{time:14.5,event:"stationary_obstacle_frequency",value:0},{time:15,event:"stationary_obstacle_pattern",value:"1E3X"},{time:15,event:"stationary_obstacle_frequency",value:1},{time:16,event:"end_card"},{rocket_cat_speed:2.5},{begin_card:"NOTHING"},{begin_card:"Just obstacles"},{time:0,event:"stationary_obstacle_pattern",value:"1BECAA3E3EEABDBCADAEB323EEABDBCA3EDAEB3EEAB3DEA"},{time:0,event:"stationary_obstacle_frequency",value:500},{time:999,event:"end_card"},{begin_card:"END"},{time:0,event:"level_finished"}];LoadingScreen.prototype=new TGE.Screen,LoadingScreen.prototype.constructor=LoadingScreen,LoadingScreen.prototype.Setup=function(){this.FillBackground("#FFF"),this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.3),"loading_title",this.mScreenManager.mLayerName),this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.7),"loading_rc",this.mScreenManager.mLayerName),this.mLoadingText=this.CreateUIEntity(TGE.Text).Setup(this.mScreenManager.XFromPercentage(.48),this.mScreenManager.YFromPercentage(.47),"LOADING 0%","bold italic 28px Arial","center","middle","#f28500",this.mScreenManager.mLayerName)},LoadingScreen.prototype.UpdateProgress=function(e){var t="LOADING "+Math.round(e*100).toString()+"%";this.mLoadingText.SetText(t)},MainMenu.prototype=new TGE.Screen,MainMenu.prototype.constructor=MainMenu,MainMenu.prototype.Setup=function(){this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.5),"mainmenu_background",this.mScreenManager.mLayerName),this.CreateUIEntity(TGE.Button).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.45),"mainmenu_full_title",MainMenu.prototype.playGame.bind(this),1,this.mScreenManager.mLayerName);var e=new TGE.BrowserDetect,t=e.OSOrDevices=="Windows"||e.OSOrDevices=="Mac";this.CreateUIEntity(TGE.Button).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.85),t?"mainmenu_play_browser":"mainmenu_play_mobile",MainMenu.prototype.playGame.bind(this),1,this.mScreenManager.mLayerName)},MainMenu.prototype.playGame=function(){var e=Math.random()+"",t=e*1e18,n="http://ad.doubleclick.net/ad/N4492.Progressive/B6021990.27;sz=1x1;ord="+t+"?",r=new PxLoader;r.addImage(n),r.start(),this.Game().PlayGame(),this.Close()},MainMenu.prototype.moreInfo=function(){this.Game().OpenURL("moreinfo.html")},MainMenu.prototype.openFloFacebook=function(){this.Game().OpenURL("http://www.facebook.com/flotheprogressivegirl")},MainMenu.prototype.openMeetRocketCat=function(){this.Game().OpenURL("video.html")},MainMenu.prototype.playLevel2=function(){this.Game().LoadLevelAssets(2,null,RocketCatGame.prototype.StartLevel.bind(this.Game(),2)),this.Close()},MainMenu.prototype.playLevel3=function(){this.Game().LoadLevelAssets(3,null,RocketCatGame.prototype.StartLevel.bind(this.Game(),3)),this.Close()},GameOver.prototype=new TGE.Screen,GameOver.prototype.constructor=GameOver,GameOver.prototype.Setup=function(){bTransitionScreen=!0,this.FillBackground("#e8f2fc"),this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.FixedDistanceFromLeft(280),this.mScreenManager.FixedDistanceFromTop(270),"gameover_left_panel_background",this.mScreenManager.mLayerName),this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.FixedDistanceFromRight(200),this.mScreenManager.FixedDistanceFromTop(270),"gameover_right_panel_background",this.mScreenManager.mLayerName),this.CreateUIEntity(TGE.Button).Setup(this.mScreenManager.FixedDistanceFromLeft(85),this.mScreenManager.FixedDistanceFromTop(40),"gameover_home",GameOver.prototype.goHome.bind(this),1,this.mScreenManager.mLayerName),this.CreateUIEntity(TGE.Button).Setup(this.mScreenManager.FixedDistanceFromRight(200),this.mScreenManager.FixedDistanceFromBottom(148),"gameover_play_again",GameOver.prototype.playAgain.bind(this),1,this.mScreenManager.mLayerName),this.DisplayNumber(this.mScreenManager.Game().CurrentScore(),this.mScreenManager.FixedDistanceFromRight(206),this.mScreenManager.FixedDistanceFromTop(105),"big_digits",38,"center",!0,this.mScreenManager.mLayerName),this.DisplayNumber(this.mScreenManager.Game().GetDistance(),this.mScreenManager.FixedDistanceFromRight(297),this.mScreenManager.FixedDistanceFromTop(193),"digits",17,"left",!1,this.mScreenManager.mLayerName),this.DisplayNumber(this.mScreenManager.Game().GetCoins(),this.mScreenManager.FixedDistanceFromRight(103),this.mScreenManager.FixedDistanceFromTop(193),"digits_gold",17,"left",!1,this.mScreenManager.mLayerName),this.DisplayNumber(this.mScreenManager.Game().GetBundlerScore(),this.mScreenManager.FixedDistanceFromRight(302),this.mScreenManager.FixedDistanceFromTop(281),"digits",17,"left",!1,this.mScreenManager.mLayerName),this.DisplayNumber(this.mScreenManager.Game().GetBundlesScore(),this.mScreenManager.FixedDistanceFromRight(175),this.mScreenManager.FixedDistanceFromTop(281),"digits",17,"left",!1,this.mScreenManager.mLayerName),this.DisplayNumber(this.mScreenManager.Game().GetHelmetScore(),this.mScreenManager.FixedDistanceFromRight(48),this.mScreenManager.FixedDistanceFromTop(281),"digits",17,"left",!1,this.mScreenManager.mLayerName),this.displayEndImage(),this.Game().DisableUserPause()},GameOver.prototype.displayEndImage=function(){var e=this.mScreenManager.Game(),t=e.mEndCardName;e.GetImage(t).width==0&&(t="end_image_1-1"),this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.FixedDistanceFromLeft(280),this.mScreenManager.FixedDistanceFromBottom(280),t,this.mScreenManager.mLayerName)},GameOver.prototype.playAgain=function(){this.Close(),this.Game().Replay()},GameOver.prototype.visitProgressive=function(){this.Game().OpenURL("http://www.progressive.com/insurance/bundle-and-save/optimization-dsp-homeowners.aspx?&code=9903604518")},GameOver.prototype.goHome=function(){this.Close(),this.Game().GotoMainMenu()},GameOver.prototype.shareFacebook=function(){this.Game().AnalyticShareEvent("facebook");var e="http://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.progressive.com%2Frocketcat";this.Game().OpenURL(e)},GameOver.prototype.gFormatScore=function(e){var t=Number(e),n="";t<0&&(t=-t,n="-");var r=Math.round(t*100),i=""+Math.floor(r/100),s=r%100;s<10&&(s="0"+s);var o=i.length-3;delimitedIntPart=i.substring(o,o+3);while(o>0)o-=3,delimitedIntPart=i.substring(o,o+3)+","+delimitedIntPart;return delimitedIntPart},GameOver.prototype.shareTwitter=function(){var e=this.mScreenManager.Game().CurrentScore().toString(),t=GameOver.prototype.gFormatScore(e);this.Game().AnalyticShareEvent("twitter");var n="http://twitter.com/home?status=Just%20played%20%23rocketcatadventures%20with%20%40itsflo!%20I%20made%20it%20to%20level%20"+this.mScreenManager.Game().CurrentLevel().toString()+",%20scored%20"+t+"%20points!%20See%20if%20you%20can%20beat%20me!%20bit.ly%2F15xFQz6";this.Game().OpenURL(n)},GameOver.prototype.Destroy=function(){bTransitionScreen=!1},PauseScreen.prototype=new TGE.Screen,PauseScreen.prototype.constructor=PauseScreen,PauseScreen.prototype.Setup=function(){var e=this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.5),"pause_background",this.mScreenManager.mLayerName);e.SetScale(8,8),e.SetAlpha(.6),this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.XFromPercentage(.505),this.mScreenManager.YFromPercentage(.07),"pause_pawzed",this.mScreenManager.mLayerName),this.CreateUIEntity(TGE.Button).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.44),"pause_resume",PauseScreen.prototype.resumeGame.bind(this),1,this.mScreenManager.mLayerName),this.CreateUIEntity(TGE.Button).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.64),"pause_new_game",PauseScreen.prototype.restartGame.bind(this),1,this.mScreenManager.mLayerName),this.CreateUIEntity(TGE.Button).Setup(this.mScreenManager.FixedDistanceFromLeft(85),this.mScreenManager.FixedDistanceFromTop(40),"gameover_home",PauseScreen.prototype.goHome.bind(this),1,this.mScreenManager.mLayerName)},PauseScreen.prototype.resumeGame=function(){this.Game().PauseGame(!1)},PauseScreen.prototype.restartGame=function(){this.Close(),this.Game().Replay()},PauseScreen.prototype.goHome=function(){this.Close(),this.Game().GotoMainMenu()},TransitionScreen.prototype=new TGE.Screen,TransitionScreen.prototype.constructor=TransitionScreen,TransitionScreen.prototype.Setup=function(){bTransitionScreen=!0;var e=this.mScreenManager.Game();this.FillBackground("#000"),this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.87),"transition_message_"+e.CurrentLevel().toString(),this.mScreenManager.mLayerName),e.mCameraLocation=$V([0,0]),this.CreateUIEntity(TGE.ParallaxPane).Setup(this.mScreenManager.XFromPercentage(.455),2500,"transition_background_effect",this.mScreenManager.mLayerName),this.mBaseY=this.mScreenManager.YFromPercentage(.5),this.mRocketCat=this.CreateUIEntity(TGE.ScreenEntity).Setup(this.mScreenManager.XFromPercentage(.44),this.mBaseY,"transition_rocket_cat",this.mScreenManager.mLayerName),this.mLoadingText=this.CreateUIEntity(TGE.Text).Setup(this.mScreenManager.XFromPercentage(.5),this.mScreenManager.YFromPercentage(.93),"LOADING 0%","bold italic 18px Arial","center","middle","#aaa",this.mScreenManager.mLayerName),this.Game().DisableUserPause()},TransitionScreen.prototype.Update=function(e){TGE.Screen.prototype.Update.call(this,e);var t=this.Game(),n=t.CameraLocation().e(1),r=t.CameraLocation().e(2);t.mCameraLocation=$V([n+e,r]),this.mBobTimer+=e;var i=this.mRocketCat.Position().e(1),s=Math.sin(this.mBobTimer*this.mBobFrequency)*this.mBobAmplitude,o=this.mBaseY+s;this.mRocketCat.SetPosition(i,o)},TransitionScreen.prototype.UpdateProgress=function(e){var t="LOADING "+Math.round(e*100).toString()+"%";this.mLoadingText.SetText(t),e>=1&&this.mLoadingText.Hide()},TransitionScreen.prototype.Destroy=function(){bTransitionScreen=!1},Player.prototype=new TGE.GameWorldEntity,Player.prototype.constructor=Player,Player.prototype.Setup=function(e){var t=0,n=0;return TGE.GameWorldEntity.prototype.Setup.call(this,t,n,null,e),this.LoadAnimation("up","rc_fly_up",4,4,16,24,!0),this.LoadAnimation("down","rc_float_down",4,4,16,24,!0),this.LoadAnimation("trot","rc_trot",4,4,16,24,!0),this.LoadAnimation("crash","rc_crash",2,3,6,12,!1),this.LoadAnimation("thruster","thruster",4,4,16,24,!0),this.LoadAnimation("turbo","rc_turbo",2,2,4,12,!0),this.PlayAnimation("trot"),this.mThruster=this.mGame.CreateWorldEntity(TGE.GameWorldEntity).Setup(t,n,null,"thruster"),this.mThruster.LoadAnimation("thrust","thruster",4,4,16,24,!0),this.mThruster.PlayAnimation("thrust"),this.mHelmet=this.mGame.CreateWorldEntity(TGE.GameWorldEntity).Setup(t,n,"helmet",e),this.mHelmet.Hide(),this.mBundleGlow=this.mGame.CreateWorldEntity(TGE.GameWorldEntity).Setup(t,n,null,"thruster"),this.mBundleGlow.LoadAnimation("bundle_glow","rc_bundle_glow",4,2,8,12,!0),this.mBundleGlow.PlayAnimation("bundle_glow"),this.mBundleGlow.SetScale(2),this.mBundleGlow.Hide(),this},Player.prototype.TimeAirborne=function(){return this.mAge-this.mLaunchAge},Player.prototype.CollideWithObstacle=function(){if(this.mInvincibilityTimer>0||this.mGame.BundlerBoostActive())return;if(this.mHasShield){this.mHasShield=!1;return}this.mVelocityVector=$V([0,0]),this.mStopped=!0,this.mGame.StartEndingGame(),this.PlayAnimation("crash")},Player.prototype.Stopped=function(){return this.mStopped},Player.prototype.MakeInvincible=function(e){this.mInvincibilityTimer=e},Player.prototype.GiveShield=function(){this.mHasShield=!0,this.mGame.mHelmetScore++,this.mGame.AnalyticAchievementEvent("flo helmet")},Player.prototype.SetSpeed=function(e){this.mBaseHorizontalSpeed=e},Player.prototype.subclassUpdate=function(e){if(this.mGame.GameplayFrozen())return;this.mHorizontalSpeed=this.mGame.BundlerBoostActive()?this.mGame.Width()*2:this.mGame.Width()*this.mBaseHorizontalSpeed;var t=this.Height()/2,n=this.mPosition.e(1),r=n,i=this.mPosition.e(2);if(!this.mStopped){r+=this.mHorizontalSpeed*e;if(this.mGame.BundlerBoostActive())this.mVerticalSpeed=0,this.PlayAnimation("turbo");else{var s=!1;if(this.ApplyThrust()){s=!0;var o=this.mGame.Height()*.7;this.mVerticalSpeed+=this.mGame.Height()*5.4*e,this.mVerticalSpeed>o&&(this.mVerticalSpeed=o),this.PlayAnimation("up")}else{var u=-this.mGame.Height()*.8;this.mVerticalSpeed-=this.mGame.Height()*4.2*e,this.mVerticalSpeed<u&&(this.mVerticalSpeed=u),this.mTrotting||this.PlayAnimation("down")}}}else this.mVerticalSpeed=0;i+=this.mVerticalSpeed*e,this.mTrotting=!1;var t=this.Height()/2;i<t?(i=t,this.mVerticalSpeed=0,this.mStopped||this.PlayAnimation("trot"),this.mTrotting=!0):i>this.mGame.Height()-t&&(i=this.mGame.Height()-t,this.mVerticalSpeed=0);var a=-this.mVerticalSpeed/(this.mGame.Height()*4);this.SetRotation(a),this.mGame.IncPlayerDistance(r-n),this.SetPosition(r,i),this.mThruster.SetPosition(r-72,i),this.mThruster.SetRotation(a,110,35),s?(this.mThruster.Show(),this.mThrusterAlpha+=e*15,this.mThrusterAlpha>1&&(this.mThrusterAlpha=1)):(this.mThrusterAlpha-=e*5,this.mThrusterAlpha<0&&(this.mThrusterAlpha=0,this.mThruster.Hide())),this.mThruster.SetAlpha(this.mThrusterAlpha),this.mHasShield&&!this.mGame.BundlerBoostActive()?(this.mHelmet.SetPosition(r,i),this.mHelmet.SetRotation(a),this.mHelmet.Show()):this.mHelmet.Hide(),this.mGame.BundleBonusActive()?(this.mBundleGlow.SetPosition(r-18,i+0),this.mBundleGlow.SetRotation(a),this.mBundleGlow.Show()):this.mBundleGlow.Hide(),this.mInvincibilityTimer>0&&(this.mInvincibilityTimer-=e)},Player.prototype.UpdateScreenPosition=function(){TGE.GameWorldEntity.prototype.UpdateScreenPosition.call(this)},Player.prototype.Hide=function(){TGE.GameWorldEntity.prototype.Hide.call(this),this.mThruster!=null&&this.mThruster.Hide(),this.mHelmet.Visible()&&this.mHelmet.Hide()},Player.prototype.ApplyThrust=function(){if(this.mGame.IsMouseDown()){var e=this.mGame.mPauseButtonSize;if(!(this.mGame.MouseX()>this.mGame.Width()-e&&this.mGame.MouseY()<e))return!0}return!1},StationaryObstacle.prototype=new TGE.GameWorldEntity,StationaryObstacle.prototype.constructor=StationaryObstacle,StationaryObstacle.prototype.Setup=function(e,t,n){this.mType=t;var r="L"+this.mGame.CurrentLevel().toString()+"_stationary_obstacle_"+t.toString(),i=0;if(this.mGame.CurrentLevel()==1)switch(t){case 1:i=95;break;case 2:i=105;break;case 3:i=500;break;case 4:i=155;break;case 5:i=155;break;case 6:i=95;break;case 7:i=95;break;case 8:i=500}else if(this.mGame.CurrentLevel()==2)switch(t){case 1:i=75;break;case 2:i=150;break;case 3:i=160;break;case 4:i=150;break;case 5:i=150,r=null;break;case 6:i=480}else if(this.mGame.CurrentLevel()==3)switch(t){case 1:i=80;break;case 2:i=460,this.mRadius=200,this.mRadiusYOffset=165;break;case 3:i=450,this.mRadius=100}TGE.GameWorldEntity.prototype.Setup.call(this,e,i,r,n),r="L"+this.mGame.CurrentLevel().toString()+"_stationary_obstacle_"+t.toString();if(this.mGame.CurrentLevel()==1)switch(t){}else if(this.mGame.CurrentLevel()==2)switch(t){case 5:this.LoadAnimation("anim",r,1,2,2,8,!0),this.PlayAnimation("anim")}else if(this.mGame.CurrentLevel()==3)switch(t){}return this.CullToCamera(!1,!1,!1,!0),this},StationaryObstacle.prototype.subclassUpdate=function(e){var t=!1;if(this.mRadius>0){var n=this.mPosition.e(1),r=this.mPosition.e(2)+this.mRadiusYOffset,i=this.mGame.GetPlayer().Position().e(1),s=this.mGame.GetPlayer().Position().e(2);t=n>i-this.mRadius&&n<i+this.mRadius&&r>s-this.mRadius&&r<s+this.mRadius}else{var o=.85,u=this.Width()*o*.5,a=this.Height()*o*.5,f=this.mPosition.e(1)-u,l=this.mPosition.e(2)+a,c=this.mPosition.e(1)+u,h=this.mPosition.e(2)-a,u=this.mGame.GetPlayer().Width()*o*.5,a=this.mGame.GetPlayer().Height()*o*.5,p=this.mGame.GetPlayer().Position().e(1)-u,d=this.mGame.GetPlayer().Position().e(2)+a,v=this.mGame.GetPlayer().Position().e(1)+u,m=this.mGame.GetPlayer().Position().e(2)-a;t=this.AABBandAABBIntersect(f,c,l,h,p,v,d,m)}!this.mTriggered&&t&&(this.mTriggered=!0,this.mGame.GetPlayer().CollideWithObstacle())},StationaryObstacle.prototype.AABBandAABBIntersect=function(e,t,n,r,i,s,o,u){var a=e<=i&&t>=i||e<=s&&t>=s||e>=i&&t<=s,f=n>=o&&r<=o||n>=u&&r<=u||n<=o&&r>=u;return a&&f},MovingObstacle.prototype=new TGE.GameWorldEntity,MovingObstacle.prototype.constructor=MovingObstacle,MovingObstacle.prototype.Setup=function(e,t,n){this.mType=t;var r="L"+this.mGame.CurrentLevel().toString()+"_moving_obstacle_"+t,i=0;if(this.mGame.CurrentLevel()==1)switch(t){case"A":i=300,this.mBobAmplitude=200,this.mBobFrequency=1;break;case"B":i=350,this.mBobAmplitude=90,this.mBobFrequency=4}else if(this.mGame.CurrentLevel()==2)switch(t){case"A":i=430,this.mBobAmplitude=10,this.mBobFrequency=12,r=null;break;case"B":i=90,this.mBobAmplitude=20,this.mBobFrequency=4,r=null;break;case"C":i=300,this.mBobAmplitude=255,this.mBobFrequency=2,r=null;break;case"D":i=550,this.mBobAmplitude=200,this.mBobFrequency=3}else if(this.mGame.CurrentLevel()==3)switch(t){case"A":i=450,this.mBobAmplitude=30,this.mBobFrequency=3;break;case"B":i=250,this.mBobAmplitude=10,this.mBobFrequency=80;break;case"C":i=-80,this.mBobAmplitude=270,this.mBobFrequency=2;break;case"D":i=250,this.mBobAmplitude=200,this.mBobFrequency=2;break;case"E":i=270,this.mBobAmplitude=220,this.mBobFrequency=1,this.mRotationSpeed=10}this.mBaseY=i,TGE.GameWorldEntity.prototype.Setup.call(this,e,i,r,n),r="L"+this.mGame.CurrentLevel().toString()+"_moving_obstacle_"+t;if(this.mGame.CurrentLevel()==1)switch(t){}else if(this.mGame.CurrentLevel()==2)switch(t){case"A":this.LoadAnimation("anim",r,2,4,8,24,!0),this.PlayAnimation("anim");break;case"B":this.LoadAnimation("anim",r,2,4,8,24,!0),this.PlayAnimation("anim");break;case"C":this.LoadAnimation("anim",r,1,1,1,2,!0),this.PlayAnimation("anim")}else if(this.mGame.CurrentLevel()==3)switch(t){}return this.CullToCamera(!1,!1,!1,!0),this.mGame.CurrentLevel()==2&&t=="D"&&this.mGame.CreateWorldEntity(StationaryObstacle).Setup(e,6,"obstacles"),this},MovingObstacle.prototype.subclassUpdate=function(e){var t=this.mPosition.e(1),n=Math.sin(this.mGame.GameTime()*this.mBobFrequency)*this.mBobAmplitude;this.SetPosition(t,this.mBaseY+n),this.mRotation+=this.mRotationSpeed*e,this.SetRotation(this.mRotation);var r=.85,i=this.Width()*r*.5,s=this.Height()*r*.5,o=this.mPosition.e(1)-i,u=this.mPosition.e(2)+s,a=this.mPosition.e(1)+i,f=this.mPosition.e(2)-s,i=this.mGame.GetPlayer().Width()*r*.5,s=this.mGame.GetPlayer().Height()*r*.5,l=this.mGame.GetPlayer().Position().e(1)-i,c=this.mGame.GetPlayer().Position().e(2)+s,h=this.mGame.GetPlayer().Position().e(1)+i,p=this.mGame.GetPlayer().Position().e(2)-s;!this.mTriggered&&this.AABBandAABBIntersect(o,a,u,f,l,h,c,p)&&(this.mTriggered=!0,this.mGame.GetPlayer().CollideWithObstacle())},MovingObstacle.prototype.AABBandAABBIntersect=function(e,t,n,r,i,s,o,u){var a=e<=i&&t>=i||e<=s&&t>=s||e>=i&&t<=s,f=n>=o&&r<=o||n>=u&&r<=u||n<=o&&r>=u;return a&&f},Coin.prototype=new TGE.GameWorldEntity,Coin.prototype.constructor=Coin,Coin.prototype.Setup=function(e,t,n){return TGE.GameWorldEntity.prototype.Setup.call(this,e,t,null,n),this.CullToCamera(!1,!1,!1,!0),this.LoadAnimation("static","coin",1,1,1,24,!1),this.LoadAnimation("pickup","coin_pickup",2,4,8,24,!1),this.LoadAnimation("static_large","coin_large",1,1,1,24,!1),this.mLarge=this.mGame.BundleBonusActive(),this.PlayAnimation(this.mLarge?"static_large":"static"),this},Coin.prototype.subclassUpdate=function(e){if(this.mGame.GameplayFrozen())return;!this.mPickedUp&&this.mLarge!=this.mGame.BundleBonusActive()&&(this.mLarge=this.mGame.BundleBonusActive(),this.PlayAnimation(this.mLarge?"static_large":"static"));var t=this.mPosition.e(1),n=this.mPosition.e(2),r=this.mGame.GetPlayer().Position().e(1),i=this.mGame.GetPlayer().Position().e(2),s=this.mLarge?65:50;!this.mPickedUp&&t>r-s&&t<r+s&&n>i-s&&n<i+s&&(this.mPickedUp=!0,this.PlayAnimation("pickup",Coin.prototype.MarkForRemoval.bind(this)),this.mLarge&&this.SetScale(1.5,1.5),this.mGame.PlayerGotCoin())},FloHelmet.prototype=new TGE.GameWorldEntity,FloHelmet.prototype.constructor=FloHelmet,FloHelmet.prototype.Setup=function(e,t,n){var r="L"+this.mGame.CurrentLevel().toString()+"_flo_animation";TGE.GameWorldEntity.prototype.Setup.call(this,e,t,null,n),this.CullToCamera(!1,!1,!1,!0),this.LoadAnimation("anim",r,1,1,1,1,!0),this.PlayAnimation("anim");switch(this.mGame.CurrentLevel()){case 1:this.mHelmetX=95,this.mHelmetY=55;break;case 2:this.mHelmetX=-95,this.mHelmetY=72;break;case 3:this.mHelmetX=80,this.mHelmetY=60}this.mHelmet=this.mGame.CreateWorldEntity(TGE.GameWorldEntity).Setup(e+this.mHelmetX,t+this.mHelmetY,"helmet",n),this.mBaseY=t;switch(this.mGame.CurrentLevel()){case 1:this.mBobAmplitude=10,this.mBobFrequency=3;break;case 2:this.mBobAmplitude=8,this.mBobFrequency=5.5;break;case 3:this.mBobAmplitude=25,this.mBobFrequency=3}return this},FloHelmet.prototype.subclassUpdate=function(e){var t=this.mPosition.e(1),n=Math.sin(this.mGame.GameTime()*this.mBobFrequency)*this.mBobAmplitude,r=this.mBaseY+n;this.SetPosition(t,r);var i=.85,s=this.Width()*i*.5,o=this.Height()*i*.5,u=this.mPosition.e(1)-s,a=this.mPosition.e(2)+o,f=this.mPosition.e(1)+s,l=this.mPosition.e(2)-o,s=this.mGame.GetPlayer().Width()*i*.25,o=this.mGame.GetPlayer().Height()*i*.25,c=this.mGame.GetPlayer().Position().e(1)-s,h=this.mGame.GetPlayer().Position().e(2)+o,p=this.mGame.GetPlayer().Position().e(1)+s,d=this.mGame.GetPlayer().Position().e(2)-o;!this.mTriggered&&this.AABBandAABBIntersect(u,f,a,l,c,p,h,d)&&(this.mTriggered=!0,this.mGame.GetPlayer().GiveShield(),this.mHelmet.Hide())},FloHelmet.prototype.UpdateScreenPosition=function(){TGE.GameWorldEntity.prototype.UpdateScreenPosition.call(this),this.mHelmet!=null&&this.mHelmet.SetPosition(this.mPosition.e(1)+this.mHelmetX,this.mPosition.e(2)+this.mHelmetY)},FloHelmet.prototype.AABBandAABBIntersect=function(e,t,n,r,i,s,o,u){var a=e<=i&&t>=i||e<=s&&t>=s||e>=i&&t<=s,f=n>=o&&r<=o||n>=u&&r<=u||n<=o&&r>=u;return a&&f},BundlePowerup.prototype=new TGE.GameWorldEntity,BundlePowerup.prototype.constructor=BundlePowerup,BundlePowerup.prototype.Setup=function(e,t,n,r){this.mPart=n;var i="bundle_coins_"+n.toString();return TGE.GameWorldEntity.prototype.Setup.call(this,e,t,i,r),this.CullToCamera(!1,!1,!1,!0),this},BundlePowerup.prototype.subclassUpdate=function(e){var t=this.mPosition.e(1),n=this.mPosition.e(2),r=this.mGame.GetPlayer().Position().e(1),i=this.mGame.GetPlayer().Position().e(2),s=70;t>r-s&&t<r+s&&n>i-s&&n<i+s&&(this.MarkForRemoval(),this.mGame.PlayerGotBundle(this.mPart))},Bundler.prototype=new TGE.GameWorldEntity,Bundler.prototype.constructor=Bundler,Bundler.prototype.Setup=function(e,t,n){return TGE.GameWorldEntity.prototype.Setup.call(this,e,t,"bundler","bundles"),this.CullToCamera(!1,!1,!1,!0),this.mBaseY=t,this.mBobAmplitude=10,this.mBobFrequency=3,this.mBackgroundEmpty=this.mGame.CreateWorldEntity(TGE.GameWorldEntity).Setup(e+this.mBackgroundOffsetX,t+this.mBackgroundOffsetY,"bundler_empty_background",n),this.mBackgroundSwirl=this.mGame.CreateWorldEntity(TGE.GameWorldEntity).Setup(e+this.mBackgroundOffsetX,t+this.mBackgroundOffsetY,"bundler_swirl_background",n),this.mBackgroundSwirl.Hide(),this},Bundler.prototype.subclassUpdate=function(e){var t=this.mPosition.e(1),n=Math.sin(this.mGame.GameTime()*this.mBobFrequency)*this.mBobAmplitude,r=this.mBaseY+n;this.SetPosition(t,r),this.mTriggered&&(this.SetRotation(-Math.sin(this.mGame.GameTime()*80)*.02),this.mBackgroundSwirl.Show()),this.mBackgroundEmpty.SetPosition(t+this.mBackgroundOffsetX,r+this.mBackgroundOffsetY),this.mBackgroundSwirl.SetPosition(t+this.mBackgroundOffsetX,r+this.mBackgroundOffsetY),this.mBackgroundSwirl.SetRotation(this.mGame.GameTime()*20);var i=this.mPosition.e(1),s=this.mPosition.e(2),o=this.mGame.GetPlayer().Position().e(1),u=this.mGame.GetPlayer().Position().e(2),a=100;!this.mTriggered&&i>o-a&&i<o+a&&s>u-a&&s<u+a&&(this.mTriggered=!0,this.mGame.PlayerEnteredBundler(this))},RocketCatGame.prototype=new TGE.Game;var bTransitionScreen=!1,gLoadingScreenImages=[{id:"loading_title",url:"image/loading_title.jpg"},{id:"loading_rc",url:"image/loading_rocket_cat.jpg"},{id:"screen_fade",url:"image/fade.png"}],gCoreGameImages=[{id:"fade",url:"image/fade.png"},{id:"digits",url:"image/digits.png"},{id:"digits_gold",url:"image/digits_gold.png"},{id:"big_digits",url:"image/big_digits.png"},{id:"big_digits_comma",url:"image/big_digits_comma.png"},{id:"pause_button",url:"image/pause_button.png"},{id:"achievement_popup",url:"image/achievement_popup.png"},{id:"start_tap_to_fly",url:"image/start_tap_to_fly.png"},{id:"start_beat_your_score",url:"image/start_beat_your_score.png"},{id:"coin",url:"image/coin.png"},{id:"coin_pickup",url:"image/coin_pickup.png"},{id:"coin_large",url:"image/coin_large.png"},{id:"coins_ui",url:"image/coins_ui.png"},{id:"distance_ui",url:"image/distance_ui.png"},{id:"thruster",url:"image/thruster.png"},{id:"bundle_coins_1",url:"image/bundle_coins_1.png"},{id:"bundle_coins_2",url:"image/bundle_coins_2.png"},{id:"bundle_thought_1",url:"image/bundle_thought_1.png"},{id:"bundle_thought_2",url:"image/bundle_thought_2.png"},{id:"bundler",url:"image/bundler.png"},{id:"bundler_empty_background",url:"image/bundler_empty_background.png"},{id:"bundler_swirl_background",url:"image/bundler_swirl_background.png"},{id:"rc_fly_up",url:"image/rc_fly_up.png"},{id:"rc_float_down",url:"image/rc_float_down.png"},{id:"rc_trot",url:"image/rc_trot.png"},{id:"rc_crash",url:"image/rc_crash.png"},{id:"rc_bundle_glow",url:"image/rc_bundle_glow.png"},{id:"rc_turbo",url:"image/rc_turbo.png"},{id:"helmet",url:"image/helmet.png"},{id:"hack_level_2",url:"image/lvl2.jpg"},{id:"hack_level_3",url:"image/lvl3.jpg"},{id:"mainmenu_background",url:"image/background.jpg"},{id:"mainmenu_full_title",url:"image/full_title.png"},{id:"mainmenu_play_mobile",url:"image/play_mobile.png"},{id:"mainmenu_play_browser",url:"image/play_browser.png"},{id:"mainmenu_more_info",url:"image/more_info.png"},{id:"mainmenu_meet_rc",url:"image/meet_rc.png"},{id:"mainmenu_flo_facebook",url:"image/flo_facebook.png"},{id:"gameover_left_panel_background",url:"image/left_panel_background.jpg"},{id:"gameover_right_panel_background",url:"image/right_panel_background.jpg"},{id:"gameover_home",url:"image/home.png"},{id:"gameover_play_again",url:"image/play_again.png"},{id:"gameover_visit_progressive",url:"image/visit_progressive.png"},{id:"gameover_share",url:"image/share.png"},{id:"gameover_share_twitter",url:"image/share_twitter.png"},{id:"gameover_share_fb",url:"image/share_fb.png"},{id:"end_image_1-1",url:"image/end_image_1-1.png"},{id:"pause_background",url:"image/background.png"},{id:"pause_resume",url:"image/resume.png"},{id:"pause_new_game",url:"image/new_game.png"},{id:"pause_pawzed",url:"image/pawzed.png"},{id:"transition_background_effect",url:"image/background_effect.jpg"},{id:"transition_rocket_cat",url:"image/rocket_cat_transition.png"},{id:"transition_message_1",url:"image/interstitial1.jpg"},{id:"transition_message_2",url:"image/interstitial2.jpg"},{id:"transition_message_3",url:"image/interstitial3.jpg"},{id:"L1_flo_animation",url:"image/flo_animation.png"},{id:"parallax_shelves0_a",url:"image/parallax_shelves0_a.png"},{id:"parallax_shelves0_b",url:"image/parallax_shelves0_b.png"},{id:"parallax_shelves0_c",url:"image/parallax_shelves0_c.png"},{id:"parallax_shelves1_a",url:"image/parallax_shelves1_a.png"},{id:"parallax_shelves1_b",url:"image/parallax_shelves1_b.png"},{id:"parallax_shelves1_c",url:"image/parallax_shelves1_c.png"},{id:"parallax_shelves1_d",url:"image/parallax_shelves1_d.png"},{id:"parallax_shelves1_e",url:"image/parallax_shelves1_e.png"},{id:"parallax_shelves2",url:"image/parallax_shelves2.jpg"},{id:"L1_stationary_obstacle_1",url:"image/shelf_wide.png"},{id:"L1_stationary_obstacle_2",url:"image/help_desk.png"},{id:"L1_stationary_obstacle_3",url:"image/quote_board.png"},{id:"L1_stationary_obstacle_4",url:"image/shelf_big.png"},{id:"L1_stationary_obstacle_5",url:"image/shelf_high.png"},{id:"L1_stationary_obstacle_6",url:"image/shelf_low.png"},{id:"L1_stationary_obstacle_7",url:"image/plant.png"},{id:"L1_stationary_obstacle_8",url:"image/light.png"},{id:"L1_moving_obstacle_A",url:"image/squirrel.png"},{id:"L1_moving_obstacle_B",url:"image/blimp.png"}],gLevel2Images=[{id:"L2_flo_animation",url:"image/level_2/flo_animation.png"},{id:"parallax_bigtree",url:"image/level_2/parallax_bigtree.png"},{id:"parallax_liltree",url:"image/level_2/parallax_liltree.png"},{id:"parallax_ground",url:"image/level_2/parallax_ground.png"},{id:"parallax_buildings",url:"image/level_2/parallax_buildings.png"},{id:"parallax_skyline",url:"image/level_2/parallax_skyline.jpg"},{id:"L2_stationary_obstacle_1",url:"image/level_2/bench.png"},{id:"L2_stationary_obstacle_2",url:"image/level_2/foodstand_1.png"},{id:"L2_stationary_obstacle_3",url:"image/level_2/foodstand_2.png"},{id:"L2_stationary_obstacle_4",url:"image/level_2/foodstand_3.png"},{id:"L2_stationary_obstacle_5",url:"image/level_2/fountain.png"},{id:"L2_stationary_obstacle_6",url:"image/level_2/tree_1.png"},{id:"L2_moving_obstacle_A",url:"image/level_2/birds_1.png"},{id:"L2_moving_obstacle_B",url:"image/level_2/birds_2.png"},{id:"L2_moving_obstacle_C",url:"image/level_2/mouseplane.png"},{id:"L2_moving_obstacle_D",url:"image/level_2/racoons.png"}],gLevel3Images=[{id:"L3_flo_animation",url:"image/level_3/flo_animation.png"},{id:"parallax_rocks_a",url:"image/level_3/parallax_rocks_a.png"},{id:"parallax_rocks_b",url:"image/level_3/parallax_rocks_b.png"},{id:"parallax_stars",url:"image/level_3/parallax_stars.png"},{id:"parallax_space",url:"image/level_3/parallax_space.png"},{id:"L3_stationary_obstacle_1",url:"image/level_3/moon.png"},{id:"L3_stationary_obstacle_2",url:"image/level_3/planet.png"},{id:"L3_stationary_obstacle_3",url:"image/level_3/sun.png"},{id:"L3_moving_obstacle_A",url:"image/level_3/astronaut.png"},{id:"L3_moving_obstacle_B",url:"image/level_3/comet.png"},{id:"L3_moving_obstacle_C",url:"image/level_3/satellite.png"},{id:"L3_moving_obstacle_D",url:"image/level_3/ufo.png"},{id:"L3_moving_obstacle_E",url:"image/level_3/asteroid.png"}],soundsToPreLoad=null;RocketCatGame.prototype.subclassSetupLevel=function(e){this.ClearScene();if(e==1){this.mLevelEvents=level1,this.mNumStationaryObstacleTypes=8,this.mNumMovingObstacleTypes=2,this.SetBackgroundColor("#fff");var t;t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(480,.2,"parallax_shelves2","scenery"),t.SetScale(2),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(592,.3,"parallax_shelves1_a","scenery"),t.SetHorizontalOffset(450),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(475,.3,"parallax_shelves1_b","scenery"),t.SetHorizontalOffset(1950),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(322,.3,"parallax_shelves1_c","scenery"),t.SetHorizontalOffset(125),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(270,.3,"parallax_shelves1_d","scenery"),t.SetHorizontalOffset(1150),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(320,.3,"parallax_shelves1_e","scenery"),t.SetHorizontalOffset(2500),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(652,.4,"parallax_shelves0_a","scenery"),t.SetHorizontalOffset(990),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(202,.4,"parallax_shelves0_b","scenery"),t.SetHorizontalOffset(1318),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(323,.4,"parallax_shelves0_c","scenery"),t.SetHorizontalOffset(333)}if(e==2){this.mLevelEvents=level2,this.mNumStationaryObstacleTypes=6,this.mNumMovingObstacleTypes=0,this.SetBackgroundColor("#fff");var t;t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(540,.2,"parallax_skyline","scenery"),t.SetScale(2),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(510,.3,"parallax_buildings","scenery"),t.SetScale(2),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(195,.4,"parallax_ground","scenery"),t.SetHorizontalOffset(333),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(540,.4,"parallax_bigtree","scenery"),t.SetHorizontalOffset(326),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(370,.4,"parallax_liltree","scenery"),t.SetHorizontalOffset(1600)}if(e==3){this.mLevelEvents=level3,this.SetBackgroundColor("#000");var t;t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(540,.4,"parallax_space","scenery"),t.SetScale(3),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(540,.6,"parallax_stars","scenery"),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(545,.8,"parallax_rocks_a","scenery"),t.SetScale(2),t=this.CreateWorldEntity(TGE.ParallaxPane).Setup(450,.8,"parallax_rocks_b","scenery"),t.SetScale(2),t.SetHorizontalOffset(470)}this.mFreezeGameplay=!1,this.mEndCardLoadTimer=0,this.mCameraLocation=$V([this.Width()/2,0]),this.mLastStationaryObstacle=0,this.mLastCoin=0,this.mModalImage=null,this.mLastLevelEventTimer=0,this.mCurrentLevelEventIndex=0,this.mGotBundlePart1=!1,this.mBundleBonusTimer=0,this.mBundlerBoostTimer=0,this.mTransitionTimer=0,this.mCoinFrequency=0,this.mCoinY=this.Height()/2,this.mCoinWaveAmplitude=0,this.mCoinWaveFrequency=0,this.mCoinRandomRange=0,this.mCoinWaveTimer=0,this.mNumStationaryObstacleTypes=0,this.mNumMovingObstacleTypes=0,this.mStationaryObstacleFrequency=0,this.mStationaryObstaclePattern="random",this.mStationaryObstaclePatternIndex=0,this.mPlayer=this.CreateWorldEntity(Player).Setup("player"),iconX=55,iconY=22,this.CreateUIEntity(TGE.ScreenEntity).Setup(24,iconY-2,"distance_ui","UI");for(i=0;i<6;i++){var n=this.CreateUIEntity(TGE.ScreenEntity).Setup(iconX,iconY,null,"UI");n.SetImage("digits",1,10),this.mDistanceDigitIcons[i]=n,iconX+=17}iconX=54,iconY=52,this.CreateUIEntity(TGE.ScreenEntity).Setup(24,iconY,"coins_ui","UI");for(i=0;i<6;i++){var n=this.CreateUIEntity(TGE.ScreenEntity).Setup(iconX,iconY,null,"UI");n.SetImage("digits_gold",1,10),this.mCoinsDigitIcons[i]=n,iconX+=17}e==1&&this.DisplayStartMessage(this.mBestScore)},RocketCatGame.prototype.constructor=RocketCatGame,RocketCatGame.prototype.ResizeViewportForDevice=function(){TGE.Game.prototype.ResizeViewportForDevice.call(this);switch(this.mDeviceInfo.OSOrDevices){case"iPad":window.navigator.standalone==1?document.getElementById("game_canvas").style.marginTop="90px":parseInt(window.innerWidth)<=1e3&&(document.getElementById("game_canvas").style.marginTop="46px");break;case"iPhone":window.navigator.standalone==1&&(document.getElementById("game_canvas").style.marginTop="50px");break;case"Windows":case"Mac":document.getElementById("game_canvas").style.marginTop="50px";break;default:}},RocketCatGame.prototype.subclassPlayGame=function(){this.StartLevel(1)},RocketCatGame.prototype.subclassSetupLayers=function(){this.CreateLayer("scenery"),this.CreateLayer("obstacles"),this.CreateLayer("thruster"),this.CreateLayer("player"),this.CreateLayer("coins"),this.CreateLayer("bundles"),this.CreateLayer("UI")},RocketCatGame.prototype.subclassStartPlaying=function(){this.mDistance=0,this.mCoins=0,this.mBundlerScore=0,this.mBundlesScore=0,this.mHelmetScore=0},RocketCatGame.prototype.subclassFinishLevel=function(){if(this.mCurrentLevel==3){this.EndGame();return}this.mTransitionTimer=5,this.FreezeGameplay(!0);var e=this.mScreenManager.ShowScreen(TransitionScreen);this.mCurrentLevelAssetsLoaded=!1,this.LoadLevelAssets(this.mCurrentLevel+1,TransitionScreen.prototype.UpdateProgress.bind(e),RocketCatGame.prototype.levelLoadFinished.bind(this))},RocketCatGame.prototype.levelLoadFinished=function(){this.mCurrentLevelAssetsLoaded=!0,this.mTransitionTimer<=0&&this.finishTransitionIntoNextLevel()},RocketCatGame.prototype.finishTransitionIntoNextLevel=function(){this.mScreenManager.CloseScreen(TransitionScreen),this.mCurrentLevel++,this.StartLevel(this.mCurrentLevel)},RocketCatGame.prototype.subclassUpdateGame=function(e){if(!this.mPlaying)return;if(this.mEndCardLoadTimer>0){this.mEndCardLoadTimer-=e,this.mEndCardLoadTimer<=0&&this.EndGame();return}if(this.mTransitionTimer>0){this.mTransitionTimer-=e,this.mCurrentLevelAssetsLoaded&&this.mTransitionTimer<=0&&this.finishTransitionIntoNextLevel();return}if(this.mFreezeGameplay||this.mPauseGame)return;this.mLastLevelEventTimer+=e;var t=this.mLevelEvents[this.mCurrentLevelEventIndex];t!=null&&(t.begin_card!=null?(this.mLastLevelEventTimer=0,this.mCurrentLevelEventIndex++):t.rocket_cat_speed!=null?(this.mPlayer.SetSpeed(t.rocket_cat_speed),this.mCurrentLevelEventIndex++):this.mLastLevelEventTimer>=t.time&&(this.processLevelEvent(t),this.mCurrentLevelEventIndex++));if(this.mPlayer!=null){var n=this.mPlayer.Position().e(1)+250,r=this.Height()/2;this.mCameraLocation.setElements([n,r])}if(!this.mPlaying)return;var i=Math.floor(this.mDistance).toString();for(si=0;si<6;si++)i.length>si?(this.mDistanceDigitIcons[si].Show(),this.mDistanceDigitIcons[si].SetImageIndex(i.charCodeAt(si)-48)):this.mDistanceDigitIcons[si].Hide();i=Math.floor(this.mCoins).toString();for(si=0;si<6;si++)i.length>si?(this.mCoinsDigitIcons[si].Show(),this.mCoinsDigitIcons[si].SetImageIndex(i.charCodeAt(si)-48)):this.mCoinsDigitIcons[si].Hide();if(this.mStartMessageTimer>0){this.mStartMessageTimer-=e;if(this.mStartMessageTimer<=0){this.mStartMessage.MarkForRemoval();for(var s=0;s<this.mStartMessageDigits.length;s++)this.mStartMessageDigits[s].MarkForRemoval()}else{var o=1,u=this.mStartMessageTimer>o?1:this.mStartMessageTimer/o;this.mStartMessage.SetAlpha(u);for(var s=0;s<this.mStartMessageDigits.length;s++)this.mStartMessageDigits[s].SetAlpha(u)}}this.mAchievementPopupTimer>0&&(this.mAchievementPopupTimer-=e,this.mAchievementPopupTimer<=0&&(this.mAchievementPopup.MarkForRemoval(),this.mAchievementMessage.MarkForRemoval(),this.mAchievementPopup=null)),this.spawnObstacles(e),this.spawnCoins(e),this.mBundleBonusTimer-=e,this.mBundlerBoostTimer-=e},RocketCatGame.prototype.processLevelEvent=function(e){switch(e.event){case"coin_frequency":this.mCoinFrequency=e.value;break;case"coin_y":this.mCoinY=this.Height()*e.value;break;case"coin_sinewave":this.mCoinWaveAmplitude=e.amplitude,this.mCoinWaveFrequency=e.amplitude==0?0:e.frequency,this.mCoinWaveTimer=0,this.mCoinRandomRange=0;break;case"coin_randomize":this.mCoinRandomRange=e.amplitude,this.mCoinWaveFrequency=0,this.mCoinWaveAmplitude=0;break;case"coin_shape":this.generateCoinShape(e.shape,e.size);break;case"stationary_obstacle_frequency":this.mStationaryObstacleFrequency=e.value,this.mLastStationaryObstacle=this.mPlayer.Position().e(1);break;case"stationary_obstacle_pattern":this.mStationaryObstaclePattern=e.value,this.mStationaryObstaclePatternIndex=0;break;case"flo_helmet":this.CreateWorldEntity(FloHelmet).Setup(this.mPlayer.Position().e(1)+this.Width(),this.Height()*e.height,"obstacles");break;case"coin_powerup_bundle":var t=e.part;if(t==1||t==2&&this.mGotBundlePart1)this.CreateWorldEntity(BundlePowerup).Setup(this.mPlayer.Position().e(1)+this.Width(),this.Height()*e.height,e.part,"bundles"),t==1&&(this.mGotBundlePart1=!1);break;case"bundler":this.CreateWorldEntity(Bundler).Setup(this.mPlayer.Position().e(1)+this.Width(),this.Height()*e.height,"obstacles");break;case"nothing":this.mCoinFrequency=0,this.mStationaryObstacleFrequency=0;break;case"level_finished":this.mCoinFrequency=0,this.mStationaryObstacleFrequency=0,this.FinishLevel();break;default:}},RocketCatGame.prototype.spawnObstacles=function(e){var t=this.mPlayer.Position().e(1);if(this.mStationaryObstacleFrequency==0)this.mLastStationaryObstacle=t;else if(t-this.mLastStationaryObstacle>this.mStationaryObstacleFrequency){var n=t-this.mLastStationaryObstacle-this.mStationaryObstacleFrequency,r=t-n,i=-1,s="";this.mStationaryObstaclePattern=="random"?type=Math.ceil(Math.random()*this.mNumStationaryObstacleTypes):this.mStationaryObstaclePattern.charAt(this.mStationaryObstaclePatternIndex)!="X"&&(i=this.mStationaryObstaclePattern.charCodeAt(this.mStationaryObstaclePatternIndex)-48,s=this.mStationaryObstaclePattern.charAt(this.mStationaryObstaclePatternIndex),this.mStationaryObstaclePatternIndex=(this.mStationaryObstaclePatternIndex+1)%this.mStationaryObstaclePattern.length),i>0&&(i<=9?this.CreateWorldEntity(StationaryObstacle).Setup(r+this.Width(),i,"obstacles"):this.CreateWorldEntity(MovingObstacle).Setup(r+this.Width(),s,"obstacles")),this.mLastStationaryObstacle=r}},RocketCatGame.prototype.spawnCoins=function(e){var t=this.mPlayer.Position().e(1);if(this.mCoinFrequency==0)this.mLastCoin=t;else if(t-this.mLastCoin>this.mCoinFrequency){var n=t-this.mLastCoin-this.mCoinFrequency,r=t-n,i=this.mCoinY+Math.sin(this.mCoinWaveTimer*this.mCoinWaveFrequency)*this.mCoinWaveAmplitude;i+=this.mCoinRandomRange>0?Math.random()*this.mCoinRandomRange-this.mCoinRandomRange/2:0,this.CreateWorldEntity(Coin).Setup(r+this.Width(),i,"coins"),this.mLastCoin=r}this.mCoinWaveTimer+=e},RocketCatGame.prototype.generateCoinShape=function(e,t){var n=this.mPlayer.Position().e(1)+this.Width(),r=this.mCoinY;if(e=="box"){var i=56,s=n-i*t/2,o=r-i*t/2;for(var u=0;u<t;u++){s=n-i*t/2;for(var a=0;a<t;a++)this.CreateWorldEntity(Coin).Setup(s,o,"coins"),s+=i;o+=i}}},TGE.Game.prototype.subclassMouseDown=function(){this.mDeviceInfo.OSOrDevices!="Linux"&&this.mDeviceInfo.OSOrDevices!="Android"&&window.scrollTo(0,0),this.mMouseX>this.Width()-this.mPauseButtonSize&&this.mMouseY<this.mPauseButtonSize&&!bTransitionScreen&&this.DoPause()},RocketCatGame.prototype.subclassEndGame=function(){this.CurrentScore()>this.mBestScore&&(this.mBestScore=this.CurrentScore())},RocketCatGame.prototype.StartEndingGame=function(){this.mEndCardLoadTimer=2,this.mEndCardName="end_image_"+this.mCurrentLevel.toString()+"-"+Math.ceil(Math.random()*5).toString()+".png";var e="image/"+this.mEndCardName;if(this.GetImage(this.mEndCardName)==null){var t=new PxLoader;this.AddImage(this.mEndCardName,t.addImage(e)),t.start()}},RocketCatGame.prototype.IncPlayerDistance=function(e){var t=this.mDistance,n=this.CurrentScore();this.mDistance+=e/100,t<this.mNextAchievementDistance&&this.mDistance>=this.mNextAchievementDistance&&(this.AnalyticAchievementEvent("distance",Math.round(this.mNextAchievementDistance)),this.DisplayAchievementNotification(this.mNextAchievementDistance.toString()+" 英尺!"),this.mNextAchievementDistance+=100),n<this.mBestScore&&this.CurrentScore()>=this.mBestScore&&(this.AnalyticAchievementEvent("new highscore",this.mBestScore),this.DisplayAchievementNotification("新纪录!"))},RocketCatGame.prototype.PlayerGotCoin=function(){var e=this.CurrentScore();this.mCoins+=this.BundleBonusActive()?5:1,e<this.mBestScore&&this.CurrentScore()>=this.mBestScore&&this.DisplayAchievementNotification("新纪录!")},RocketCatGame.prototype.PlayerGotBundle=function(e){if(e==1){this.mGotBundlePart1=!0;var t="bundle_thought_1";this.ModalMessage(t,254,94,1.4)}else if(e==2){var t="bundle_thought_2";this.ModalMessage(t,0,0,1.4),this.mBundleBonusTimer=10,this.mBundlesScore++,this.AnalyticAchievementEvent("bundled")}},RocketCatGame.prototype.BundleBonusActive=function(){return this.mBundleBonusTimer>0},RocketCatGame.prototype.PlayerEnteredBundler=function(e){this.mPlayer.SetPosition(e.Position().e(1),this.Height()/2),this.mPlayer.Hide(),this.FreezeGameplay(!0),setTimeout(RocketCatGame.prototype.leaveBundler.bind(this),2e3),this.mBundlerScore++,this.AnalyticAchievementEvent("bundler")},RocketCatGame.prototype.leaveBundler=function(){this.FreezeGameplay(!1),this.mBundlerBoostTimer=4,this.mPlayer.Show()},RocketCatGame.prototype.BundlerBoostActive=function(){return this.mBundlerBoostTimer>0},RocketCatGame.prototype.ModalMessage=function(e,t,n,r){this.mModalImage=this.CreateWorldEntity(TGE.GameWorldEntity).Setup(this.mPlayer.Position().e(1)+t,this.mPlayer.Position().e(2)+n,e,"UI"),this.FreezeGameplay(!0),setTimeout(RocketCatGame.prototype.closeModalMessage.bind(this),r*1e3)},RocketCatGame.prototype.closeModalMessage=function(){this.FreezeGameplay(!1),this.mModalImage.MarkForRemoval()},RocketCatGame.prototype.DisplayStartMessage=function(e){var t=this.Width()/2,n,r;this.mStartMessageDigits=new Array;if(e>=0){n="start_beat_your_score",r=this.Height()*.15;var s=!0,o=38,u=e.toString(),a=24,f=2,l=u.length*o;if(s){var c=Math.floor((u.length-1)/3);l+=c*a}var h=t+l/2+o/2;h-=o,h-=7;var p=r+50,d=0;for(i=u.length-1;i>=0;i--){if(s&&d==3){h+=f;var v=this.CreateUIEntity(TGE.ScreenEntity).Setup(h,p,null,"UI");v.SetImage("big_digits_comma",1,1),v.SetImageIndex(0),this.mStartMessageDigits.push(v),h-=a,d=0}var m=this.CreateUIEntity(TGE.ScreenEntity).Setup(h,p,null,"UI");m.SetImage("big_digits",1,10),m.SetImageIndex(u.charCodeAt(i)-48),this.mStartMessageDigits.push(m),h-=o,d++}}else n="start_tap_to_fly",r=this.Height()*.3;this.mStartMessage=this.CreateUIEntity(TGE.ScreenEntity).Setup(t,r,n,"UI"),this.mStartMessageTimer=4},RocketCatGame.prototype.DisplayAchievementNotification=function(e){var t=50;this.mAchievementPopup==null?(this.mAchievementPopup=this.CreateUIEntity(TGE.ScreenEntity).Setup(this.Width()/2,50,"achievement_popup","UI"),this.mAchievementMessage=this.CreateUIEntity(TGE.Text).Setup(this.Width()/2,t,e,"bold italic 28px Arial","center","middle","#f28500","UI")):this.mAchievementMessage.SetText(e),this.mAchievementPopupTimer=3},RocketCatGame.prototype.FreezeGameplay=function(e){this.mFreezeGameplay=e},RocketCatGame.prototype.GameplayFrozen=function(){return this.mFreezeGameplay},RocketCatGame.prototype.GetPlayer=function(){return this.mPlayer},RocketCatGame.prototype.GroundLevel=function(){return-120},RocketCatGame.prototype.CurrentScore=function(){return Math.floor(this.GetDistance()*this.mCoins)},RocketCatGame.prototype.GetDistance=function(){return Math.floor(this.mDistance)},RocketCatGame.prototype.GetCoins=function(){return this.mCoins},RocketCatGame.prototype.GetBundlerScore=function(){return this.mBundlerScore},RocketCatGame.prototype.GetBundlesScore=function(){return this.mBundlesScore},RocketCatGame.prototype.GetHelmetScore=function(){return this.mHelmetScore};